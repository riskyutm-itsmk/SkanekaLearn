(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $y(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Rm={exports:{}},Nc={},Lm={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sl=Symbol.for("react.element"),zy=Symbol.for("react.portal"),Wy=Symbol.for("react.fragment"),Hy=Symbol.for("react.strict_mode"),Vy=Symbol.for("react.profiler"),Gy=Symbol.for("react.provider"),qy=Symbol.for("react.context"),Ky=Symbol.for("react.forward_ref"),Xy=Symbol.for("react.suspense"),Yy=Symbol.for("react.memo"),Jy=Symbol.for("react.lazy"),sh=Symbol.iterator;function Qy(e){return e===null||typeof e!="object"?null:(e=sh&&e[sh]||e["@@iterator"],typeof e=="function"?e:null)}var Mm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Im=Object.assign,Bm={};function Ys(e,t,r){this.props=e,this.context=t,this.refs=Bm,this.updater=r||Mm}Ys.prototype.isReactComponent={};Ys.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ys.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Um(){}Um.prototype=Ys.prototype;function vd(e,t,r){this.props=e,this.context=t,this.refs=Bm,this.updater=r||Mm}var yd=vd.prototype=new Um;yd.constructor=vd;Im(yd,Ys.prototype);yd.isPureReactComponent=!0;var ih=Array.isArray,$m=Object.prototype.hasOwnProperty,wd={current:null},zm={key:!0,ref:!0,__self:!0,__source:!0};function Wm(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)$m.call(t,n)&&!zm.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Sl,type:e,key:s,ref:i,props:a,_owner:wd.current}}function Zy(e,t){return{$$typeof:Sl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _d(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sl}function e2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var lh=/\/+/g;function fu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?e2(""+e.key):t.toString(36)}function So(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Sl:case zy:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+fu(i,0):n,ih(a)?(r="",e!=null&&(r=e.replace(lh,"$&/")+"/"),So(a,t,r,"",function(u){return u})):a!=null&&(_d(a)&&(a=Zy(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(lh,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",ih(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+fu(s,o);i+=So(s,t,r,c,a)}else if(c=Qy(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+fu(s,o++),i+=So(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function zl(e,t,r){if(e==null)return e;var n=[],a=0;return So(e,n,"","",function(s){return t.call(r,s,a++)}),n}function t2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qt={current:null},ko={transition:null},r2={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:ko,ReactCurrentOwner:wd};function Hm(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:zl,forEach:function(e,t,r){zl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zl(e,function(){t++}),t},toArray:function(e){return zl(e,function(t){return t})||[]},only:function(e){if(!_d(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ne.Component=Ys;Ne.Fragment=Wy;Ne.Profiler=Vy;Ne.PureComponent=vd;Ne.StrictMode=Hy;Ne.Suspense=Xy;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r2;Ne.act=Hm;Ne.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Im({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=wd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)$m.call(t,c)&&!zm.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Sl,type:e.type,key:a,ref:s,props:n,_owner:i}};Ne.createContext=function(e){return e={$$typeof:qy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Gy,_context:e},e.Consumer=e};Ne.createElement=Wm;Ne.createFactory=function(e){var t=Wm.bind(null,e);return t.type=e,t};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(e){return{$$typeof:Ky,render:e}};Ne.isValidElement=_d;Ne.lazy=function(e){return{$$typeof:Jy,_payload:{_status:-1,_result:e},_init:t2}};Ne.memo=function(e,t){return{$$typeof:Yy,type:e,compare:t===void 0?null:t}};Ne.startTransition=function(e){var t=ko.transition;ko.transition={};try{e()}finally{ko.transition=t}};Ne.unstable_act=Hm;Ne.useCallback=function(e,t){return qt.current.useCallback(e,t)};Ne.useContext=function(e){return qt.current.useContext(e)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(e){return qt.current.useDeferredValue(e)};Ne.useEffect=function(e,t){return qt.current.useEffect(e,t)};Ne.useId=function(){return qt.current.useId()};Ne.useImperativeHandle=function(e,t,r){return qt.current.useImperativeHandle(e,t,r)};Ne.useInsertionEffect=function(e,t){return qt.current.useInsertionEffect(e,t)};Ne.useLayoutEffect=function(e,t){return qt.current.useLayoutEffect(e,t)};Ne.useMemo=function(e,t){return qt.current.useMemo(e,t)};Ne.useReducer=function(e,t,r){return qt.current.useReducer(e,t,r)};Ne.useRef=function(e){return qt.current.useRef(e)};Ne.useState=function(e){return qt.current.useState(e)};Ne.useSyncExternalStore=function(e,t,r){return qt.current.useSyncExternalStore(e,t,r)};Ne.useTransition=function(){return qt.current.useTransition()};Ne.version="18.3.1";Lm.exports=Ne;var T=Lm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n2=T,a2=Symbol.for("react.element"),s2=Symbol.for("react.fragment"),i2=Object.prototype.hasOwnProperty,l2=n2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o2={key:!0,ref:!0,__self:!0,__source:!0};function Vm(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)i2.call(t,n)&&!o2.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:a2,type:e,key:s,ref:i,props:a,_owner:l2.current}}Nc.Fragment=s2;Nc.jsx=Vm;Nc.jsxs=Vm;Rm.exports=Nc;var l=Rm.exports,Gm={exports:{}},hr={},qm={exports:{}},Km={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Q,re){var xe=Q.length;Q.push(re);e:for(;0<xe;){var Ee=xe-1>>>1,R=Q[Ee];if(0<a(R,re))Q[Ee]=re,Q[xe]=R,xe=Ee;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var re=Q[0],xe=Q.pop();if(xe!==re){Q[0]=xe;e:for(var Ee=0,R=Q.length,H=R>>>1;Ee<H;){var M=2*(Ee+1)-1,L=Q[M],X=M+1,ue=Q[X];if(0>a(L,xe))X<R&&0>a(ue,L)?(Q[Ee]=ue,Q[X]=xe,Ee=X):(Q[Ee]=L,Q[M]=xe,Ee=M);else if(X<R&&0>a(ue,xe))Q[Ee]=ue,Q[X]=xe,Ee=X;else break e}}return re}function a(Q,re){var xe=Q.sortIndex-re.sortIndex;return xe!==0?xe:Q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,v=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(Q){for(var re=r(u);re!==null;){if(re.callback===null)n(u);else if(re.startTime<=Q)n(u),re.sortIndex=re.expirationTime,t(c,re);else break;re=r(u)}}function b(Q){if(x=!1,g(Q),!v)if(r(c)!==null)v=!0,we(j);else{var re=r(u);re!==null&&pe(b,re.startTime-Q)}}function j(Q,re){v=!1,x&&(x=!1,y(D),D=-1),m=!0;var xe=h;try{for(g(re),f=r(c);f!==null&&(!(f.expirationTime>re)||Q&&!B());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,h=f.priorityLevel;var R=Ee(f.expirationTime<=re);re=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&n(c),g(re)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var M=r(u);M!==null&&pe(b,M.startTime-re),H=!1}return H}finally{f=null,h=xe,m=!1}}var A=!1,k=null,D=-1,_=5,N=-1;function B(){return!(e.unstable_now()-N<_)}function q(){if(k!==null){var Q=e.unstable_now();N=Q;var re=!0;try{re=k(!0,Q)}finally{re?Z():(A=!1,k=null)}}else A=!1}var Z;if(typeof p=="function")Z=function(){p(q)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,ce=_e.port2;_e.port1.onmessage=q,Z=function(){ce.postMessage(null)}}else Z=function(){w(q,0)};function we(Q){k=Q,A||(A=!0,Z())}function pe(Q,re){D=w(function(){Q(e.unstable_now())},re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,we(j))},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Q){switch(h){case 1:case 2:case 3:var re=3;break;default:re=h}var xe=h;h=re;try{return Q()}finally{h=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var xe=h;h=Q;try{return re()}finally{h=xe}},e.unstable_scheduleCallback=function(Q,re,xe){var Ee=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Ee+xe:Ee):xe=Ee,Q){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=xe+R,Q={id:d++,callback:re,priorityLevel:Q,startTime:xe,expirationTime:R,sortIndex:-1},xe>Ee?(Q.sortIndex=xe,t(u,Q),r(c)===null&&Q===r(u)&&(x?(y(D),D=-1):x=!0,pe(b,xe-Ee))):(Q.sortIndex=R,t(c,Q),v||m||(v=!0,we(j))),Q},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(Q){var re=h;return function(){var xe=h;h=re;try{return Q.apply(this,arguments)}finally{h=xe}}}})(Km);qm.exports=Km;var c2=qm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2=T,dr=c2;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xm=new Set,Gi={};function Ua(e,t){Ms(e,t),Ms(e+"Capture",t)}function Ms(e,t){for(Gi[e]=t,e=0;e<t.length;e++)Xm.add(t[e])}var kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),s0=Object.prototype.hasOwnProperty,d2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,oh={},ch={};function f2(e){return s0.call(ch,e)?!0:s0.call(oh,e)?!1:d2.test(e)?ch[e]=!0:(oh[e]=!0,!1)}function h2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function x2(e,t,r,n){if(t===null||typeof t>"u"||h2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kt(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ct[e]=new Kt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ct[t]=new Kt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ct[e]=new Kt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ct[e]=new Kt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ct[e]=new Kt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ct[e]=new Kt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ct[e]=new Kt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ct[e]=new Kt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ct[e]=new Kt(e,5,!1,e.toLowerCase(),null,!1,!1)});var bd=/[\-:]([a-z])/g;function Sd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(bd,Sd);Ct[t]=new Kt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(bd,Sd);Ct[t]=new Kt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(bd,Sd);Ct[t]=new Kt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ct[e]=new Kt(e,1,!1,e.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ct[e]=new Kt(e,1,!1,e.toLowerCase(),null,!0,!0)});function kd(e,t,r,n){var a=Ct.hasOwnProperty(t)?Ct[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(x2(t,r,a,n)&&(r=null),n||a===null?f2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Pn=u2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wl=Symbol.for("react.element"),us=Symbol.for("react.portal"),ds=Symbol.for("react.fragment"),jd=Symbol.for("react.strict_mode"),i0=Symbol.for("react.profiler"),Ym=Symbol.for("react.provider"),Jm=Symbol.for("react.context"),Ed=Symbol.for("react.forward_ref"),l0=Symbol.for("react.suspense"),o0=Symbol.for("react.suspense_list"),Td=Symbol.for("react.memo"),Un=Symbol.for("react.lazy"),Qm=Symbol.for("react.offscreen"),uh=Symbol.iterator;function di(e){return e===null||typeof e!="object"?null:(e=uh&&e[uh]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,hu;function bi(e){if(hu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hu=t&&t[1]||""}return`
`+hu+e}var xu=!1;function mu(e,t){if(!e||xu)return"";xu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var c=`
`+a[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{xu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bi(e):""}function m2(e){switch(e.tag){case 5:return bi(e.type);case 16:return bi("Lazy");case 13:return bi("Suspense");case 19:return bi("SuspenseList");case 0:case 2:case 15:return e=mu(e.type,!1),e;case 11:return e=mu(e.type.render,!1),e;case 1:return e=mu(e.type,!0),e;default:return""}}function c0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ds:return"Fragment";case us:return"Portal";case i0:return"Profiler";case jd:return"StrictMode";case l0:return"Suspense";case o0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jm:return(e.displayName||"Context")+".Consumer";case Ym:return(e._context.displayName||"Context")+".Provider";case Ed:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Td:return t=e.displayName||null,t!==null?t:c0(e.type)||"Memo";case Un:t=e._payload,e=e._init;try{return c0(e(t))}catch{}}return null}function p2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return c0(t);case 8:return t===jd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function na(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function g2(e){var t=Zm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hl(e){e._valueTracker||(e._valueTracker=g2(e))}function ep(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Zm(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Mo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function u0(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function dh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=na(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tp(e,t){t=t.checked,t!=null&&kd(e,"checked",t,!1)}function d0(e,t){tp(e,t);var r=na(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?f0(e,t.type,r):t.hasOwnProperty("defaultValue")&&f0(e,t.type,na(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function f0(e,t,r){(t!=="number"||Mo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Si=Array.isArray;function ks(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+na(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function h0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(Si(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:na(r)}}function rp(e,t){var r=na(t.value),n=na(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function xh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function np(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function x0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?np(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vl,ap=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vl=Vl||document.createElement("div"),Vl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ni={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},v2=["Webkit","ms","Moz","O"];Object.keys(Ni).forEach(function(e){v2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ni[t]=Ni[e]})});function sp(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ni.hasOwnProperty(e)&&Ni[e]?(""+t).trim():t+"px"}function ip(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=sp(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var y2=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function m0(e,t){if(t){if(y2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function p0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g0=null;function Nd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var v0=null,js=null,Es=null;function mh(e){if(e=El(e)){if(typeof v0!="function")throw Error(te(280));var t=e.stateNode;t&&(t=Fc(t),v0(e.stateNode,e.type,t))}}function lp(e){js?Es?Es.push(e):Es=[e]:js=e}function op(){if(js){var e=js,t=Es;if(Es=js=null,mh(e),t)for(e=0;e<t.length;e++)mh(t[e])}}function cp(e,t){return e(t)}function up(){}var pu=!1;function dp(e,t,r){if(pu)return e(t,r);pu=!0;try{return cp(e,t,r)}finally{pu=!1,(js!==null||Es!==null)&&(up(),op())}}function Ki(e,t){var r=e.stateNode;if(r===null)return null;var n=Fc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var y0=!1;if(kn)try{var fi={};Object.defineProperty(fi,"passive",{get:function(){y0=!0}}),window.addEventListener("test",fi,fi),window.removeEventListener("test",fi,fi)}catch{y0=!1}function w2(e,t,r,n,a,s,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ci=!1,Io=null,Bo=!1,w0=null,_2={onError:function(e){Ci=!0,Io=e}};function b2(e,t,r,n,a,s,i,o,c){Ci=!1,Io=null,w2.apply(_2,arguments)}function S2(e,t,r,n,a,s,i,o,c){if(b2.apply(this,arguments),Ci){if(Ci){var u=Io;Ci=!1,Io=null}else throw Error(te(198));Bo||(Bo=!0,w0=u)}}function $a(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ph(e){if($a(e)!==e)throw Error(te(188))}function k2(e){var t=e.alternate;if(!t){if(t=$a(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return ph(a),e;if(s===n)return ph(a),t;s=s.sibling}throw Error(te(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function hp(e){return e=k2(e),e!==null?xp(e):null}function xp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xp(e);if(t!==null)return t;e=e.sibling}return null}var mp=dr.unstable_scheduleCallback,gh=dr.unstable_cancelCallback,j2=dr.unstable_shouldYield,E2=dr.unstable_requestPaint,st=dr.unstable_now,T2=dr.unstable_getCurrentPriorityLevel,Cd=dr.unstable_ImmediatePriority,pp=dr.unstable_UserBlockingPriority,Uo=dr.unstable_NormalPriority,N2=dr.unstable_LowPriority,gp=dr.unstable_IdlePriority,Cc=null,an=null;function C2(e){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Cc,e,void 0,(e.current.flags&128)===128)}catch{}}var Ur=Math.clz32?Math.clz32:O2,A2=Math.log,P2=Math.LN2;function O2(e){return e>>>=0,e===0?32:31-(A2(e)/P2|0)|0}var Gl=64,ql=4194304;function ki(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $o(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=ki(o):(s&=i,s!==0&&(n=ki(s)))}else i=r&~a,i!==0?n=ki(i):s!==0&&(n=ki(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ur(t),a=1<<r,n|=e[r],t&=~a;return n}function F2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Ur(s),o=1<<i,c=a[i];c===-1?(!(o&r)||o&n)&&(a[i]=F2(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function _0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function vp(){var e=Gl;return Gl<<=1,!(Gl&4194240)&&(Gl=64),e}function gu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function kl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ur(t),e[t]=r}function R2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ur(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Ad(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ur(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Be=0;function yp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var wp,Pd,_p,bp,Sp,b0=!1,Kl=[],Xn=null,Yn=null,Jn=null,Xi=new Map,Yi=new Map,zn=[],L2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vh(e,t){switch(e){case"focusin":case"focusout":Xn=null;break;case"dragenter":case"dragleave":Yn=null;break;case"mouseover":case"mouseout":Jn=null;break;case"pointerover":case"pointerout":Xi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yi.delete(t.pointerId)}}function hi(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=El(t),t!==null&&Pd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function M2(e,t,r,n,a){switch(t){case"focusin":return Xn=hi(Xn,e,t,r,n,a),!0;case"dragenter":return Yn=hi(Yn,e,t,r,n,a),!0;case"mouseover":return Jn=hi(Jn,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Xi.set(s,hi(Xi.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Yi.set(s,hi(Yi.get(s)||null,e,t,r,n,a)),!0}return!1}function kp(e){var t=Ea(e.target);if(t!==null){var r=$a(t);if(r!==null){if(t=r.tag,t===13){if(t=fp(r),t!==null){e.blockedOn=t,Sp(e.priority,function(){_p(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=S0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);g0=n,r.target.dispatchEvent(n),g0=null}else return t=El(r),t!==null&&Pd(t),e.blockedOn=r,!1;t.shift()}return!0}function yh(e,t,r){jo(e)&&r.delete(t)}function I2(){b0=!1,Xn!==null&&jo(Xn)&&(Xn=null),Yn!==null&&jo(Yn)&&(Yn=null),Jn!==null&&jo(Jn)&&(Jn=null),Xi.forEach(yh),Yi.forEach(yh)}function xi(e,t){e.blockedOn===t&&(e.blockedOn=null,b0||(b0=!0,dr.unstable_scheduleCallback(dr.unstable_NormalPriority,I2)))}function Ji(e){function t(a){return xi(a,e)}if(0<Kl.length){xi(Kl[0],e);for(var r=1;r<Kl.length;r++){var n=Kl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Xn!==null&&xi(Xn,e),Yn!==null&&xi(Yn,e),Jn!==null&&xi(Jn,e),Xi.forEach(t),Yi.forEach(t),r=0;r<zn.length;r++)n=zn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zn.length&&(r=zn[0],r.blockedOn===null);)kp(r),r.blockedOn===null&&zn.shift()}var Ts=Pn.ReactCurrentBatchConfig,zo=!0;function B2(e,t,r,n){var a=Be,s=Ts.transition;Ts.transition=null;try{Be=1,Od(e,t,r,n)}finally{Be=a,Ts.transition=s}}function U2(e,t,r,n){var a=Be,s=Ts.transition;Ts.transition=null;try{Be=4,Od(e,t,r,n)}finally{Be=a,Ts.transition=s}}function Od(e,t,r,n){if(zo){var a=S0(e,t,r,n);if(a===null)Tu(e,t,n,Wo,r),vh(e,n);else if(M2(a,e,t,r,n))n.stopPropagation();else if(vh(e,n),t&4&&-1<L2.indexOf(e)){for(;a!==null;){var s=El(a);if(s!==null&&wp(s),s=S0(e,t,r,n),s===null&&Tu(e,t,n,Wo,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Tu(e,t,n,null,r)}}var Wo=null;function S0(e,t,r,n){if(Wo=null,e=Nd(n),e=Ea(e),e!==null)if(t=$a(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fp(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wo=e,null}function jp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T2()){case Cd:return 1;case pp:return 4;case Uo:case N2:return 16;case gp:return 536870912;default:return 16}default:return 16}}var Vn=null,Fd=null,Eo=null;function Ep(){if(Eo)return Eo;var e,t=Fd,r=t.length,n,a="value"in Vn?Vn.value:Vn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Eo=a.slice(e,1<n?1-n:void 0)}function To(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xl(){return!0}function wh(){return!1}function xr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Xl:wh,this.isPropagationStopped=wh,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xl)},persist:function(){},isPersistent:Xl}),t}var Js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dd=xr(Js),jl=et({},Js,{view:0,detail:0}),$2=xr(jl),vu,yu,mi,Ac=et({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mi&&(mi&&e.type==="mousemove"?(vu=e.screenX-mi.screenX,yu=e.screenY-mi.screenY):yu=vu=0,mi=e),vu)},movementY:function(e){return"movementY"in e?e.movementY:yu}}),_h=xr(Ac),z2=et({},Ac,{dataTransfer:0}),W2=xr(z2),H2=et({},jl,{relatedTarget:0}),wu=xr(H2),V2=et({},Js,{animationName:0,elapsedTime:0,pseudoElement:0}),G2=xr(V2),q2=et({},Js,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),K2=xr(q2),X2=et({},Js,{data:0}),bh=xr(X2),Y2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},J2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Q2[e])?!!t[e]:!1}function Rd(){return Z2}var ew=et({},jl,{key:function(e){if(e.key){var t=Y2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=To(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?J2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(e){return e.type==="keypress"?To(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?To(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tw=xr(ew),rw=et({},Ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sh=xr(rw),nw=et({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),aw=xr(nw),sw=et({},Js,{propertyName:0,elapsedTime:0,pseudoElement:0}),iw=xr(sw),lw=et({},Ac,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ow=xr(lw),cw=[9,13,27,32],Ld=kn&&"CompositionEvent"in window,Ai=null;kn&&"documentMode"in document&&(Ai=document.documentMode);var uw=kn&&"TextEvent"in window&&!Ai,Tp=kn&&(!Ld||Ai&&8<Ai&&11>=Ai),kh=" ",jh=!1;function Np(e,t){switch(e){case"keyup":return cw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fs=!1;function dw(e,t){switch(e){case"compositionend":return Cp(t);case"keypress":return t.which!==32?null:(jh=!0,kh);case"textInput":return e=t.data,e===kh&&jh?null:e;default:return null}}function fw(e,t){if(fs)return e==="compositionend"||!Ld&&Np(e,t)?(e=Ep(),Eo=Fd=Vn=null,fs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tp&&t.locale!=="ko"?null:t.data;default:return null}}var hw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Eh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hw[e.type]:t==="textarea"}function Ap(e,t,r,n){lp(n),t=Ho(t,"onChange"),0<t.length&&(r=new Dd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Pi=null,Qi=null;function xw(e){$p(e,0)}function Pc(e){var t=ms(e);if(ep(t))return e}function mw(e,t){if(e==="change")return t}var Pp=!1;if(kn){var _u;if(kn){var bu="oninput"in document;if(!bu){var Th=document.createElement("div");Th.setAttribute("oninput","return;"),bu=typeof Th.oninput=="function"}_u=bu}else _u=!1;Pp=_u&&(!document.documentMode||9<document.documentMode)}function Nh(){Pi&&(Pi.detachEvent("onpropertychange",Op),Qi=Pi=null)}function Op(e){if(e.propertyName==="value"&&Pc(Qi)){var t=[];Ap(t,Qi,e,Nd(e)),dp(xw,t)}}function pw(e,t,r){e==="focusin"?(Nh(),Pi=t,Qi=r,Pi.attachEvent("onpropertychange",Op)):e==="focusout"&&Nh()}function gw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pc(Qi)}function vw(e,t){if(e==="click")return Pc(t)}function yw(e,t){if(e==="input"||e==="change")return Pc(t)}function ww(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hr=typeof Object.is=="function"?Object.is:ww;function Zi(e,t){if(Hr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!s0.call(t,a)||!Hr(e[a],t[a]))return!1}return!0}function Ch(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ah(e,t){var r=Ch(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ch(r)}}function Fp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Fp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dp(){for(var e=window,t=Mo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Mo(e.document)}return t}function Md(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _w(e){var t=Dp(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Fp(r.ownerDocument.documentElement,r)){if(n!==null&&Md(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Ah(r,s);var i=Ah(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bw=kn&&"documentMode"in document&&11>=document.documentMode,hs=null,k0=null,Oi=null,j0=!1;function Ph(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;j0||hs==null||hs!==Mo(n)||(n=hs,"selectionStart"in n&&Md(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Oi&&Zi(Oi,n)||(Oi=n,n=Ho(k0,"onSelect"),0<n.length&&(t=new Dd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=hs)))}function Yl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xs={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},Su={},Rp={};kn&&(Rp=document.createElement("div").style,"AnimationEvent"in window||(delete xs.animationend.animation,delete xs.animationiteration.animation,delete xs.animationstart.animation),"TransitionEvent"in window||delete xs.transitionend.transition);function Oc(e){if(Su[e])return Su[e];if(!xs[e])return e;var t=xs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Rp)return Su[e]=t[r];return e}var Lp=Oc("animationend"),Mp=Oc("animationiteration"),Ip=Oc("animationstart"),Bp=Oc("transitionend"),Up=new Map,Oh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ca(e,t){Up.set(e,t),Ua(t,[e])}for(var ku=0;ku<Oh.length;ku++){var ju=Oh[ku],Sw=ju.toLowerCase(),kw=ju[0].toUpperCase()+ju.slice(1);ca(Sw,"on"+kw)}ca(Lp,"onAnimationEnd");ca(Mp,"onAnimationIteration");ca(Ip,"onAnimationStart");ca("dblclick","onDoubleClick");ca("focusin","onFocus");ca("focusout","onBlur");ca(Bp,"onTransitionEnd");Ms("onMouseEnter",["mouseout","mouseover"]);Ms("onMouseLeave",["mouseout","mouseover"]);Ms("onPointerEnter",["pointerout","pointerover"]);Ms("onPointerLeave",["pointerout","pointerover"]);Ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jw=new Set("cancel close invalid load scroll toggle".split(" ").concat(ji));function Fh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,S2(n,t,void 0,e),e.currentTarget=null}function $p(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==s&&a.isPropagationStopped())break e;Fh(a,o,u),s=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==s&&a.isPropagationStopped())break e;Fh(a,o,u),s=c}}}if(Bo)throw e=w0,Bo=!1,w0=null,e}function Ve(e,t){var r=t[A0];r===void 0&&(r=t[A0]=new Set);var n=e+"__bubble";r.has(n)||(zp(t,e,2,!1),r.add(n))}function Eu(e,t,r){var n=0;t&&(n|=4),zp(r,e,n,t)}var Jl="_reactListening"+Math.random().toString(36).slice(2);function el(e){if(!e[Jl]){e[Jl]=!0,Xm.forEach(function(r){r!=="selectionchange"&&(jw.has(r)||Eu(r,!1,e),Eu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jl]||(t[Jl]=!0,Eu("selectionchange",!1,t))}}function zp(e,t,r,n){switch(jp(t)){case 1:var a=B2;break;case 4:a=U2;break;default:a=Od}r=a.bind(null,t,r,e),a=void 0,!y0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Tu(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Ea(o),i===null)return;if(c=i.tag,c===5||c===6){n=s=i;continue e}o=o.parentNode}}n=n.return}dp(function(){var u=s,d=Nd(r),f=[];e:{var h=Up.get(e);if(h!==void 0){var m=Dd,v=e;switch(e){case"keypress":if(To(r)===0)break e;case"keydown":case"keyup":m=tw;break;case"focusin":v="focus",m=wu;break;case"focusout":v="blur",m=wu;break;case"beforeblur":case"afterblur":m=wu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=_h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=W2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=aw;break;case Lp:case Mp:case Ip:m=G2;break;case Bp:m=iw;break;case"scroll":m=$2;break;case"wheel":m=ow;break;case"copy":case"cut":case"paste":m=K2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Sh}var x=(t&4)!==0,w=!x&&e==="scroll",y=x?h!==null?h+"Capture":null:h;x=[];for(var p=u,g;p!==null;){g=p;var b=g.stateNode;if(g.tag===5&&b!==null&&(g=b,y!==null&&(b=Ki(p,y),b!=null&&x.push(tl(p,b,g)))),w)break;p=p.return}0<x.length&&(h=new m(h,v,null,r,d),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==g0&&(v=r.relatedTarget||r.fromElement)&&(Ea(v)||v[jn]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=u,v=v?Ea(v):null,v!==null&&(w=$a(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=_h,b="onMouseLeave",y="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(x=Sh,b="onPointerLeave",y="onPointerEnter",p="pointer"),w=m==null?h:ms(m),g=v==null?h:ms(v),h=new x(b,p+"leave",m,r,d),h.target=w,h.relatedTarget=g,b=null,Ea(d)===u&&(x=new x(y,p+"enter",v,r,d),x.target=g,x.relatedTarget=w,b=x),w=b,m&&v)t:{for(x=m,y=v,p=0,g=x;g;g=Xa(g))p++;for(g=0,b=y;b;b=Xa(b))g++;for(;0<p-g;)x=Xa(x),p--;for(;0<g-p;)y=Xa(y),g--;for(;p--;){if(x===y||y!==null&&x===y.alternate)break t;x=Xa(x),y=Xa(y)}x=null}else x=null;m!==null&&Dh(f,h,m,x,!1),v!==null&&w!==null&&Dh(f,w,v,x,!0)}}e:{if(h=u?ms(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var j=mw;else if(Eh(h))if(Pp)j=yw;else{j=gw;var A=pw}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=vw);if(j&&(j=j(e,u))){Ap(f,j,r,d);break e}A&&A(e,h,u),e==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&f0(h,"number",h.value)}switch(A=u?ms(u):window,e){case"focusin":(Eh(A)||A.contentEditable==="true")&&(hs=A,k0=u,Oi=null);break;case"focusout":Oi=k0=hs=null;break;case"mousedown":j0=!0;break;case"contextmenu":case"mouseup":case"dragend":j0=!1,Ph(f,r,d);break;case"selectionchange":if(bw)break;case"keydown":case"keyup":Ph(f,r,d)}var k;if(Ld)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else fs?Np(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(Tp&&r.locale!=="ko"&&(fs||D!=="onCompositionStart"?D==="onCompositionEnd"&&fs&&(k=Ep()):(Vn=d,Fd="value"in Vn?Vn.value:Vn.textContent,fs=!0)),A=Ho(u,D),0<A.length&&(D=new bh(D,e,null,r,d),f.push({event:D,listeners:A}),k?D.data=k:(k=Cp(r),k!==null&&(D.data=k)))),(k=uw?dw(e,r):fw(e,r))&&(u=Ho(u,"onBeforeInput"),0<u.length&&(d=new bh("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=k))}$p(f,t)})}function tl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ho(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Ki(e,r),s!=null&&n.unshift(tl(e,s,a)),s=Ki(e,t),s!=null&&n.push(tl(e,s,a))),e=e.return}return n}function Xa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Dh(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=Ki(r,s),c!=null&&i.unshift(tl(r,c,o))):a||(c=Ki(r,s),c!=null&&i.push(tl(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Ew=/\r\n?/g,Tw=/\u0000|\uFFFD/g;function Rh(e){return(typeof e=="string"?e:""+e).replace(Ew,`
`).replace(Tw,"")}function Ql(e,t,r){if(t=Rh(t),Rh(e)!==t&&r)throw Error(te(425))}function Vo(){}var E0=null,T0=null;function N0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var C0=typeof setTimeout=="function"?setTimeout:void 0,Nw=typeof clearTimeout=="function"?clearTimeout:void 0,Lh=typeof Promise=="function"?Promise:void 0,Cw=typeof queueMicrotask=="function"?queueMicrotask:typeof Lh<"u"?function(e){return Lh.resolve(null).then(e).catch(Aw)}:C0;function Aw(e){setTimeout(function(){throw e})}function Nu(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Ji(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Ji(t)}function Qn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Mh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qs=Math.random().toString(36).slice(2),tn="__reactFiber$"+Qs,rl="__reactProps$"+Qs,jn="__reactContainer$"+Qs,A0="__reactEvents$"+Qs,Pw="__reactListeners$"+Qs,Ow="__reactHandles$"+Qs;function Ea(e){var t=e[tn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[jn]||r[tn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Mh(e);e!==null;){if(r=e[tn])return r;e=Mh(e)}return t}e=r,r=e.parentNode}return null}function El(e){return e=e[tn]||e[jn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Fc(e){return e[rl]||null}var P0=[],ps=-1;function ua(e){return{current:e}}function Ge(e){0>ps||(e.current=P0[ps],P0[ps]=null,ps--)}function He(e,t){ps++,P0[ps]=e.current,e.current=t}var aa={},Bt=ua(aa),Qt=ua(!1),Oa=aa;function Is(e,t){var r=e.type.contextTypes;if(!r)return aa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Zt(e){return e=e.childContextTypes,e!=null}function Go(){Ge(Qt),Ge(Bt)}function Ih(e,t,r){if(Bt.current!==aa)throw Error(te(168));He(Bt,t),He(Qt,r)}function Wp(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(te(108,p2(e)||"Unknown",a));return et({},r,n)}function qo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||aa,Oa=Bt.current,He(Bt,e),He(Qt,Qt.current),!0}function Bh(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Wp(e,t,Oa),n.__reactInternalMemoizedMergedChildContext=e,Ge(Qt),Ge(Bt),He(Bt,e)):Ge(Qt),He(Qt,r)}var pn=null,Dc=!1,Cu=!1;function Hp(e){pn===null?pn=[e]:pn.push(e)}function Fw(e){Dc=!0,Hp(e)}function da(){if(!Cu&&pn!==null){Cu=!0;var e=0,t=Be;try{var r=pn;for(Be=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}pn=null,Dc=!1}catch(a){throw pn!==null&&(pn=pn.slice(e+1)),mp(Cd,da),a}finally{Be=t,Cu=!1}}return null}var gs=[],vs=0,Ko=null,Xo=0,vr=[],yr=0,Fa=null,gn=1,vn="";function ya(e,t){gs[vs++]=Xo,gs[vs++]=Ko,Ko=e,Xo=t}function Vp(e,t,r){vr[yr++]=gn,vr[yr++]=vn,vr[yr++]=Fa,Fa=e;var n=gn;e=vn;var a=32-Ur(n)-1;n&=~(1<<a),r+=1;var s=32-Ur(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,gn=1<<32-Ur(t)+a|r<<a|n,vn=s+e}else gn=1<<s|r<<a|n,vn=e}function Id(e){e.return!==null&&(ya(e,1),Vp(e,1,0))}function Bd(e){for(;e===Ko;)Ko=gs[--vs],gs[vs]=null,Xo=gs[--vs],gs[vs]=null;for(;e===Fa;)Fa=vr[--yr],vr[yr]=null,vn=vr[--yr],vr[yr]=null,gn=vr[--yr],vr[yr]=null}var ur=null,cr=null,Ke=!1,Lr=null;function Gp(e,t){var r=wr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Uh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ur=e,cr=Qn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ur=e,cr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Fa!==null?{id:gn,overflow:vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ur=e,cr=null,!0):!1;default:return!1}}function O0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function F0(e){if(Ke){var t=cr;if(t){var r=t;if(!Uh(e,t)){if(O0(e))throw Error(te(418));t=Qn(r.nextSibling);var n=ur;t&&Uh(e,t)?Gp(n,r):(e.flags=e.flags&-4097|2,Ke=!1,ur=e)}}else{if(O0(e))throw Error(te(418));e.flags=e.flags&-4097|2,Ke=!1,ur=e}}}function $h(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ur=e}function Zl(e){if(e!==ur)return!1;if(!Ke)return $h(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!N0(e.type,e.memoizedProps)),t&&(t=cr)){if(O0(e))throw qp(),Error(te(418));for(;t;)Gp(e,t),t=Qn(t.nextSibling)}if($h(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cr=Qn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cr=null}}else cr=ur?Qn(e.stateNode.nextSibling):null;return!0}function qp(){for(var e=cr;e;)e=Qn(e.nextSibling)}function Bs(){cr=ur=null,Ke=!1}function Ud(e){Lr===null?Lr=[e]:Lr.push(e)}var Dw=Pn.ReactCurrentBatchConfig;function pi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function eo(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zh(e){var t=e._init;return t(e._payload)}function Kp(e){function t(y,p){if(e){var g=y.deletions;g===null?(y.deletions=[p],y.flags|=16):g.push(p)}}function r(y,p){if(!e)return null;for(;p!==null;)t(y,p),p=p.sibling;return null}function n(y,p){for(y=new Map;p!==null;)p.key!==null?y.set(p.key,p):y.set(p.index,p),p=p.sibling;return y}function a(y,p){return y=ra(y,p),y.index=0,y.sibling=null,y}function s(y,p,g){return y.index=g,e?(g=y.alternate,g!==null?(g=g.index,g<p?(y.flags|=2,p):g):(y.flags|=2,p)):(y.flags|=1048576,p)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,p,g,b){return p===null||p.tag!==6?(p=Lu(g,y.mode,b),p.return=y,p):(p=a(p,g),p.return=y,p)}function c(y,p,g,b){var j=g.type;return j===ds?d(y,p,g.props.children,b,g.key):p!==null&&(p.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Un&&zh(j)===p.type)?(b=a(p,g.props),b.ref=pi(y,p,g),b.return=y,b):(b=Do(g.type,g.key,g.props,null,y.mode,b),b.ref=pi(y,p,g),b.return=y,b)}function u(y,p,g,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=Mu(g,y.mode,b),p.return=y,p):(p=a(p,g.children||[]),p.return=y,p)}function d(y,p,g,b,j){return p===null||p.tag!==7?(p=Aa(g,y.mode,b,j),p.return=y,p):(p=a(p,g),p.return=y,p)}function f(y,p,g){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Lu(""+p,y.mode,g),p.return=y,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Wl:return g=Do(p.type,p.key,p.props,null,y.mode,g),g.ref=pi(y,null,p),g.return=y,g;case us:return p=Mu(p,y.mode,g),p.return=y,p;case Un:var b=p._init;return f(y,b(p._payload),g)}if(Si(p)||di(p))return p=Aa(p,y.mode,g,null),p.return=y,p;eo(y,p)}return null}function h(y,p,g,b){var j=p!==null?p.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return j!==null?null:o(y,p,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Wl:return g.key===j?c(y,p,g,b):null;case us:return g.key===j?u(y,p,g,b):null;case Un:return j=g._init,h(y,p,j(g._payload),b)}if(Si(g)||di(g))return j!==null?null:d(y,p,g,b,null);eo(y,g)}return null}function m(y,p,g,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(g)||null,o(p,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Wl:return y=y.get(b.key===null?g:b.key)||null,c(p,y,b,j);case us:return y=y.get(b.key===null?g:b.key)||null,u(p,y,b,j);case Un:var A=b._init;return m(y,p,g,A(b._payload),j)}if(Si(b)||di(b))return y=y.get(g)||null,d(p,y,b,j,null);eo(p,b)}return null}function v(y,p,g,b){for(var j=null,A=null,k=p,D=p=0,_=null;k!==null&&D<g.length;D++){k.index>D?(_=k,k=null):_=k.sibling;var N=h(y,k,g[D],b);if(N===null){k===null&&(k=_);break}e&&k&&N.alternate===null&&t(y,k),p=s(N,p,D),A===null?j=N:A.sibling=N,A=N,k=_}if(D===g.length)return r(y,k),Ke&&ya(y,D),j;if(k===null){for(;D<g.length;D++)k=f(y,g[D],b),k!==null&&(p=s(k,p,D),A===null?j=k:A.sibling=k,A=k);return Ke&&ya(y,D),j}for(k=n(y,k);D<g.length;D++)_=m(k,y,D,g[D],b),_!==null&&(e&&_.alternate!==null&&k.delete(_.key===null?D:_.key),p=s(_,p,D),A===null?j=_:A.sibling=_,A=_);return e&&k.forEach(function(B){return t(y,B)}),Ke&&ya(y,D),j}function x(y,p,g,b){var j=di(g);if(typeof j!="function")throw Error(te(150));if(g=j.call(g),g==null)throw Error(te(151));for(var A=j=null,k=p,D=p=0,_=null,N=g.next();k!==null&&!N.done;D++,N=g.next()){k.index>D?(_=k,k=null):_=k.sibling;var B=h(y,k,N.value,b);if(B===null){k===null&&(k=_);break}e&&k&&B.alternate===null&&t(y,k),p=s(B,p,D),A===null?j=B:A.sibling=B,A=B,k=_}if(N.done)return r(y,k),Ke&&ya(y,D),j;if(k===null){for(;!N.done;D++,N=g.next())N=f(y,N.value,b),N!==null&&(p=s(N,p,D),A===null?j=N:A.sibling=N,A=N);return Ke&&ya(y,D),j}for(k=n(y,k);!N.done;D++,N=g.next())N=m(k,y,D,N.value,b),N!==null&&(e&&N.alternate!==null&&k.delete(N.key===null?D:N.key),p=s(N,p,D),A===null?j=N:A.sibling=N,A=N);return e&&k.forEach(function(q){return t(y,q)}),Ke&&ya(y,D),j}function w(y,p,g,b){if(typeof g=="object"&&g!==null&&g.type===ds&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Wl:e:{for(var j=g.key,A=p;A!==null;){if(A.key===j){if(j=g.type,j===ds){if(A.tag===7){r(y,A.sibling),p=a(A,g.props.children),p.return=y,y=p;break e}}else if(A.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Un&&zh(j)===A.type){r(y,A.sibling),p=a(A,g.props),p.ref=pi(y,A,g),p.return=y,y=p;break e}r(y,A);break}else t(y,A);A=A.sibling}g.type===ds?(p=Aa(g.props.children,y.mode,b,g.key),p.return=y,y=p):(b=Do(g.type,g.key,g.props,null,y.mode,b),b.ref=pi(y,p,g),b.return=y,y=b)}return i(y);case us:e:{for(A=g.key;p!==null;){if(p.key===A)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){r(y,p.sibling),p=a(p,g.children||[]),p.return=y,y=p;break e}else{r(y,p);break}else t(y,p);p=p.sibling}p=Mu(g,y.mode,b),p.return=y,y=p}return i(y);case Un:return A=g._init,w(y,p,A(g._payload),b)}if(Si(g))return v(y,p,g,b);if(di(g))return x(y,p,g,b);eo(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,p!==null&&p.tag===6?(r(y,p.sibling),p=a(p,g),p.return=y,y=p):(r(y,p),p=Lu(g,y.mode,b),p.return=y,y=p),i(y)):r(y,p)}return w}var Us=Kp(!0),Xp=Kp(!1),Yo=ua(null),Jo=null,ys=null,$d=null;function zd(){$d=ys=Jo=null}function Wd(e){var t=Yo.current;Ge(Yo),e._currentValue=t}function D0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ns(e,t){Jo=e,$d=ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Jt=!0),e.firstContext=null)}function Sr(e){var t=e._currentValue;if($d!==e)if(e={context:e,memoizedValue:t,next:null},ys===null){if(Jo===null)throw Error(te(308));ys=e,Jo.dependencies={lanes:0,firstContext:e}}else ys=ys.next=e;return t}var Ta=null;function Hd(e){Ta===null?Ta=[e]:Ta.push(e)}function Yp(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Hd(t)):(r.next=a.next,a.next=r),t.interleaved=r,En(e,n)}function En(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var $n=!1;function Vd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ae&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,En(e,r)}return a=n.interleaved,a===null?(t.next=t,Hd(n)):(t.next=a.next,a.next=t),n.interleaved=t,En(e,r)}function No(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ad(e,r)}}function Wh(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Qo(e,t,r,n){var a=e.updateQueue;$n=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?s=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;i=0,d=u=c=null,o=s;do{var h=o.lane,m=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,x=o;switch(h=t,m=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=et({},f,h);break e;case 2:$n=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Ra|=i,e.lanes=i,e.memoizedState=f}}function Hh(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(te(191,a));a.call(n)}}}var Tl={},sn=ua(Tl),nl=ua(Tl),al=ua(Tl);function Na(e){if(e===Tl)throw Error(te(174));return e}function Gd(e,t){switch(He(al,t),He(nl,e),He(sn,Tl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:x0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=x0(t,e)}Ge(sn),He(sn,t)}function $s(){Ge(sn),Ge(nl),Ge(al)}function Qp(e){Na(al.current);var t=Na(sn.current),r=x0(t,e.type);t!==r&&(He(nl,e),He(sn,r))}function qd(e){nl.current===e&&(Ge(sn),Ge(nl))}var Qe=ua(0);function Zo(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Au=[];function Kd(){for(var e=0;e<Au.length;e++)Au[e]._workInProgressVersionPrimary=null;Au.length=0}var Co=Pn.ReactCurrentDispatcher,Pu=Pn.ReactCurrentBatchConfig,Da=0,Ze=null,xt=null,pt=null,ec=!1,Fi=!1,sl=0,Rw=0;function Dt(){throw Error(te(321))}function Xd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Hr(e[r],t[r]))return!1;return!0}function Yd(e,t,r,n,a,s){if(Da=s,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Co.current=e===null||e.memoizedState===null?Bw:Uw,e=r(n,a),Fi){s=0;do{if(Fi=!1,sl=0,25<=s)throw Error(te(301));s+=1,pt=xt=null,t.updateQueue=null,Co.current=$w,e=r(n,a)}while(Fi)}if(Co.current=tc,t=xt!==null&&xt.next!==null,Da=0,pt=xt=Ze=null,ec=!1,t)throw Error(te(300));return e}function Jd(){var e=sl!==0;return sl=0,e}function Zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ze.memoizedState=pt=e:pt=pt.next=e,pt}function kr(){if(xt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=pt===null?Ze.memoizedState:pt.next;if(t!==null)pt=t,xt=e;else{if(e===null)throw Error(te(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},pt===null?Ze.memoizedState=pt=e:pt=pt.next=e}return pt}function il(e,t){return typeof t=="function"?t(e):t}function Ou(e){var t=kr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=xt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,c=null,u=s;do{var d=u.lane;if((Da&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,i=n):c=c.next=f,Ze.lanes|=d,Ra|=d}u=u.next}while(u!==null&&u!==s);c===null?i=n:c.next=o,Hr(n,t.memoizedState)||(Jt=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Ze.lanes|=s,Ra|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Fu(e){var t=kr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Hr(s,t.memoizedState)||(Jt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Zp(){}function eg(e,t){var r=Ze,n=kr(),a=t(),s=!Hr(n.memoizedState,a);if(s&&(n.memoizedState=a,Jt=!0),n=n.queue,Qd(ng.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||pt!==null&&pt.memoizedState.tag&1){if(r.flags|=2048,ll(9,rg.bind(null,r,n,a,t),void 0,null),wt===null)throw Error(te(349));Da&30||tg(r,t,a)}return a}function tg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function rg(e,t,r,n){t.value=r,t.getSnapshot=n,ag(t)&&sg(e)}function ng(e,t,r){return r(function(){ag(t)&&sg(e)})}function ag(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Hr(e,r)}catch{return!0}}function sg(e){var t=En(e,1);t!==null&&$r(t,e,1,-1)}function Vh(e){var t=Zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:e},t.queue=e,e=e.dispatch=Iw.bind(null,Ze,e),[t.memoizedState,e]}function ll(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ig(){return kr().memoizedState}function Ao(e,t,r,n){var a=Zr();Ze.flags|=e,a.memoizedState=ll(1|t,r,void 0,n===void 0?null:n)}function Rc(e,t,r,n){var a=kr();n=n===void 0?null:n;var s=void 0;if(xt!==null){var i=xt.memoizedState;if(s=i.destroy,n!==null&&Xd(n,i.deps)){a.memoizedState=ll(t,r,s,n);return}}Ze.flags|=e,a.memoizedState=ll(1|t,r,s,n)}function Gh(e,t){return Ao(8390656,8,e,t)}function Qd(e,t){return Rc(2048,8,e,t)}function lg(e,t){return Rc(4,2,e,t)}function og(e,t){return Rc(4,4,e,t)}function cg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ug(e,t,r){return r=r!=null?r.concat([e]):null,Rc(4,4,cg.bind(null,t,e),r)}function Zd(){}function dg(e,t){var r=kr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xd(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fg(e,t){var r=kr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xd(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function hg(e,t,r){return Da&21?(Hr(r,t)||(r=vp(),Ze.lanes|=r,Ra|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Jt=!0),e.memoizedState=r)}function Lw(e,t){var r=Be;Be=r!==0&&4>r?r:4,e(!0);var n=Pu.transition;Pu.transition={};try{e(!1),t()}finally{Be=r,Pu.transition=n}}function xg(){return kr().memoizedState}function Mw(e,t,r){var n=ta(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},mg(e))pg(t,r);else if(r=Yp(e,t,r,n),r!==null){var a=Ht();$r(r,e,n,a),gg(r,t,n)}}function Iw(e,t,r){var n=ta(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(mg(e))pg(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Hr(o,i)){var c=t.interleaved;c===null?(a.next=a,Hd(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Yp(e,t,a,n),r!==null&&(a=Ht(),$r(r,e,n,a),gg(r,t,n))}}function mg(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function pg(e,t){Fi=ec=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gg(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ad(e,r)}}var tc={readContext:Sr,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},Bw={readContext:Sr,useCallback:function(e,t){return Zr().memoizedState=[e,t===void 0?null:t],e},useContext:Sr,useEffect:Gh,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ao(4194308,4,cg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ao(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ao(4,2,e,t)},useMemo:function(e,t){var r=Zr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Zr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Mw.bind(null,Ze,e),[n.memoizedState,e]},useRef:function(e){var t=Zr();return e={current:e},t.memoizedState=e},useState:Vh,useDebugValue:Zd,useDeferredValue:function(e){return Zr().memoizedState=e},useTransition:function(){var e=Vh(!1),t=e[0];return e=Lw.bind(null,e[1]),Zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ze,a=Zr();if(Ke){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),wt===null)throw Error(te(349));Da&30||tg(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Gh(ng.bind(null,n,s,e),[e]),n.flags|=2048,ll(9,rg.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Zr(),t=wt.identifierPrefix;if(Ke){var r=vn,n=gn;r=(n&~(1<<32-Ur(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=sl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Rw++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Uw={readContext:Sr,useCallback:dg,useContext:Sr,useEffect:Qd,useImperativeHandle:ug,useInsertionEffect:lg,useLayoutEffect:og,useMemo:fg,useReducer:Ou,useRef:ig,useState:function(){return Ou(il)},useDebugValue:Zd,useDeferredValue:function(e){var t=kr();return hg(t,xt.memoizedState,e)},useTransition:function(){var e=Ou(il)[0],t=kr().memoizedState;return[e,t]},useMutableSource:Zp,useSyncExternalStore:eg,useId:xg,unstable_isNewReconciler:!1},$w={readContext:Sr,useCallback:dg,useContext:Sr,useEffect:Qd,useImperativeHandle:ug,useInsertionEffect:lg,useLayoutEffect:og,useMemo:fg,useReducer:Fu,useRef:ig,useState:function(){return Fu(il)},useDebugValue:Zd,useDeferredValue:function(e){var t=kr();return xt===null?t.memoizedState=e:hg(t,xt.memoizedState,e)},useTransition:function(){var e=Fu(il)[0],t=kr().memoizedState;return[e,t]},useMutableSource:Zp,useSyncExternalStore:eg,useId:xg,unstable_isNewReconciler:!1};function Fr(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function R0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Lc={isMounted:function(e){return(e=e._reactInternals)?$a(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ht(),a=ta(e),s=yn(n,a);s.payload=t,r!=null&&(s.callback=r),t=Zn(e,s,a),t!==null&&($r(t,e,a,n),No(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ht(),a=ta(e),s=yn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Zn(e,s,a),t!==null&&($r(t,e,a,n),No(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ht(),n=ta(e),a=yn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Zn(e,a,n),t!==null&&($r(t,e,n,r),No(t,e,n))}};function qh(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Zi(r,n)||!Zi(a,s):!0}function vg(e,t,r){var n=!1,a=aa,s=t.contextType;return typeof s=="object"&&s!==null?s=Sr(s):(a=Zt(t)?Oa:Bt.current,n=t.contextTypes,s=(n=n!=null)?Is(e,a):aa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Lc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Kh(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Lc.enqueueReplaceState(t,t.state,null)}function L0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Vd(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Sr(s):(s=Zt(t)?Oa:Bt.current,a.context=Is(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(R0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Lc.enqueueReplaceState(a,a.state,null),Qo(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function zs(e,t){try{var r="",n=t;do r+=m2(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Du(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function M0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zw=typeof WeakMap=="function"?WeakMap:Map;function yg(e,t,r){r=yn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){nc||(nc=!0,q0=n),M0(e,t)},r}function wg(e,t,r){r=yn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){M0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){M0(e,t),typeof n!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Xh(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zw;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=r_.bind(null,e,t,r),t.then(e,e))}function Yh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jh(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=yn(-1,1),t.tag=2,Zn(r,t,1))),r.lanes|=1),e)}var Ww=Pn.ReactCurrentOwner,Jt=!1;function $t(e,t,r,n){t.child=e===null?Xp(t,null,r,n):Us(t,e.child,r,n)}function Qh(e,t,r,n,a){r=r.render;var s=t.ref;return Ns(t,a),n=Yd(e,t,r,n,s,a),r=Jd(),e!==null&&!Jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Tn(e,t,a)):(Ke&&r&&Id(t),t.flags|=1,$t(e,t,n,a),t.child)}function Zh(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!of(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,_g(e,t,s,n,a)):(e=Do(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Zi,r(i,n)&&e.ref===t.ref)return Tn(e,t,a)}return t.flags|=1,e=ra(s,n),e.ref=t.ref,e.return=t,t.child=e}function _g(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Zi(s,n)&&e.ref===t.ref)if(Jt=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Jt=!0);else return t.lanes=e.lanes,Tn(e,t,a)}return I0(e,t,r,n,a)}function bg(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(_s,sr),sr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(_s,sr),sr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,He(_s,sr),sr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,He(_s,sr),sr|=n;return $t(e,t,a,r),t.child}function Sg(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function I0(e,t,r,n,a){var s=Zt(r)?Oa:Bt.current;return s=Is(t,s),Ns(t,a),r=Yd(e,t,r,n,s,a),n=Jd(),e!==null&&!Jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Tn(e,t,a)):(Ke&&n&&Id(t),t.flags|=1,$t(e,t,r,a),t.child)}function ex(e,t,r,n,a){if(Zt(r)){var s=!0;qo(t)}else s=!1;if(Ns(t,a),t.stateNode===null)Po(e,t),vg(t,r,n),L0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Sr(u):(u=Zt(r)?Oa:Bt.current,u=Is(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&Kh(t,i,n,u),$n=!1;var h=t.memoizedState;i.state=h,Qo(t,n,i,a),c=t.memoizedState,o!==n||h!==c||Qt.current||$n?(typeof d=="function"&&(R0(t,r,d,n),c=t.memoizedState),(o=$n||qh(t,r,o,n,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Jp(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Fr(t.type,o),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Sr(c):(c=Zt(r)?Oa:Bt.current,c=Is(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==c)&&Kh(t,i,n,c),$n=!1,h=t.memoizedState,i.state=h,Qo(t,n,i,a);var v=t.memoizedState;o!==f||h!==v||Qt.current||$n?(typeof m=="function"&&(R0(t,r,m,n),v=t.memoizedState),(u=$n||qh(t,r,u,n,h,v,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return B0(e,t,r,n,s,a)}function B0(e,t,r,n,a,s){Sg(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Bh(t,r,!1),Tn(e,t,s);n=t.stateNode,Ww.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Us(t,e.child,null,s),t.child=Us(t,null,o,s)):$t(e,t,o,s),t.memoizedState=n.state,a&&Bh(t,r,!0),t.child}function kg(e){var t=e.stateNode;t.pendingContext?Ih(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ih(e,t.context,!1),Gd(e,t.containerInfo)}function tx(e,t,r,n,a){return Bs(),Ud(a),t.flags|=256,$t(e,t,r,n),t.child}var U0={dehydrated:null,treeContext:null,retryLane:0};function $0(e){return{baseLanes:e,cachePool:null,transitions:null}}function jg(e,t,r){var n=t.pendingProps,a=Qe.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),He(Qe,a&1),e===null)return F0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Bc(i,n,0,null),e=Aa(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$0(r),t.memoizedState=U0,e):ef(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Hw(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ra(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=ra(o,s):(s=Aa(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?$0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=U0,n}return s=e.child,e=s.sibling,n=ra(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ef(e,t){return t=Bc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function to(e,t,r,n){return n!==null&&Ud(n),Us(t,e.child,null,r),e=ef(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hw(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Du(Error(te(422))),to(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Bc({mode:"visible",children:n.children},a,0,null),s=Aa(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Us(t,e.child,null,i),t.child.memoizedState=$0(i),t.memoizedState=U0,s);if(!(t.mode&1))return to(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(te(419)),n=Du(s,n,void 0),to(e,t,i,n)}if(o=(i&e.childLanes)!==0,Jt||o){if(n=wt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,En(e,a),$r(n,e,a,-1))}return lf(),n=Du(Error(te(421))),to(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=n_.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,cr=Qn(a.nextSibling),ur=t,Ke=!0,Lr=null,e!==null&&(vr[yr++]=gn,vr[yr++]=vn,vr[yr++]=Fa,gn=e.id,vn=e.overflow,Fa=t),t=ef(t,n.children),t.flags|=4096,t)}function rx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),D0(e.return,t,r)}function Ru(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Eg(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if($t(e,t,n.children,r),n=Qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rx(e,r,t);else if(e.tag===19)rx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(He(Qe,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Zo(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Ru(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Zo(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Ru(t,!0,r,null,s);break;case"together":Ru(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Po(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Tn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ra|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=ra(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ra(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Vw(e,t,r){switch(t.tag){case 3:kg(t),Bs();break;case 5:Qp(t);break;case 1:Zt(t.type)&&qo(t);break;case 4:Gd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;He(Yo,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(He(Qe,Qe.current&1),t.flags|=128,null):r&t.child.childLanes?jg(e,t,r):(He(Qe,Qe.current&1),e=Tn(e,t,r),e!==null?e.sibling:null);He(Qe,Qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Eg(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),He(Qe,Qe.current),n)break;return null;case 22:case 23:return t.lanes=0,bg(e,t,r)}return Tn(e,t,r)}var Tg,z0,Ng,Cg;Tg=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};z0=function(){};Ng=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Na(sn.current);var s=null;switch(r){case"input":a=u0(e,a),n=u0(e,n),s=[];break;case"select":a=et({},a,{value:void 0}),n=et({},n,{value:void 0}),s=[];break;case"textarea":a=h0(e,a),n=h0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Vo)}m0(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Gi.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Gi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ve("scroll",e),s||o===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Cg=function(e,t,r,n){r!==n&&(t.flags|=4)};function gi(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Gw(e,t,r){var n=t.pendingProps;switch(Bd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Zt(t.type)&&Go(),Rt(t),null;case 3:return n=t.stateNode,$s(),Ge(Qt),Ge(Bt),Kd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Lr!==null&&(Y0(Lr),Lr=null))),z0(e,t),Rt(t),null;case 5:qd(t);var a=Na(al.current);if(r=t.type,e!==null&&t.stateNode!=null)Ng(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Rt(t),null}if(e=Na(sn.current),Zl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[tn]=t,n[rl]=s,e=(t.mode&1)!==0,r){case"dialog":Ve("cancel",n),Ve("close",n);break;case"iframe":case"object":case"embed":Ve("load",n);break;case"video":case"audio":for(a=0;a<ji.length;a++)Ve(ji[a],n);break;case"source":Ve("error",n);break;case"img":case"image":case"link":Ve("error",n),Ve("load",n);break;case"details":Ve("toggle",n);break;case"input":dh(n,s),Ve("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ve("invalid",n);break;case"textarea":hh(n,s),Ve("invalid",n)}m0(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),a=["children",""+o]):Gi.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Ve("scroll",n)}switch(r){case"input":Hl(n),fh(n,s,!0);break;case"textarea":Hl(n),xh(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Vo)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=np(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[tn]=t,e[rl]=n,Tg(e,t,!1,!1),t.stateNode=e;e:{switch(i=p0(r,n),r){case"dialog":Ve("cancel",e),Ve("close",e),a=n;break;case"iframe":case"object":case"embed":Ve("load",e),a=n;break;case"video":case"audio":for(a=0;a<ji.length;a++)Ve(ji[a],e);a=n;break;case"source":Ve("error",e),a=n;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),a=n;break;case"details":Ve("toggle",e),a=n;break;case"input":dh(e,n),a=u0(e,n),Ve("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=et({},n,{value:void 0}),Ve("invalid",e);break;case"textarea":hh(e,n),a=h0(e,n),Ve("invalid",e);break;default:a=n}m0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?ip(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ap(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&qi(e,c):typeof c=="number"&&qi(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Gi.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ve("scroll",e):c!=null&&kd(e,s,c,i))}switch(r){case"input":Hl(e),fh(e,n,!1);break;case"textarea":Hl(e),xh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+na(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ks(e,!!n.multiple,s,!1):n.defaultValue!=null&&ks(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Vo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)Cg(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=Na(al.current),Na(sn.current),Zl(t)){if(n=t.stateNode,r=t.memoizedProps,n[tn]=t,(s=n.nodeValue!==r)&&(e=ur,e!==null))switch(e.tag){case 3:Ql(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ql(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[tn]=t,t.stateNode=n}return Rt(t),null;case 13:if(Ge(Qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&cr!==null&&t.mode&1&&!(t.flags&128))qp(),Bs(),t.flags|=98560,s=!1;else if(s=Zl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(te(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[tn]=t}else Bs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),s=!1}else Lr!==null&&(Y0(Lr),Lr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?mt===0&&(mt=3):lf())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return $s(),z0(e,t),e===null&&el(t.stateNode.containerInfo),Rt(t),null;case 10:return Wd(t.type._context),Rt(t),null;case 17:return Zt(t.type)&&Go(),Rt(t),null;case 19:if(Ge(Qe),s=t.memoizedState,s===null)return Rt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)gi(s,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Zo(e),i!==null){for(t.flags|=128,gi(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return He(Qe,Qe.current&1|2),t.child}e=e.sibling}s.tail!==null&&st()>Ws&&(t.flags|=128,n=!0,gi(s,!1),t.lanes=4194304)}else{if(!n)if(e=Zo(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),gi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Ke)return Rt(t),null}else 2*st()-s.renderingStartTime>Ws&&r!==1073741824&&(t.flags|=128,n=!0,gi(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=st(),t.sibling=null,r=Qe.current,He(Qe,n?r&1|2:r&1),t):(Rt(t),null);case 22:case 23:return sf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?sr&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function qw(e,t){switch(Bd(t),t.tag){case 1:return Zt(t.type)&&Go(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $s(),Ge(Qt),Ge(Bt),Kd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qd(t),null;case 13:if(Ge(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));Bs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(Qe),null;case 4:return $s(),null;case 10:return Wd(t.type._context),null;case 22:case 23:return sf(),null;case 24:return null;default:return null}}var ro=!1,Lt=!1,Kw=typeof WeakSet=="function"?WeakSet:Set,he=null;function ws(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function W0(e,t,r){try{r()}catch(n){tt(e,t,n)}}var nx=!1;function Xw(e,t){if(E0=zo,e=Dp(),Md(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===a&&(o=i),h===s&&++d===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(T0={focusedElem:e,selectionRange:r},zo=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,w=v.memoizedState,y=t.stateNode,p=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:Fr(t.type,x),w);y.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(b){tt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return v=nx,nx=!1,v}function Di(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&W0(t,r,s)}a=a.next}while(a!==n)}}function Mc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function H0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ag(e){var t=e.alternate;t!==null&&(e.alternate=null,Ag(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[tn],delete t[rl],delete t[A0],delete t[Pw],delete t[Ow])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Pg(e){return e.tag===5||e.tag===3||e.tag===4}function ax(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Pg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function V0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Vo));else if(n!==4&&(e=e.child,e!==null))for(V0(e,t,r),e=e.sibling;e!==null;)V0(e,t,r),e=e.sibling}function G0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(G0(e,t,r),e=e.sibling;e!==null;)G0(e,t,r),e=e.sibling}var St=null,Dr=!1;function Dn(e,t,r){for(r=r.child;r!==null;)Og(e,t,r),r=r.sibling}function Og(e,t,r){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Cc,r)}catch{}switch(r.tag){case 5:Lt||ws(r,t);case 6:var n=St,a=Dr;St=null,Dn(e,t,r),St=n,Dr=a,St!==null&&(Dr?(e=St,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):St.removeChild(r.stateNode));break;case 18:St!==null&&(Dr?(e=St,r=r.stateNode,e.nodeType===8?Nu(e.parentNode,r):e.nodeType===1&&Nu(e,r),Ji(e)):Nu(St,r.stateNode));break;case 4:n=St,a=Dr,St=r.stateNode.containerInfo,Dr=!0,Dn(e,t,r),St=n,Dr=a;break;case 0:case 11:case 14:case 15:if(!Lt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&W0(r,t,i),a=a.next}while(a!==n)}Dn(e,t,r);break;case 1:if(!Lt&&(ws(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){tt(r,t,o)}Dn(e,t,r);break;case 21:Dn(e,t,r);break;case 22:r.mode&1?(Lt=(n=Lt)||r.memoizedState!==null,Dn(e,t,r),Lt=n):Dn(e,t,r);break;default:Dn(e,t,r)}}function sx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Kw),t.forEach(function(n){var a=a_.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Cr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,Dr=!1;break e;case 3:St=o.stateNode.containerInfo,Dr=!0;break e;case 4:St=o.stateNode.containerInfo,Dr=!0;break e}o=o.return}if(St===null)throw Error(te(160));Og(s,i,a),St=null,Dr=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){tt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Fg(t,e),t=t.sibling}function Fg(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cr(t,e),Yr(e),n&4){try{Di(3,e,e.return),Mc(3,e)}catch(x){tt(e,e.return,x)}try{Di(5,e,e.return)}catch(x){tt(e,e.return,x)}}break;case 1:Cr(t,e),Yr(e),n&512&&r!==null&&ws(r,r.return);break;case 5:if(Cr(t,e),Yr(e),n&512&&r!==null&&ws(r,r.return),e.flags&32){var a=e.stateNode;try{qi(a,"")}catch(x){tt(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&tp(a,s),p0(o,i);var u=p0(o,s);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?ip(a,f):d==="dangerouslySetInnerHTML"?ap(a,f):d==="children"?qi(a,f):kd(a,d,f,u)}switch(o){case"input":d0(a,s);break;case"textarea":rp(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?ks(a,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?ks(a,!!s.multiple,s.defaultValue,!0):ks(a,!!s.multiple,s.multiple?[]:"",!1))}a[rl]=s}catch(x){tt(e,e.return,x)}}break;case 6:if(Cr(t,e),Yr(e),n&4){if(e.stateNode===null)throw Error(te(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(x){tt(e,e.return,x)}}break;case 3:if(Cr(t,e),Yr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ji(t.containerInfo)}catch(x){tt(e,e.return,x)}break;case 4:Cr(t,e),Yr(e);break;case 13:Cr(t,e),Yr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(nf=st())),n&4&&sx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Lt=(u=Lt)||d,Cr(t,e),Lt=u):Cr(t,e),Yr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(he=e,d=e.child;d!==null;){for(f=he=d;he!==null;){switch(h=he,m=h.child,h.tag){case 0:case 11:case 14:case 15:Di(4,h,h.return);break;case 1:ws(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){tt(n,r,x)}}break;case 5:ws(h,h.return);break;case 22:if(h.memoizedState!==null){lx(f);continue}}m!==null?(m.return=h,he=m):lx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=sp("display",i))}catch(x){tt(e,e.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){tt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Cr(t,e),Yr(e),n&4&&sx(e);break;case 21:break;default:Cr(t,e),Yr(e)}}function Yr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Pg(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(qi(a,""),n.flags&=-33);var s=ax(e);G0(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=ax(e);V0(e,o,i);break;default:throw Error(te(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Yw(e,t,r){he=e,Dg(e)}function Dg(e,t,r){for(var n=(e.mode&1)!==0;he!==null;){var a=he,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||ro;if(!i){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Lt;o=ro;var u=Lt;if(ro=i,(Lt=c)&&!u)for(he=a;he!==null;)i=he,c=i.child,i.tag===22&&i.memoizedState!==null?ox(a):c!==null?(c.return=i,he=c):ox(a);for(;s!==null;)he=s,Dg(s),s=s.sibling;he=a,ro=o,Lt=u}ix(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,he=s):ix(e)}}function ix(e){for(;he!==null;){var t=he;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lt||Mc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Fr(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Hh(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hh(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Ji(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Lt||t.flags&512&&H0(t)}catch(h){tt(t,t.return,h)}}if(t===e){he=null;break}if(r=t.sibling,r!==null){r.return=t.return,he=r;break}he=t.return}}function lx(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var r=t.sibling;if(r!==null){r.return=t.return,he=r;break}he=t.return}}function ox(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Mc(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){tt(t,a,c)}}var s=t.return;try{H0(t)}catch(c){tt(t,s,c)}break;case 5:var i=t.return;try{H0(t)}catch(c){tt(t,i,c)}}}catch(c){tt(t,t.return,c)}if(t===e){he=null;break}var o=t.sibling;if(o!==null){o.return=t.return,he=o;break}he=t.return}}var Jw=Math.ceil,rc=Pn.ReactCurrentDispatcher,tf=Pn.ReactCurrentOwner,_r=Pn.ReactCurrentBatchConfig,Ae=0,wt=null,lt=null,Tt=0,sr=0,_s=ua(0),mt=0,ol=null,Ra=0,Ic=0,rf=0,Ri=null,Xt=null,nf=0,Ws=1/0,xn=null,nc=!1,q0=null,ea=null,no=!1,Gn=null,ac=0,Li=0,K0=null,Oo=-1,Fo=0;function Ht(){return Ae&6?st():Oo!==-1?Oo:Oo=st()}function ta(e){return e.mode&1?Ae&2&&Tt!==0?Tt&-Tt:Dw.transition!==null?(Fo===0&&(Fo=vp()),Fo):(e=Be,e!==0||(e=window.event,e=e===void 0?16:jp(e.type)),e):1}function $r(e,t,r,n){if(50<Li)throw Li=0,K0=null,Error(te(185));kl(e,r,n),(!(Ae&2)||e!==wt)&&(e===wt&&(!(Ae&2)&&(Ic|=r),mt===4&&Wn(e,Tt)),er(e,n),r===1&&Ae===0&&!(t.mode&1)&&(Ws=st()+500,Dc&&da()))}function er(e,t){var r=e.callbackNode;D2(e,t);var n=$o(e,e===wt?Tt:0);if(n===0)r!==null&&gh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&gh(r),t===1)e.tag===0?Fw(cx.bind(null,e)):Hp(cx.bind(null,e)),Cw(function(){!(Ae&6)&&da()}),r=null;else{switch(yp(n)){case 1:r=Cd;break;case 4:r=pp;break;case 16:r=Uo;break;case 536870912:r=gp;break;default:r=Uo}r=zg(r,Rg.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Rg(e,t){if(Oo=-1,Fo=0,Ae&6)throw Error(te(327));var r=e.callbackNode;if(Cs()&&e.callbackNode!==r)return null;var n=$o(e,e===wt?Tt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=sc(e,n);else{t=n;var a=Ae;Ae|=2;var s=Mg();(wt!==e||Tt!==t)&&(xn=null,Ws=st()+500,Ca(e,t));do try{e_();break}catch(o){Lg(e,o)}while(!0);zd(),rc.current=s,Ae=a,lt!==null?t=0:(wt=null,Tt=0,t=mt)}if(t!==0){if(t===2&&(a=_0(e),a!==0&&(n=a,t=X0(e,a))),t===1)throw r=ol,Ca(e,0),Wn(e,n),er(e,st()),r;if(t===6)Wn(e,n);else{if(a=e.current.alternate,!(n&30)&&!Qw(a)&&(t=sc(e,n),t===2&&(s=_0(e),s!==0&&(n=s,t=X0(e,s))),t===1))throw r=ol,Ca(e,0),Wn(e,n),er(e,st()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:wa(e,Xt,xn);break;case 3:if(Wn(e,n),(n&130023424)===n&&(t=nf+500-st(),10<t)){if($o(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ht(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=C0(wa.bind(null,e,Xt,xn),t);break}wa(e,Xt,xn);break;case 4:if(Wn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Ur(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Jw(n/1960))-n,10<n){e.timeoutHandle=C0(wa.bind(null,e,Xt,xn),n);break}wa(e,Xt,xn);break;case 5:wa(e,Xt,xn);break;default:throw Error(te(329))}}}return er(e,st()),e.callbackNode===r?Rg.bind(null,e):null}function X0(e,t){var r=Ri;return e.current.memoizedState.isDehydrated&&(Ca(e,t).flags|=256),e=sc(e,t),e!==2&&(t=Xt,Xt=r,t!==null&&Y0(t)),e}function Y0(e){Xt===null?Xt=e:Xt.push.apply(Xt,e)}function Qw(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Hr(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wn(e,t){for(t&=~rf,t&=~Ic,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ur(t),n=1<<r;e[r]=-1,t&=~n}}function cx(e){if(Ae&6)throw Error(te(327));Cs();var t=$o(e,0);if(!(t&1))return er(e,st()),null;var r=sc(e,t);if(e.tag!==0&&r===2){var n=_0(e);n!==0&&(t=n,r=X0(e,n))}if(r===1)throw r=ol,Ca(e,0),Wn(e,t),er(e,st()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wa(e,Xt,xn),er(e,st()),null}function af(e,t){var r=Ae;Ae|=1;try{return e(t)}finally{Ae=r,Ae===0&&(Ws=st()+500,Dc&&da())}}function La(e){Gn!==null&&Gn.tag===0&&!(Ae&6)&&Cs();var t=Ae;Ae|=1;var r=_r.transition,n=Be;try{if(_r.transition=null,Be=1,e)return e()}finally{Be=n,_r.transition=r,Ae=t,!(Ae&6)&&da()}}function sf(){sr=_s.current,Ge(_s)}function Ca(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Nw(r)),lt!==null)for(r=lt.return;r!==null;){var n=r;switch(Bd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Go();break;case 3:$s(),Ge(Qt),Ge(Bt),Kd();break;case 5:qd(n);break;case 4:$s();break;case 13:Ge(Qe);break;case 19:Ge(Qe);break;case 10:Wd(n.type._context);break;case 22:case 23:sf()}r=r.return}if(wt=e,lt=e=ra(e.current,null),Tt=sr=t,mt=0,ol=null,rf=Ic=Ra=0,Xt=Ri=null,Ta!==null){for(t=0;t<Ta.length;t++)if(r=Ta[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Ta=null}return e}function Lg(e,t){do{var r=lt;try{if(zd(),Co.current=tc,ec){for(var n=Ze.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}ec=!1}if(Da=0,pt=xt=Ze=null,Fi=!1,sl=0,tf.current=null,r===null||r.return===null){mt=1,ol=t,lt=null;break}e:{var s=e,i=r.return,o=r,c=t;if(t=Tt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=Yh(i);if(m!==null){m.flags&=-257,Jh(m,i,o,s,t),m.mode&1&&Xh(s,u,t),t=m,c=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){Xh(s,u,t),lf();break e}c=Error(te(426))}}else if(Ke&&o.mode&1){var w=Yh(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Jh(w,i,o,s,t),Ud(zs(c,o));break e}}s=c=zs(c,o),mt!==4&&(mt=2),Ri===null?Ri=[s]:Ri.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=yg(s,c,t);Wh(s,y);break e;case 1:o=c;var p=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ea===null||!ea.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=wg(s,o,t);Wh(s,b);break e}}s=s.return}while(s!==null)}Bg(r)}catch(j){t=j,lt===r&&r!==null&&(lt=r=r.return);continue}break}while(!0)}function Mg(){var e=rc.current;return rc.current=tc,e===null?tc:e}function lf(){(mt===0||mt===3||mt===2)&&(mt=4),wt===null||!(Ra&268435455)&&!(Ic&268435455)||Wn(wt,Tt)}function sc(e,t){var r=Ae;Ae|=2;var n=Mg();(wt!==e||Tt!==t)&&(xn=null,Ca(e,t));do try{Zw();break}catch(a){Lg(e,a)}while(!0);if(zd(),Ae=r,rc.current=n,lt!==null)throw Error(te(261));return wt=null,Tt=0,mt}function Zw(){for(;lt!==null;)Ig(lt)}function e_(){for(;lt!==null&&!j2();)Ig(lt)}function Ig(e){var t=$g(e.alternate,e,sr);e.memoizedProps=e.pendingProps,t===null?Bg(e):lt=t,tf.current=null}function Bg(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=qw(r,t),r!==null){r.flags&=32767,lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,lt=null;return}}else if(r=Gw(r,t,sr),r!==null){lt=r;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);mt===0&&(mt=5)}function wa(e,t,r){var n=Be,a=_r.transition;try{_r.transition=null,Be=1,t_(e,t,r,n)}finally{_r.transition=a,Be=n}return null}function t_(e,t,r,n){do Cs();while(Gn!==null);if(Ae&6)throw Error(te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(R2(e,s),e===wt&&(lt=wt=null,Tt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||no||(no=!0,zg(Uo,function(){return Cs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=_r.transition,_r.transition=null;var i=Be;Be=1;var o=Ae;Ae|=4,tf.current=null,Xw(e,r),Fg(r,e),_w(T0),zo=!!E0,T0=E0=null,e.current=r,Yw(r),E2(),Ae=o,Be=i,_r.transition=s}else e.current=r;if(no&&(no=!1,Gn=e,ac=a),s=e.pendingLanes,s===0&&(ea=null),C2(r.stateNode),er(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(nc)throw nc=!1,e=q0,q0=null,e;return ac&1&&e.tag!==0&&Cs(),s=e.pendingLanes,s&1?e===K0?Li++:(Li=0,K0=e):Li=0,da(),null}function Cs(){if(Gn!==null){var e=yp(ac),t=_r.transition,r=Be;try{if(_r.transition=null,Be=16>e?16:e,Gn===null)var n=!1;else{if(e=Gn,Gn=null,ac=0,Ae&6)throw Error(te(331));var a=Ae;for(Ae|=4,he=e.current;he!==null;){var s=he,i=s.child;if(he.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(he=u;he!==null;){var d=he;switch(d.tag){case 0:case 11:case 15:Di(8,d,s)}var f=d.child;if(f!==null)f.return=d,he=f;else for(;he!==null;){d=he;var h=d.sibling,m=d.return;if(Ag(d),d===u){he=null;break}if(h!==null){h.return=m,he=h;break}he=m}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}he=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,he=i;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Di(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,he=y;break e}he=s.return}}var p=e.current;for(he=p;he!==null;){i=he;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,he=g;else e:for(i=p;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Mc(9,o)}}catch(j){tt(o,o.return,j)}if(o===i){he=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,he=b;break e}he=o.return}}if(Ae=a,da(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Cc,e)}catch{}n=!0}return n}finally{Be=r,_r.transition=t}}return!1}function ux(e,t,r){t=zs(r,t),t=yg(e,t,1),e=Zn(e,t,1),t=Ht(),e!==null&&(kl(e,1,t),er(e,t))}function tt(e,t,r){if(e.tag===3)ux(e,e,r);else for(;t!==null;){if(t.tag===3){ux(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ea===null||!ea.has(n))){e=zs(r,e),e=wg(t,e,1),t=Zn(t,e,1),e=Ht(),t!==null&&(kl(t,1,e),er(t,e));break}}t=t.return}}function r_(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ht(),e.pingedLanes|=e.suspendedLanes&r,wt===e&&(Tt&r)===r&&(mt===4||mt===3&&(Tt&130023424)===Tt&&500>st()-nf?Ca(e,0):rf|=r),er(e,t)}function Ug(e,t){t===0&&(e.mode&1?(t=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):t=1);var r=Ht();e=En(e,t),e!==null&&(kl(e,t,r),er(e,r))}function n_(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Ug(e,r)}function a_(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),Ug(e,r)}var $g;$g=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qt.current)Jt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Jt=!1,Vw(e,t,r);Jt=!!(e.flags&131072)}else Jt=!1,Ke&&t.flags&1048576&&Vp(t,Xo,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Po(e,t),e=t.pendingProps;var a=Is(t,Bt.current);Ns(t,r),a=Yd(null,t,n,e,a,r);var s=Jd();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zt(n)?(s=!0,qo(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Vd(t),a.updater=Lc,t.stateNode=a,a._reactInternals=t,L0(t,n,e,r),t=B0(null,t,n,!0,s,r)):(t.tag=0,Ke&&s&&Id(t),$t(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Po(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=i_(n),e=Fr(n,e),a){case 0:t=I0(null,t,n,e,r);break e;case 1:t=ex(null,t,n,e,r);break e;case 11:t=Qh(null,t,n,e,r);break e;case 14:t=Zh(null,t,n,Fr(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Fr(n,a),I0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Fr(n,a),ex(e,t,n,a,r);case 3:e:{if(kg(t),e===null)throw Error(te(387));n=t.pendingProps,s=t.memoizedState,a=s.element,Jp(e,t),Qo(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=zs(Error(te(423)),t),t=tx(e,t,n,r,a);break e}else if(n!==a){a=zs(Error(te(424)),t),t=tx(e,t,n,r,a);break e}else for(cr=Qn(t.stateNode.containerInfo.firstChild),ur=t,Ke=!0,Lr=null,r=Xp(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bs(),n===a){t=Tn(e,t,r);break e}$t(e,t,n,r)}t=t.child}return t;case 5:return Qp(t),e===null&&F0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,N0(n,a)?i=null:s!==null&&N0(n,s)&&(t.flags|=32),Sg(e,t),$t(e,t,i,r),t.child;case 6:return e===null&&F0(t),null;case 13:return jg(e,t,r);case 4:return Gd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Us(t,null,n,r):$t(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Fr(n,a),Qh(e,t,n,a,r);case 7:return $t(e,t,t.pendingProps,r),t.child;case 8:return $t(e,t,t.pendingProps.children,r),t.child;case 12:return $t(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,He(Yo,n._currentValue),n._currentValue=i,s!==null)if(Hr(s.value,i)){if(s.children===a.children&&!Qt.current){t=Tn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=yn(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),D0(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(te(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),D0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}$t(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ns(t,r),a=Sr(a),n=n(a),t.flags|=1,$t(e,t,n,r),t.child;case 14:return n=t.type,a=Fr(n,t.pendingProps),a=Fr(n.type,a),Zh(e,t,n,a,r);case 15:return _g(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Fr(n,a),Po(e,t),t.tag=1,Zt(n)?(e=!0,qo(t)):e=!1,Ns(t,r),vg(t,n,a),L0(t,n,a,r),B0(null,t,n,!0,e,r);case 19:return Eg(e,t,r);case 22:return bg(e,t,r)}throw Error(te(156,t.tag))};function zg(e,t){return mp(e,t)}function s_(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(e,t,r,n){return new s_(e,t,r,n)}function of(e){return e=e.prototype,!(!e||!e.isReactComponent)}function i_(e){if(typeof e=="function")return of(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ed)return 11;if(e===Td)return 14}return 2}function ra(e,t){var r=e.alternate;return r===null?(r=wr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Do(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")of(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ds:return Aa(r.children,a,s,t);case jd:i=8,a|=8;break;case i0:return e=wr(12,r,t,a|2),e.elementType=i0,e.lanes=s,e;case l0:return e=wr(13,r,t,a),e.elementType=l0,e.lanes=s,e;case o0:return e=wr(19,r,t,a),e.elementType=o0,e.lanes=s,e;case Qm:return Bc(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ym:i=10;break e;case Jm:i=9;break e;case Ed:i=11;break e;case Td:i=14;break e;case Un:i=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=wr(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Aa(e,t,r,n){return e=wr(7,e,n,t),e.lanes=r,e}function Bc(e,t,r,n){return e=wr(22,e,n,t),e.elementType=Qm,e.lanes=r,e.stateNode={isHidden:!1},e}function Lu(e,t,r){return e=wr(6,e,null,t),e.lanes=r,e}function Mu(e,t,r){return t=wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function l_(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gu(0),this.expirationTimes=gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gu(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function cf(e,t,r,n,a,s,i,o,c){return e=new l_(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=wr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vd(s),e}function o_(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:us,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Wg(e){if(!e)return aa;e=e._reactInternals;e:{if($a(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(Zt(r))return Wp(e,r,t)}return t}function Hg(e,t,r,n,a,s,i,o,c){return e=cf(r,n,!0,e,a,s,i,o,c),e.context=Wg(null),r=e.current,n=Ht(),a=ta(r),s=yn(n,a),s.callback=t??null,Zn(r,s,a),e.current.lanes=a,kl(e,a,n),er(e,n),e}function Uc(e,t,r,n){var a=t.current,s=Ht(),i=ta(a);return r=Wg(r),t.context===null?t.context=r:t.pendingContext=r,t=yn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zn(a,t,i),e!==null&&($r(e,a,i,s),No(e,a,i)),i}function ic(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function dx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function uf(e,t){dx(e,t),(e=e.alternate)&&dx(e,t)}function c_(){return null}var Vg=typeof reportError=="function"?reportError:function(e){console.error(e)};function df(e){this._internalRoot=e}$c.prototype.render=df.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));Uc(e,t,null,null)};$c.prototype.unmount=df.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;La(function(){Uc(null,e,null,null)}),t[jn]=null}};function $c(e){this._internalRoot=e}$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=bp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zn.length&&t!==0&&t<zn[r].priority;r++);zn.splice(r,0,e),r===0&&kp(e)}};function ff(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function fx(){}function u_(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=ic(i);s.call(u)}}var i=Hg(t,n,e,0,null,!1,!1,"",fx);return e._reactRootContainer=i,e[jn]=i.current,el(e.nodeType===8?e.parentNode:e),La(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=ic(c);o.call(u)}}var c=cf(e,0,!1,null,null,!1,!1,"",fx);return e._reactRootContainer=c,e[jn]=c.current,el(e.nodeType===8?e.parentNode:e),La(function(){Uc(t,c,r,n)}),c}function Wc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var c=ic(i);o.call(c)}}Uc(t,i,e,a)}else i=u_(r,t,e,a,n);return ic(i)}wp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ki(t.pendingLanes);r!==0&&(Ad(t,r|1),er(t,st()),!(Ae&6)&&(Ws=st()+500,da()))}break;case 13:La(function(){var n=En(e,1);if(n!==null){var a=Ht();$r(n,e,1,a)}}),uf(e,1)}};Pd=function(e){if(e.tag===13){var t=En(e,134217728);if(t!==null){var r=Ht();$r(t,e,134217728,r)}uf(e,134217728)}};_p=function(e){if(e.tag===13){var t=ta(e),r=En(e,t);if(r!==null){var n=Ht();$r(r,e,t,n)}uf(e,t)}};bp=function(){return Be};Sp=function(e,t){var r=Be;try{return Be=e,t()}finally{Be=r}};v0=function(e,t,r){switch(t){case"input":if(d0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Fc(n);if(!a)throw Error(te(90));ep(n),d0(n,a)}}}break;case"textarea":rp(e,r);break;case"select":t=r.value,t!=null&&ks(e,!!r.multiple,t,!1)}};cp=af;up=La;var d_={usingClientEntryPoint:!1,Events:[El,ms,Fc,lp,op,af]},vi={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},f_={bundleType:vi.bundleType,version:vi.version,rendererPackageName:vi.rendererPackageName,rendererConfig:vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hp(e),e===null?null:e.stateNode},findFiberByHostInstance:vi.findFiberByHostInstance||c_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ao.isDisabled&&ao.supportsFiber)try{Cc=ao.inject(f_),an=ao}catch{}}hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d_;hr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ff(t))throw Error(te(200));return o_(e,t,null,r)};hr.createRoot=function(e,t){if(!ff(e))throw Error(te(299));var r=!1,n="",a=Vg;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=cf(e,1,!1,null,null,r,!1,n,a),e[jn]=t.current,el(e.nodeType===8?e.parentNode:e),new df(t)};hr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=hp(t),e=e===null?null:e.stateNode,e};hr.flushSync=function(e){return La(e)};hr.hydrate=function(e,t,r){if(!zc(t))throw Error(te(200));return Wc(null,e,t,!0,r)};hr.hydrateRoot=function(e,t,r){if(!ff(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Vg;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Hg(t,null,e,1,r??null,a,!1,s,i),e[jn]=t.current,el(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new $c(t)};hr.render=function(e,t,r){if(!zc(t))throw Error(te(200));return Wc(null,e,t,!1,r)};hr.unmountComponentAtNode=function(e){if(!zc(e))throw Error(te(40));return e._reactRootContainer?(La(function(){Wc(null,null,e,!1,function(){e._reactRootContainer=null,e[jn]=null})}),!0):!1};hr.unstable_batchedUpdates=af;hr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!zc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return Wc(e,t,r,!1,n)};hr.version="18.3.1-next-f1338f8080-20240426";function Gg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gg)}catch(e){console.error(e)}}Gg(),Gm.exports=hr;var h_=Gm.exports,qg,hx=h_;qg=hx.createRoot,hx.hydrateRoot;/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var xx="popstate";function x_(e={}){function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return J0("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:cl(a)}return p_(t,r,null,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vr(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function m_(){return Math.random().toString(36).substring(2,10)}function mx(e,t){return{usr:e.state,key:e.key,idx:t}}function J0(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Zs(t):t,state:r,key:t&&t.key||n||m_()}}function cl({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Zs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function p_(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o="POP",c=null,u=d();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function d(){return(i.state||{idx:null}).idx}function f(){o="POP";let w=d(),y=w==null?null:w-u;u=w,c&&c({action:o,location:x.location,delta:y})}function h(w,y){o="PUSH";let p=J0(x.location,w,y);u=d()+1;let g=mx(p,u),b=x.createHref(p);try{i.pushState(g,"",b)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(b)}s&&c&&c({action:o,location:x.location,delta:1})}function m(w,y){o="REPLACE";let p=J0(x.location,w,y);u=d();let g=mx(p,u),b=x.createHref(p);i.replaceState(g,"",b),s&&c&&c({action:o,location:x.location,delta:0})}function v(w){return g_(w)}let x={get action(){return o},get location(){return e(a,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(xx,f),c=w,()=>{a.removeEventListener(xx,f),c=null}},createHref(w){return t(a,w)},createURL:v,encodeLocation(w){let y=v(w);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(w){return i.go(w)}};return x}function g_(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xe(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:cl(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Kg(e,t,r="/"){return v_(e,t,r,!1)}function v_(e,t,r,n){let a=typeof t=="string"?Zs(t):t,s=Nn(a.pathname||"/",r);if(s==null)return null;let i=Xg(e);y_(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=A_(s);o=N_(i[c],u,n)}return o}function Xg(e,t=[],r=[],n="",a=!1){let s=(i,o,c=a,u)=>{let d={relativePath:u===void 0?i.path||"":u,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Xe(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=wn([n,d.relativePath]),h=r.concat(d);i.children&&i.children.length>0&&(Xe(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Xg(i.children,t,h,f,c)),!(i.path==null&&!i.index)&&t.push({path:f,score:E_(f,i.index),routesMeta:h})};return e.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,o);else for(let u of Yg(i.path))s(i,o,!0,u)}),t}function Yg(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Yg(n.join("/")),o=[];return o.push(...i.map(c=>c===""?s:[s,c].join("/"))),a&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function y_(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:T_(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var w_=/^:[\w-]+$/,__=3,b_=2,S_=1,k_=10,j_=-2,px=e=>e==="*";function E_(e,t){let r=e.split("/"),n=r.length;return r.some(px)&&(n+=j_),t&&(n+=b_),r.filter(a=>!px(a)).reduce((a,s)=>a+(w_.test(s)?__:s===""?S_:k_),n)}function T_(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function N_(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=lc({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=lc({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),i.push({params:a,pathname:wn([s,f.pathname]),pathnameBase:D_(wn([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=wn([s,f.pathnameBase]))}return i}function lc(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=C_(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},h)=>{if(d==="*"){let v=o[h]||"";i=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=o[h];return f&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:i,pattern:e}}function C_(e,t=!1,r=!0){Vr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function A_(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vr(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Nn(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function P_(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Zs(e):e;return{pathname:r?r.startsWith("/")?r:O_(r,t):t,search:R_(n),hash:L_(a)}}function O_(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Iu(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function F_(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function hf(e){let t=F_(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function xf(e,t,r,n=!1){let a;typeof e=="string"?a=Zs(e):(a={...e},Xe(!a.pathname||!a.pathname.includes("?"),Iu("?","pathname","search",a)),Xe(!a.pathname||!a.pathname.includes("#"),Iu("#","pathname","hash",a)),Xe(!a.search||!a.search.includes("#"),Iu("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;a.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=P_(a,o),u=i&&i!=="/"&&i.endsWith("/"),d=(s||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var wn=e=>e.join("/").replace(/\/\/+/g,"/"),D_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),R_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,L_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function M_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Jg=["POST","PUT","PATCH","DELETE"];new Set(Jg);var I_=["GET",...Jg];new Set(I_);var ei=T.createContext(null);ei.displayName="DataRouter";var Hc=T.createContext(null);Hc.displayName="DataRouterState";T.createContext(!1);var Qg=T.createContext({isTransitioning:!1});Qg.displayName="ViewTransition";var B_=T.createContext(new Map);B_.displayName="Fetchers";var U_=T.createContext(null);U_.displayName="Await";var Gr=T.createContext(null);Gr.displayName="Navigation";var Nl=T.createContext(null);Nl.displayName="Location";var dn=T.createContext({outlet:null,matches:[],isDataRoute:!1});dn.displayName="Route";var mf=T.createContext(null);mf.displayName="RouteError";function $_(e,{relative:t}={}){Xe(ti(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=T.useContext(Gr),{hash:a,pathname:s,search:i}=Cl(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:wn([r,s])),n.createHref({pathname:o,search:i,hash:a})}function ti(){return T.useContext(Nl)!=null}function On(){return Xe(ti(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(Nl).location}var Zg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function e1(e){T.useContext(Gr).static||T.useLayoutEffect(e)}function Vc(){let{isDataRoute:e}=T.useContext(dn);return e?eb():z_()}function z_(){Xe(ti(),"useNavigate() may be used only in the context of a <Router> component.");let e=T.useContext(ei),{basename:t,navigator:r}=T.useContext(Gr),{matches:n}=T.useContext(dn),{pathname:a}=On(),s=JSON.stringify(hf(n)),i=T.useRef(!1);return e1(()=>{i.current=!0}),T.useCallback((c,u={})=>{if(Vr(i.current,Zg),!i.current)return;if(typeof c=="number"){r.go(c);return}let d=xf(c,JSON.parse(s),a,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:wn([t,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[t,r,s,a,e])}T.createContext(null);function Cl(e,{relative:t}={}){let{matches:r}=T.useContext(dn),{pathname:n}=On(),a=JSON.stringify(hf(r));return T.useMemo(()=>xf(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function W_(e,t){return t1(e,t)}function t1(e,t,r,n,a){var p;Xe(ti(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=T.useContext(Gr),{matches:i}=T.useContext(dn),o=i[i.length-1],c=o?o.params:{},u=o?o.pathname:"/",d=o?o.pathnameBase:"/",f=o&&o.route;{let g=f&&f.path||"";r1(u,!f||g.endsWith("*")||g.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${g}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${g}"> to <Route path="${g==="/"?"*":`${g}/*`}">.`)}let h=On(),m;if(t){let g=typeof t=="string"?Zs(t):t;Xe(d==="/"||((p=g.pathname)==null?void 0:p.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${g.pathname}" was given in the \`location\` prop.`),m=g}else m=h;let v=m.pathname||"/",x=v;if(d!=="/"){let g=d.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(g.length).join("/")}let w=Kg(e,{pathname:x});Vr(f||w!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Vr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=K_(w&&w.map(g=>Object.assign({},g,{params:Object.assign({},c,g.params),pathname:wn([d,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?d:wn([d,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n,a);return t&&y?T.createElement(Nl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},y):y}function H_(){let e=Z_(),t=M_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:s},"ErrorBoundary")," or"," ",T.createElement("code",{style:s},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},t),r?T.createElement("pre",{style:a},r):null,i)}var V_=T.createElement(H_,null),G_=class extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?T.createElement(dn.Provider,{value:this.props.routeContext},T.createElement(mf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function q_({routeContext:e,match:t,children:r}){let n=T.useContext(ei);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),T.createElement(dn.Provider,{value:e},r)}function K_(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let u=s.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);Xe(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let o=!1,c=-1;if(r)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=r,m=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!h||h[d.route.id]===void 0);if(d.route.lazy||m){o=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,m=!1,v=null,x=null;r&&(h=i&&d.route.id?i[d.route.id]:void 0,v=d.route.errorElement||V_,o&&(c<0&&f===0?(r1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,x=null):c===f&&(m=!0,x=d.route.hydrateFallbackElement||null)));let w=t.concat(s.slice(0,f+1)),y=()=>{let p;return h?p=v:m?p=x:d.route.Component?p=T.createElement(d.route.Component,null):d.route.element?p=d.route.element:p=u,T.createElement(q_,{match:d,routeContext:{outlet:u,matches:w,isDataRoute:r!=null},children:p})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?T.createElement(G_,{location:r.location,revalidation:r.revalidation,component:v,error:h,children:y(),routeContext:{outlet:null,matches:w,isDataRoute:!0},unstable_onError:n}):y()},null)}function pf(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function X_(e){let t=T.useContext(ei);return Xe(t,pf(e)),t}function Y_(e){let t=T.useContext(Hc);return Xe(t,pf(e)),t}function J_(e){let t=T.useContext(dn);return Xe(t,pf(e)),t}function gf(e){let t=J_(e),r=t.matches[t.matches.length-1];return Xe(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Q_(){return gf("useRouteId")}function Z_(){var n;let e=T.useContext(mf),t=Y_("useRouteError"),r=gf("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function eb(){let{router:e}=X_("useNavigate"),t=gf("useNavigate"),r=T.useRef(!1);return e1(()=>{r.current=!0}),T.useCallback(async(a,s={})=>{Vr(r.current,Zg),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var gx={};function r1(e,t,r){!t&&!gx[e]&&(gx[e]=!0,Vr(!1,r))}T.memo(tb);function tb({routes:e,future:t,state:r,unstable_onError:n}){return t1(e,void 0,r,n,t)}function Q0({to:e,replace:t,state:r,relative:n}){Xe(ti(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=T.useContext(Gr);Vr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=T.useContext(dn),{pathname:i}=On(),o=Vc(),c=xf(e,hf(s),i,n==="path"),u=JSON.stringify(c);return T.useEffect(()=>{o(JSON.parse(u),{replace:t,state:r,relative:n})},[o,u,n,t,r]),null}function $e(e){Xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rb({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Xe(!ti(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),o=T.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof r=="string"&&(r=Zs(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:h="default"}=r,m=T.useMemo(()=>{let v=Nn(c,i);return v==null?null:{location:{pathname:v,search:u,hash:d,state:f,key:h},navigationType:n}},[i,c,u,d,f,h,n]);return Vr(m!=null,`<Router basename="${i}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:T.createElement(Gr.Provider,{value:o},T.createElement(Nl.Provider,{children:t,value:m}))}function so({children:e,location:t}){return W_(Z0(e),t)}function Z0(e,t=[]){let r=[];return T.Children.forEach(e,(n,a)=>{if(!T.isValidElement(n))return;let s=[...t,a];if(n.type===T.Fragment){r.push.apply(r,Z0(n.props.children,s));return}Xe(n.type===$e,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xe(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Z0(n.props.children,s)),r.push(i)}),r}var Ro="get",Lo="application/x-www-form-urlencoded";function Gc(e){return e!=null&&typeof e.tagName=="string"}function nb(e){return Gc(e)&&e.tagName.toLowerCase()==="button"}function ab(e){return Gc(e)&&e.tagName.toLowerCase()==="form"}function sb(e){return Gc(e)&&e.tagName.toLowerCase()==="input"}function ib(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function lb(e,t){return e.button===0&&(!t||t==="_self")&&!ib(e)}var io=null;function ob(){if(io===null)try{new FormData(document.createElement("form"),0),io=!1}catch{io=!0}return io}var cb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Bu(e){return e!=null&&!cb.has(e)?(Vr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lo}"`),null):e}function ub(e,t){let r,n,a,s,i;if(ab(e)){let o=e.getAttribute("action");n=o?Nn(o,t):null,r=e.getAttribute("method")||Ro,a=Bu(e.getAttribute("enctype"))||Lo,s=new FormData(e)}else if(nb(e)||sb(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||o.getAttribute("action");if(n=c?Nn(c,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Ro,a=Bu(e.getAttribute("formenctype"))||Bu(o.getAttribute("enctype"))||Lo,s=new FormData(o,e),!ob()){let{name:u,type:d,value:f}=e;if(d==="image"){let h=u?`${u}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else u&&s.append(u,f)}}else{if(Gc(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ro,n=null,a=Lo,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function vf(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function db(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Nn(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function fb(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function hb(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function xb(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await fb(s,r);return i.links?i.links():[]}return[]}));return vb(n.flat(1).filter(hb).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function vx(e,t,r,n,a,s){let i=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,o=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?t.filter((c,u)=>i(c,u)||o(c,u)):s==="data"?t.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(i(c,u)||o(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function mb(e,t,{includeHydrateFallback:r}={}){return pb(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function pb(e){return[...new Set(e)]}function gb(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function vb(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(gb(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function n1(){let e=T.useContext(ei);return vf(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function yb(){let e=T.useContext(Hc);return vf(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var yf=T.createContext(void 0);yf.displayName="FrameworkContext";function a1(){let e=T.useContext(yf);return vf(e,"You must render this element inside a <HydratedRouter> element"),e}function wb(e,t){let r=T.useContext(yf),[n,a]=T.useState(!1),[s,i]=T.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=t,h=T.useRef(null);T.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let x=y=>{y.forEach(p=>{i(p.isIntersecting)})},w=new IntersectionObserver(x,{threshold:.5});return h.current&&w.observe(h.current),()=>{w.disconnect()}}},[e]),T.useEffect(()=>{if(n){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[n]);let m=()=>{a(!0)},v=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,h,{}]:[s,h,{onFocus:yi(o,m),onBlur:yi(c,v),onMouseEnter:yi(u,m),onMouseLeave:yi(d,v),onTouchStart:yi(f,m)}]:[!1,h,{}]}function yi(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function _b({page:e,...t}){let{router:r}=n1(),n=T.useMemo(()=>Kg(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?T.createElement(Sb,{page:e,matches:n,...t}):null}function bb(e){let{manifest:t,routeModules:r}=a1(),[n,a]=T.useState([]);return T.useEffect(()=>{let s=!1;return xb(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function Sb({page:e,matches:t,...r}){let n=On(),{manifest:a,routeModules:s}=a1(),{basename:i}=n1(),{loaderData:o,matches:c}=yb(),u=T.useMemo(()=>vx(e,t,c,a,n,"data"),[e,t,c,a,n]),d=T.useMemo(()=>vx(e,t,c,a,n,"assets"),[e,t,c,a,n]),f=T.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let v=new Set,x=!1;if(t.forEach(y=>{var g;let p=a.routes[y.route.id];!p||!p.hasLoader||(!u.some(b=>b.route.id===y.route.id)&&y.route.id in o&&((g=s[y.route.id])!=null&&g.shouldRevalidate)||p.hasClientLoader?x=!0:v.add(y.route.id))}),v.size===0)return[];let w=db(e,i,"data");return x&&v.size>0&&w.searchParams.set("_routes",t.filter(y=>v.has(y.route.id)).map(y=>y.route.id).join(",")),[w.pathname+w.search]},[i,o,n,a,u,t,e,s]),h=T.useMemo(()=>mb(d,a),[d,a]),m=bb(d);return T.createElement(T.Fragment,null,f.map(v=>T.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...r})),h.map(v=>T.createElement("link",{key:v,rel:"modulepreload",href:v,...r})),m.map(({key:v,link:x})=>T.createElement("link",{key:v,nonce:r.nonce,...x})))}function kb(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var s1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{s1&&(window.__reactRouterVersion="7.8.2")}catch{}function jb({basename:e,children:t,window:r}){let n=T.useRef();n.current==null&&(n.current=x_({window:r,v5Compat:!0}));let a=n.current,[s,i]=T.useState({action:a.action,location:a.location}),o=T.useCallback(c=>{T.startTransition(()=>i(c))},[i]);return T.useLayoutEffect(()=>a.listen(o),[a,o]),T.createElement(rb,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:a})}var i1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,l1=T.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:o,target:c,to:u,preventScrollReset:d,viewTransition:f,...h},m){let{basename:v}=T.useContext(Gr),x=typeof u=="string"&&i1.test(u),w,y=!1;if(typeof u=="string"&&x&&(w=u,s1))try{let _=new URL(window.location.href),N=u.startsWith("//")?new URL(_.protocol+u):new URL(u),B=Nn(N.pathname,v);N.origin===_.origin&&B!=null?u=B+N.search+N.hash:y=!0}catch{Vr(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let p=$_(u,{relative:a}),[g,b,j]=wb(n,h),A=Cb(u,{replace:i,state:o,target:c,preventScrollReset:d,relative:a,viewTransition:f});function k(_){t&&t(_),_.defaultPrevented||A(_)}let D=T.createElement("a",{...h,...j,href:w||p,onClick:y||s?t:k,ref:kb(m,b),target:c,"data-discover":!x&&r==="render"?"true":void 0});return g&&!x?T.createElement(T.Fragment,null,D,T.createElement(_b,{page:p})):D});l1.displayName="Link";var Eb=T.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:o,children:c,...u},d){let f=Cl(i,{relative:u.relative}),h=On(),m=T.useContext(Hc),{navigator:v,basename:x}=T.useContext(Gr),w=m!=null&&Db(f)&&o===!0,y=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,p=h.pathname,g=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(p=p.toLowerCase(),g=g?g.toLowerCase():null,y=y.toLowerCase()),g&&x&&(g=Nn(g,x)||g);const b=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let j=p===y||!a&&p.startsWith(y)&&p.charAt(b)==="/",A=g!=null&&(g===y||!a&&g.startsWith(y)&&g.charAt(y.length)==="/"),k={isActive:j,isPending:A,isTransitioning:w},D=j?t:void 0,_;typeof n=="function"?_=n(k):_=[n,j?"active":null,A?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let N=typeof s=="function"?s(k):s;return T.createElement(l1,{...u,"aria-current":D,className:_,ref:d,style:N,to:i,viewTransition:o},typeof c=="function"?c(k):c)});Eb.displayName="NavLink";var Tb=T.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Ro,action:o,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...h},m)=>{let v=Ob(),x=Fb(o,{relative:u}),w=i.toLowerCase()==="get"?"get":"post",y=typeof o=="string"&&i1.test(o),p=g=>{if(c&&c(g),g.defaultPrevented)return;g.preventDefault();let b=g.nativeEvent.submitter,j=(b==null?void 0:b.getAttribute("formmethod"))||i;v(b||g.currentTarget,{fetcherKey:t,method:j,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return T.createElement("form",{ref:m,method:w,action:x,onSubmit:n?c:p,...h,"data-discover":!y&&e==="render"?"true":void 0})});Tb.displayName="Form";function Nb(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o1(e){let t=T.useContext(ei);return Xe(t,Nb(e)),t}function Cb(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let o=Vc(),c=On(),u=Cl(e,{relative:s});return T.useCallback(d=>{if(lb(d,t)){d.preventDefault();let f=r!==void 0?r:cl(c)===cl(u);o(e,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[c,o,u,r,n,t,e,a,s,i])}var Ab=0,Pb=()=>`__${String(++Ab)}__`;function Ob(){let{router:e}=o1("useSubmit"),{basename:t}=T.useContext(Gr),r=Q_();return T.useCallback(async(n,a={})=>{let{action:s,method:i,encType:o,formData:c,body:u}=ub(n,t);if(a.navigate===!1){let d=a.fetcherKey||Pb();await e.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function Fb(e,{relative:t}={}){let{basename:r}=T.useContext(Gr),n=T.useContext(dn);Xe(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...Cl(e||".",{relative:t})},i=On();if(e==null){s.search=i.search;let o=new URLSearchParams(s.search),c=o.getAll("index");if(c.some(d=>d==="")){o.delete("index"),c.filter(f=>f).forEach(f=>o.append("index",f));let d=o.toString();s.search=d?`?${d}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:wn([r,s.pathname])),cl(s)}function Db(e,{relative:t}={}){let r=T.useContext(Qg);Xe(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=o1("useViewTransitionState"),a=Cl(e,{relative:t});if(!r.isTransitioning)return!1;let s=Nn(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Nn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return lc(a.pathname,i)!=null||lc(a.pathname,s)!=null}const Rb={};var ed=null;function Lb(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return Rb.randomBytes(e)}catch{}if(!ed)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return ed(e)}function Mb(e){ed=e}function wf(e,t){if(e=e||_f,typeof e!="number")throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(oc(Lb(ul),ul)),r.join("")}function c1(e,t,r){if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),typeof e>"u")e=_f;else if(typeof e!="number")throw Error("illegal arguments: "+typeof e);function n(a){Ir(function(){try{a(null,wf(e))}catch(s){a(s)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(a,s){n(function(i,o){if(i){s(i);return}a(o)})})}function u1(e,t){if(typeof t>"u"&&(t=_f),typeof t=="number"&&(t=wf(t)),typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return td(e,t)}function d1(e,t,r,n){function a(s){typeof e=="string"&&typeof t=="number"?c1(t,function(i,o){td(e,o,s,n)}):typeof e=="string"&&typeof t=="string"?td(e,t,s,n):Ir(s.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(s,i){a(function(o,c){if(o){i(o);return}s(c)})})}function f1(e,t){for(var r=e.length^t.length,n=0;n<e.length;++n)r|=e.charCodeAt(n)^t.charCodeAt(n);return r===0}function Ib(e,t){if(typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return t.length!==60?!1:f1(u1(e,t.substring(0,t.length-31)),t)}function Bb(e,t,r,n){function a(s){if(typeof e!="string"||typeof t!="string"){Ir(s.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)));return}if(t.length!==60){Ir(s.bind(this,null,!1));return}d1(e,t.substring(0,29),function(i,o){i?s(i):s(null,f1(o,t))},n)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(s,i){a(function(o,c){if(o){i(o);return}s(c)})})}function Ub(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function $b(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);if(e.length!==60)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function zb(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return h1(e)>72}var Ir=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function h1(e){for(var t=0,r=0,n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Wb(e){for(var t=0,r,n,a=new Array(h1(e)),s=0,i=e.length;s<i;++s)r=e.charCodeAt(s),r<128?a[t++]=r:r<2048?(a[t++]=r>>6|192,a[t++]=r&63|128):(r&64512)===55296&&((n=e.charCodeAt(s+1))&64512)===56320?(r=65536+((r&1023)<<10)+(n&1023),++s,a[t++]=r>>18|240,a[t++]=r>>12&63|128,a[t++]=r>>6&63|128,a[t++]=r&63|128):(a[t++]=r>>12|224,a[t++]=r>>6&63|128,a[t++]=r&63|128);return a}var Ya="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Rn=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function oc(e,t){var r=0,n=[],a,s;if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;r<t;){if(a=e[r++]&255,n.push(Ya[a>>2&63]),a=(a&3)<<4,r>=t){n.push(Ya[a&63]);break}if(s=e[r++]&255,a|=s>>4&15,n.push(Ya[a&63]),a=(s&15)<<2,r>=t){n.push(Ya[a&63]);break}s=e[r++]&255,a|=s>>6&3,n.push(Ya[a&63]),n.push(Ya[s&63])}return n.join("")}function x1(e,t){var r=0,n=e.length,a=0,s=[],i,o,c,u,d,f;if(t<=0)throw Error("Illegal len: "+t);for(;r<n-1&&a<t&&(f=e.charCodeAt(r++),i=f<Rn.length?Rn[f]:-1,f=e.charCodeAt(r++),o=f<Rn.length?Rn[f]:-1,!(i==-1||o==-1||(d=i<<2>>>0,d|=(o&48)>>4,s.push(String.fromCharCode(d)),++a>=t||r>=n)||(f=e.charCodeAt(r++),c=f<Rn.length?Rn[f]:-1,c==-1)||(d=(o&15)<<4>>>0,d|=(c&60)>>2,s.push(String.fromCharCode(d)),++a>=t||r>=n)));)f=e.charCodeAt(r++),u=f<Rn.length?Rn[f]:-1,d=(c&3)<<6>>>0,d|=u,s.push(String.fromCharCode(d)),++a;var h=[];for(r=0;r<a;r++)h.push(s[r].charCodeAt(0));return h}var ul=16,_f=10,Hb=16,Vb=100,yx=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],wx=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],m1=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function dl(e,t,r,n){var a,s=e[t],i=e[t+1];return s^=r[0],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[1],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[2],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[3],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[4],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[5],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[6],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[7],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[8],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[9],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[10],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[11],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[12],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[13],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[14],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[15],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[16],e[t]=i^r[Hb+1],e[t+1]=s,e}function is(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|e[t]&255,t=(t+1)%e.length;return{key:n,offp:t}}function _x(e,t,r){for(var n=0,a=[0,0],s=t.length,i=r.length,o,c=0;c<s;c++)o=is(e,n),n=o.offp,t[c]=t[c]^o.key;for(c=0;c<s;c+=2)a=dl(a,0,t,r),t[c]=a[0],t[c+1]=a[1];for(c=0;c<i;c+=2)a=dl(a,0,t,r),r[c]=a[0],r[c+1]=a[1]}function Gb(e,t,r,n){for(var a=0,s=[0,0],i=r.length,o=n.length,c,u=0;u<i;u++)c=is(t,a),a=c.offp,r[u]=r[u]^c.key;for(a=0,u=0;u<i;u+=2)c=is(e,a),a=c.offp,s[0]^=c.key,c=is(e,a),a=c.offp,s[1]^=c.key,s=dl(s,0,r,n),r[u]=s[0],r[u+1]=s[1];for(u=0;u<o;u+=2)c=is(e,a),a=c.offp,s[0]^=c.key,c=is(e,a),a=c.offp,s[1]^=c.key,s=dl(s,0,r,n),n[u]=s[0],n[u+1]=s[1]}function bx(e,t,r,n,a){var s=m1.slice(),i=s.length,o;if(r<4||r>31)if(o=Error("Illegal number of rounds (4-31): "+r),n){Ir(n.bind(this,o));return}else throw o;if(t.length!==ul)if(o=Error("Illegal salt length: "+t.length+" != "+ul),n){Ir(n.bind(this,o));return}else throw o;r=1<<r>>>0;var c,u,d=0,f;typeof Int32Array=="function"?(c=new Int32Array(yx),u=new Int32Array(wx)):(c=yx.slice(),u=wx.slice()),Gb(t,e,c,u);function h(){if(a&&a(d/r),d<r)for(var v=Date.now();d<r&&(d=d+1,_x(e,c,u),_x(t,c,u),!(Date.now()-v>Vb)););else{for(d=0;d<64;d++)for(f=0;f<i>>1;f++)dl(s,f<<1,c,u);var x=[];for(d=0;d<i;d++)x.push((s[d]>>24&255)>>>0),x.push((s[d]>>16&255)>>>0),x.push((s[d]>>8&255)>>>0),x.push((s[d]&255)>>>0);if(n){n(null,x);return}else return x}n&&Ir(h)}if(typeof n<"u")h();else for(var m;;)if(typeof(m=h())<"u")return m||[]}function td(e,t,r,n){var a;if(typeof e!="string"||typeof t!="string")if(a=Error("Invalid string / salt: Not a string"),r){Ir(r.bind(this,a));return}else throw a;var s,i;if(t.charAt(0)!=="$"||t.charAt(1)!=="2")if(a=Error("Invalid salt version: "+t.substring(0,2)),r){Ir(r.bind(this,a));return}else throw a;if(t.charAt(2)==="$")s="\0",i=3;else{if(s=t.charAt(2),s!=="a"&&s!=="b"&&s!=="y"||t.charAt(3)!=="$")if(a=Error("Invalid salt revision: "+t.substring(2,4)),r){Ir(r.bind(this,a));return}else throw a;i=4}if(t.charAt(i+2)>"$")if(a=Error("Missing salt rounds"),r){Ir(r.bind(this,a));return}else throw a;var o=parseInt(t.substring(i,i+1),10)*10,c=parseInt(t.substring(i+1,i+2),10),u=o+c,d=t.substring(i+3,i+25);e+=s>="a"?"\0":"";var f=Wb(e),h=x1(d,ul);function m(v){var x=[];return x.push("$2"),s>="a"&&x.push(s),x.push("$"),u<10&&x.push("0"),x.push(u.toString()),x.push("$"),x.push(oc(h,h.length)),x.push(oc(v,m1.length*4-1)),x.join("")}if(typeof r>"u")return m(bx(f,h,u));bx(f,h,u,function(v,x){v?r(v,null):r(null,m(x))},n)}function qb(e,t){return oc(e,t)}function Kb(e,t){return x1(e,t)}const Xb={setRandomFallback:Mb,genSaltSync:wf,genSalt:c1,hashSync:u1,hash:d1,compareSync:Ib,compare:Bb,getRounds:Ub,getSalt:$b,truncates:zb,encodeBase64:qb,decodeBase64:Kb},Yb="modulepreload",Jb=function(e){return"/"+e},Sx={},Al=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Jb(c),c in Sx)return;Sx[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Yb,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},Qb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Al(async()=>{const{default:n}=await Promise.resolve().then(()=>ri);return{default:n}},[]).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class bf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Zb extends bf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class kx extends bf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class jx extends bf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var rd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(rd||(rd={}));var e4=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class t4{constructor(t,{headers:r={},customFetch:n,region:a=rd.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Qb(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return e4(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(o["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(o["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(o["Content-Type"]="application/json",d=JSON.stringify(i)));const f=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:d}).catch(x=>{throw new Zb(x)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new kx(f);if(!f.ok)throw new jx(f);let m=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return m==="application/json"?v=yield f.json():m==="application/octet-stream"?v=yield f.blob():m==="text/event-stream"?v=f:m==="multipart/form-data"?v=yield f.formData():v=yield f.text(),{data:v,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof jx||a instanceof kx?a.context:void 0}}})}}var Yt={},Sf={},qc={},Pl={},Kc={},Xc={},r4=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Hs=r4();const n4=Hs.fetch,p1=Hs.fetch.bind(Hs),g1=Hs.Headers,a4=Hs.Request,s4=Hs.Response,ri=Object.freeze(Object.defineProperty({__proto__:null,Headers:g1,Request:a4,Response:s4,default:p1,fetch:n4},Symbol.toStringTag,{value:"Module"})),i4=$y(ri);var Yc={};Object.defineProperty(Yc,"__esModule",{value:!0});let l4=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Yc.default=l4;var v1=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xc,"__esModule",{value:!0});const o4=v1(i4),c4=v1(Yc);let u4=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=o4.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,c,u;let d=null,f=null,h=null,m=s.status,v=s.statusText;if(s.ok){if(this.method!=="HEAD"){const p=await s.text();p===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=p:f=JSON.parse(p))}const w=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(c=s.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");w&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,m=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const w=await s.text();try{d=JSON.parse(w),Array.isArray(d)&&s.status===404&&(f=[],d=null,m=200,v="OK")}catch{s.status===404&&w===""?(m=204,v="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,m=200,v="OK"),d&&this.shouldThrowOnError)throw new c4.default(d)}return{error:d,data:f,count:h,status:m,statusText:v}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,c;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=s==null?void 0:s.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Xc.default=u4;var d4=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kc,"__esModule",{value:!0});const f4=d4(Xc);let h4=class extends f4.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Kc.default=h4;var x4=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pl,"__esModule",{value:!0});const m4=x4(Kc);let p4=class extends m4.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Pl.default=p4;var g4=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qc,"__esModule",{value:!0});const wi=g4(Pl);let v4=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new wi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new wi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new wi.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new wi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new wi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};qc.default=v4;var y1=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sf,"__esModule",{value:!0});const y4=y1(qc),w4=y1(Pl);let _4=class w1{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new y4.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new w1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(o="POST",u=r);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new w4.default({method:o,url:c,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Sf.default=_4;var ni=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.PostgrestError=Yt.PostgrestBuilder=Yt.PostgrestTransformBuilder=Yt.PostgrestFilterBuilder=Yt.PostgrestQueryBuilder=Yt.PostgrestClient=void 0;const _1=ni(Sf);Yt.PostgrestClient=_1.default;const b1=ni(qc);Yt.PostgrestQueryBuilder=b1.default;const S1=ni(Pl);Yt.PostgrestFilterBuilder=S1.default;const k1=ni(Kc);Yt.PostgrestTransformBuilder=k1.default;const j1=ni(Xc);Yt.PostgrestBuilder=j1.default;const E1=ni(Yc);Yt.PostgrestError=E1.default;var b4=Yt.default={PostgrestClient:_1.default,PostgrestQueryBuilder:b1.default,PostgrestFilterBuilder:S1.default,PostgrestTransformBuilder:k1.default,PostgrestBuilder:j1.default,PostgrestError:E1.default};const{PostgrestClient:S4,PostgrestQueryBuilder:jA,PostgrestFilterBuilder:EA,PostgrestTransformBuilder:TA,PostgrestBuilder:NA,PostgrestError:CA}=b4;class k4{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const j4="2.15.5",E4=`realtime-js/${j4}`,T4="1.0.0",nd=1e4,N4=1e3,C4=100;var Mi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Mi||(Mi={}));var dt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(dt||(dt={}));var Rr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Rr||(Rr={}));var ad;(function(e){e.websocket="websocket"})(ad||(ad={}));var Sa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Sa||(Sa={}));class A4{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const c=n.decode(t.slice(i,i+s));i=i+s;const u=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class T1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var We;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(We||(We={}));const Ex=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=P4(i,e,t,a),s),{})},P4=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?N1(s,i):sd(i)},N1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return R4(t,r)}switch(e){case We.bool:return O4(t);case We.float4:case We.float8:case We.int2:case We.int4:case We.int8:case We.numeric:case We.oid:return F4(t);case We.json:case We.jsonb:return D4(t);case We.timestamp:return L4(t);case We.abstime:case We.date:case We.daterange:case We.int4range:case We.int8range:case We.money:case We.reltime:case We.text:case We.time:case We.timestamptz:case We.timetz:case We.tsrange:case We.tstzrange:return sd(t);default:return sd(t)}},sd=e=>e,O4=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},F4=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},D4=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},R4=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>N1(t,o))}return e},L4=e=>typeof e=="string"?e.replace(" ","T"):e,C1=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Uu{constructor(t,r,n={},a=nd){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Tx;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Tx||(Tx={}));class Ii{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ii.syncState(this.state,a,s,i),this.pendingDiffs.forEach(c=>{this.state=Ii.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ii.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(s,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=s[u];if(f){const h=d.map(w=>w.presence_ref),m=f.map(w=>w.presence_ref),v=d.filter(w=>m.indexOf(w.presence_ref)<0),x=f.filter(w=>h.indexOf(w.presence_ref)<0);v.length>0&&(o[u]=v),x.length>0&&(c[u]=x)}else o[u]=d}),this.syncDiff(s,{joins:o,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);t[o].unshift(...h)}n(o,d,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,a(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Nx;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Nx||(Nx={}));var Bi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Bi||(Bi={}));var mn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(mn||(mn={}));class kf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Uu(this,Rr.join,this.params,this.timeout),this.rejoinTimer=new T1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rr.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Ii(this),this.broadcastEndpointURL=C1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==dt.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[Bi.PRESENCE]&&this.bindings[Bi.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(mn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(mn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var v;if(this.socket.setAuth(),m===void 0){t==null||t(mn.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,w=(v=x==null?void 0:x.length)!==null&&v!==void 0?v:0,y=[];for(let p=0;p<w;p++){const g=x[p],{filter:{event:b,schema:j,table:A,filter:k}}=g,D=m&&m[p];if(D&&D.event===b&&D.schema===j&&D.table===A&&D.filter===k)y.push(Object.assign(Object.assign({},g),{id:D.id}));else{this.unsubscribe(),this.state=dt.errored,t==null||t(mn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(mn.SUBSCRIBED);return}}).receive("error",m=>{this.state=dt.errored,t==null||t(mn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(mn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===dt.joined&&t===Bi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=dt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Uu(this,Rr.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=dt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Uu(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>C4){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=Rr;if(n&&[o,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var v,x,w;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((w=(x=m.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(m=>{var v,x,w,y,p,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const b=m.id,j=(v=m.filter)===null||v===void 0?void 0:v.event;return b&&((x=r.ids)===null||x===void 0?void 0:x.includes(b))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const b=(p=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return b==="*"||b===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:x,table:w,commit_timestamp:y,type:p,errors:g}=v;h=Object.assign(Object.assign({},{schema:x,table:w,commit_timestamp:y,eventType:p,new:{},old:{},errors:g}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===dt.closed}_isJoined(){return this.state===dt.joined}_isJoining(){return this.state===dt.joining}_isLeaving(){return this.state===dt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&kf.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Rr.close,{},t)}_onError(t){this._on(Rr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ex(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ex(t.columns,t.old_record)),r}}const $u=()=>{},lo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},M4=[1e3,2e3,5e3,1e4],I4=1e4,B4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class U4{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=nd,this.transport=null,this.heartbeatIntervalMs=lo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$u,this.ref=0,this.reconnectTimer=null,this.logger=$u,this.conn=null,this.sendBuffer=[],this.serializer=new A4,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>Al(async()=>{const{default:o}=await Promise.resolve().then(()=>ri);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ad.websocket}`,this.httpEndpoint=C1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=k4.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:T4}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Mi.connecting:return Sa.Connecting;case Mi.open:return Sa.Open;case Mi.closing:return Sa.Closing;default:return Sa.Closed}}isConnected(){return this.connectionState()===Sa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new kf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(N4,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},lo.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${a} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Rr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([B4],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:E4};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Rr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new T1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:nd,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:lo.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:$u,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>M4[f-1]||I4,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(f,h)=>h(JSON.stringify(f)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class jf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ht(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class $4 extends jf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class id extends jf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var z4=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const A1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Al(async()=>{const{default:n}=await Promise.resolve().then(()=>ri);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},W4=()=>z4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Al(()=>Promise.resolve().then(()=>ri),void 0)).Response:Response}),ld=e=>{if(Array.isArray(e))return e.map(r=>ld(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=ld(n)}),t},H4=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var za=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const zu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),V4=(e,t,r)=>za(void 0,void 0,void 0,function*(){const n=yield W4();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new $4(zu(a),s,i))}).catch(a=>{t(new id(zu(a),a))}):t(new id(zu(e),e))}),G4=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(H4(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Ol(e,t,r,n,a,s){return za(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,G4(t,n,a,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>V4(c,o,n))})})}function cc(e,t,r,n){return za(this,void 0,void 0,function*(){return Ol(e,"GET",t,r,n)})}function en(e,t,r,n,a){return za(this,void 0,void 0,function*(){return Ol(e,"POST",t,n,a,r)})}function od(e,t,r,n,a){return za(this,void 0,void 0,function*(){return Ol(e,"PUT",t,n,a,r)})}function q4(e,t,r,n){return za(this,void 0,void 0,function*(){return Ol(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function P1(e,t,r,n,a){return za(this,void 0,void 0,function*(){return Ol(e,"DELETE",t,n,a,r)})}var Ut=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const K4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class X4{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=A1(a)}uploadOrUpdate(t,r,n,a){return Ut(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Cx),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?od:en)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(ht(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Ut(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Ut(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Cx.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield od(this.fetch,o.toString(),c,{headers:d});return{data:{path:s,fullPath:f.Key},error:null}}catch(c){if(ht(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Ut(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield en(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new jf("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ut(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ut(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ht(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Ut(this,void 0,void 0,function*(){try{return{data:{path:(yield en(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ht(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Ut(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield en(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(ht(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Ut(this,void 0,void 0,function*(){try{const a=yield en(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(ht(a))return{data:null,error:a};throw a}})}download(t,r){return Ut(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield cc(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(ht(o))return{data:null,error:o};throw o}})}info(t){return Ut(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield cc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ld(n),error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}})}exists(t){return Ut(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield q4(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ht(n)&&n instanceof id){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield P1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ht(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ut(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},K4),r),{prefix:t||""});return{data:yield en(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(ht(a))return{data:null,error:a};throw a}})}listV2(t,r){return Ut(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield en(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Y4="2.11.1",J4={"X-Client-Info":`storage-js/${Y4}`};var Ja=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Q4{constructor(t,r={},n,a){const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},J4),r),this.fetch=A1(n)}listBuckets(){return Ja(this,void 0,void 0,function*(){try{return{data:yield cc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ht(t))return{data:null,error:t};throw t}})}getBucket(t){return Ja(this,void 0,void 0,function*(){try{return{data:yield cc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ht(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ja(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ja(this,void 0,void 0,function*(){try{return{data:yield od(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ja(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ht(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ja(this,void 0,void 0,function*(){try{return{data:yield P1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ht(r))return{data:null,error:r};throw r}})}}class Z4 extends Q4{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new X4(this.url,this.headers,t,this.fetch)}}const eS="2.57.2";let Ei="";typeof Deno<"u"?Ei="deno":typeof document<"u"?Ei="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ei="react-native":Ei="node";const tS={"X-Client-Info":`supabase-js-${Ei}/${eS}`},rS={headers:tS},nS={schema:"public"},aS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sS={};var iS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const lS=e=>{let t;return e?t=e:typeof fetch>"u"?t=p1:t=fetch,(...r)=>t(...r)},oS=()=>typeof Headers>"u"?g1:Headers,cS=(e,t,r)=>{const n=lS(r),a=oS();return(s,i)=>iS(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new a(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},i),{headers:u}))})};var uS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function dS(e){return e.endsWith("/")?e:e+"/"}function fS(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>uS(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const O1="2.71.1",ls=30*1e3,cd=3,Wu=cd*ls,hS="http://localhost:9999",xS="supabase.auth.token",mS={"X-Client-Info":`gotrue-js/${O1}`},ud="X-Supabase-Api-Version",F1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pS=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gS=10*60*1e3;class Ef extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class vS extends Ef{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function yS(e){return ke(e)&&e.name==="AuthApiError"}class D1 extends Ef{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fa extends Ef{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Bn extends fa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function wS(e){return ke(e)&&e.name==="AuthSessionMissingError"}class oo extends fa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class co extends fa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class uo extends fa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _S(e){return ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ax extends fa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dd extends fa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Hu(e){return ke(e)&&e.name==="AuthRetryableFetchError"}class Px extends fa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class fd extends fa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const uc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ox=` 	
\r=`.split(""),bS=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ox.length;t+=1)e[Ox[t].charCodeAt(0)]=-2;for(let t=0;t<uc.length;t+=1)e[uc[t].charCodeAt(0)]=t;return e})();function Fx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uc[n]),t.queuedBits-=6}}function R1(e,t,r){const n=bS[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Dx(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{jS(i,n,r)};for(let i=0;i<e.length;i+=1)R1(e.charCodeAt(i),a,s);return t.join("")}function SS(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function kS(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}SS(n,t)}}function jS(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ES(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)R1(e.charCodeAt(a),r,n);return new Uint8Array(t)}function TS(e){const t=[];return kS(e,r=>t.push(r)),new Uint8Array(t)}function NS(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Fx(a,r,n)),Fx(null,r,n),t.join("")}function CS(e){return Math.round(Date.now()/1e3)+e}function AS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Or=()=>typeof window<"u"&&typeof document<"u",ga={tested:!1,writable:!1},L1=()=>{if(!Or())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ga.tested)return ga.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ga.tested=!0,ga.writable=!0}catch{ga.tested=!0,ga.writable=!1}return ga.writable};function PS(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const M1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Al(async()=>{const{default:n}=await Promise.resolve().then(()=>ri);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},OS=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",os=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},va=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ln=async(e,t)=>{await e.removeItem(t)};class Jc{constructor(){this.promise=new Jc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Jc.promiseConstructor=Promise;function Vu(e){const t=e.split(".");if(t.length!==3)throw new fd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!pS.test(t[n]))throw new fd("JWT not in base64url format");return{header:JSON.parse(Dx(t[0])),payload:JSON.parse(Dx(t[1])),signature:ES(t[2]),raw:{header:t[0],payload:t[1]}}}async function FS(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function DS(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function RS(e){return("0"+e.toString(16)).substr(-2)}function LS(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,RS).join("")}async function MS(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function IS(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await MS(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qa(e,t,r=!1){const n=LS();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await os(e,`${t}-code-verifier`,a);const s=await IS(n);return[s,n===s?"plain":"s256"]}const BS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function US(e){const t=e.headers.get(ud);if(!t||!t.match(BS))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function $S(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function zS(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const WS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Za(e){if(!WS.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Rx(e){return JSON.parse(JSON.stringify(e))}var HS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const _a=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),VS=[502,503,504];async function Lx(e){var t;if(!OS(e))throw new dd(_a(e),0);if(VS.includes(e.status))throw new dd(_a(e),e.status);let r;try{r=await e.json()}catch(s){throw new D1(_a(s),s)}let n;const a=US(e);if(a&&a.getTime()>=F1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Px(_a(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Bn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Px(_a(r),e.status,r.weak_password.reasons);throw new vS(_a(r),e.status||500,n)}const GS=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Te(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[ud]||(s[ud]=F1["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await qS(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function qS(e,t,r,n,a,s){const i=GS(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new dd(_a(c),0)}if(o.ok||await Lx(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await Lx(c)}}function hn(e){var t;let r=null;JS(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=CS(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Mx(e){const t=hn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Hn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function KS(e){return{data:e,error:null}}function XS(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=HS(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function YS(e){return e}function JS(e){return e.access_token&&e.refresh_token&&e.expires_in}const qu=["global","local","others"];var QS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class ZS{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=M1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=qu[0]){if(qu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${qu.join(", ")}`);try{return await Te(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Te(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Hn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=QS(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:XS,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ke(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Te(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Hn})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:YS});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const x=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(v.split(";")[1].split("=")[1]);u[`${w}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ke(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Za(t);try{return await Te(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Hn})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Za(t);try{return await Te(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Hn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Za(t);try{return await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Hn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Za(t.userId);try{const{data:r,error:n}=await Te(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Za(t.userId),Za(t.id);try{return{data:await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}}function Ix(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function e3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const es={debug:!!(globalThis&&L1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class I1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class t3 extends I1{}async function r3(e,t,r){es.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),es.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){es.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{es.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw es.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new t3(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(es.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}e3();const n3={url:hS,storageKey:xS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bx(e,t,r){return await r()}const ts={};class fl{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fl.nextInstanceID,fl.nextInstanceID+=1,this.instanceID>0&&Or()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},n3),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new ZS({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=M1(a.fetch),this.lock=a.lock||Bx,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Or()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=r3:this.lock=Bx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:L1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ix(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Ix(this.memoryStorage)),Or()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ts[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ts[this.storageKey]=Object.assign(Object.assign({},ts[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ts[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ts[this.storageKey]=Object.assign(Object.assign({},ts[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${O1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=PS(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Or()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),_S(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ke(r)?{error:r}:{error:new D1("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:hn}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(ke(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:d,password:f,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Qa(this.storage,this.storageKey)),s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:v},xform:hn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:hn})}else throw new co("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(ke(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Mx})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Mx})}else throw new co("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new oo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,c,u,d,f,h,m;let v,x;if("message"in t)v=t.message,x=t.signature;else{const{chain:w,wallet:y,statement:p,options:g}=t;let b;if(Or())if(typeof y=="object")b=y;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))b=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const j=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const A=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),p?{statement:p}:null));let k;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")k=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)k=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)v=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),x=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${j.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((f=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...g.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const A=await b.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=A}}try{const{data:w,error:y}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:NS(x)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:hn});if(y)throw y;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new oo}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:y})}catch(w){if(ke(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(t){const r=await va(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:hn});if(await Ln(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new oo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(ke(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:hn}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new oo}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Qa(this.storage,this.storageKey));const{error:f}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new co("You must provide either an email or phone number.")}catch(o){if(ke(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:hn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Qa(this.storage,this.storageKey)),await Te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:KS})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Bn;const{error:a}=await Te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new co("You must provide either an email or phone number and a type")}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await va(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Wu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await va(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Gu()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Hn}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bn}:await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Hn})})}catch(r){if(ke(r))return wS(r)&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Bn;const i=a.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await Qa(this.storage,this.storageKey));const{data:u,error:d}=await Te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Hn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Bn;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=Vu(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(ke(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Bn;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Or())throw new uo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new uo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ax("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ax("No code detected.");const{data:p,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!s||!o||!i||!u)throw new uo("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=ls&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const v=h-f;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,d);const{data:x,error:w}=await this._getUser(s);if(w)throw w;const y={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(ke(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await va(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(yS(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=AS(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Qa(this.storage,this.storageKey,!0));try{return await Te(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,c,u,d;const{data:f,error:h}=s;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Te(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return Or()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ke(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Te(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await DS(async a=>(a>0&&await FS(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:hn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&Hu(s)&&Date.now()+i-n<ls})}catch(n){if(this._debug(r,"error",n),ke(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Or()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await va(this.storage,this.storageKey);if(a&&this.userStorage){let i=await va(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await os(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Gu()}else if(a&&!a.user&&!a.user){const i=await va(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Ln(this.storage,this.storageKey+"-user"),await os(this.storage,this.storageKey,a)):a.user=Gu()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Wu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Wu}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Hu(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Bn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Jc;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Bn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),ke(s)){const i={session:null,error:s};return Hu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await os(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=Rx(a);await os(this.storage,this.storageKey,s)}else{const a=Rx(r);await os(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ln(this.storage,this.storageKey),await Ln(this.storage,this.storageKey+"-code-verifier"),await Ln(this.storage,this.storageKey+"-user"),this.userStorage&&await Ln(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Or()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ls);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/ls);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ls}ms, refresh threshold is ${cd} ticks`),a<=cd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof I1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Or()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Qa(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Te(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Te(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(ke(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ke(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Vu(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+gS>a)return n;const{data:s,error:i}=await Te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:c}}=Vu(n);r!=null&&r.allowExpired||$S(s.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:a,signature:i},error:null}}const d=zS(a.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,TS(`${o}.${c}`)))throw new fd("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}}fl.nextInstanceID=0;const a3=fl;class s3 extends a3{constructor(t){super(t)}}var i3=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class l3{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=dS(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:nS,realtime:sS,auth:Object.assign(Object.assign({},aS),{storageKey:u}),global:rS},f=fS(n??{},d);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=cS(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new S4(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Z4(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new t4(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return i3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:c,debug:u},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new s3({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:c,debug:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new U4(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const o3=(e,t,r)=>new l3(e,t,r);function c3(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}c3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const u3="https://qutgilqvfcfhltciuaij.supabase.co",d3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF1dGdpbHF2ZmNmaGx0Y2l1YWlqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczMDMyOTcsImV4cCI6MjA3Mjg3OTI5N30.12PGroQ40ZSPGG3aTznZ1gF7yd28b9IxFyE-SaQbivQ",Y=o3(u3,d3),B1=T.createContext(void 0);function _t(){const e=T.useContext(B1);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function f3({children:e}){const[t,r]=T.useState(null),[n,a]=T.useState(null),[s,i]=T.useState(!0);T.useEffect(()=>{const d=localStorage.getItem("lms_user");if(d){const f=JSON.parse(d);r(f),a(f)}i(!1)},[]);async function o(d,f){try{const{data:h,error:m}=await Y.from("users").select("id, nama, email, role, password").eq("email",d).single();if(m||!h)throw new Error("Email tidak ditemukan");let v=!1;if(h.password.startsWith("$2")?v=await Xb.compare(f,h.password):v=f===h.password,!v)throw console.log("Password comparison failed:",{inputPassword:f,storedPassword:h.password,isHashed:h.password.startsWith("$2")}),new Error("Password salah");const x={id:h.id,nama:h.nama,email:h.email,role:h.role};localStorage.setItem("lms_user",JSON.stringify(x)),r(x),a(x)}catch(h){throw new Error(h.message||"Login gagal")}}async function c(){localStorage.removeItem("lms_user"),r(null),a(null)}const u={user:t,profile:n,loading:s,signIn:o,signOut:c};return l.jsx(B1.Provider,{value:u,children:e})}function fo({children:e,requiredRole:t}){const{profile:r,loading:n}=_t();return n?l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):r?t&&r.role!==t?l.jsx(Q0,{to:"/dashboard",replace:!0}):l.jsx(l.Fragment,{children:e}):l.jsx(Q0,{to:"/login",replace:!0})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var h3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ce=(e,t)=>{const r=T.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>T.createElement("svg",{ref:d,...h3,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${x3(e)}`,o].join(" "),...u},[...t.map(([f,h])=>T.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=Ce("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Ce("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=Ce("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Ce("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=Ce("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Ce("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=Ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=Ce("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=Ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=Ce("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=Ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=Ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=Ce("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=Ce("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=Ce("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=Ce("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=Ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=Ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Ce("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=Ce("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=Ce("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=Ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=Ce("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=Ce("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=Ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),S3={admin:[{icon:Ku,label:"Dashboard",path:"/dashboard"},{icon:cn,label:"Kelola Guru",path:"/admin/teachers"},{icon:qs,label:"Kelola Siswa",path:"/admin/students"},{icon:on,label:"Kelola Jurusan",path:"/admin/majors"},{icon:hl,label:"Kelola Kelas",path:"/admin/classes"},{icon:jr,label:"Mata Pelajaran",path:"/admin/subjects"},{icon:Gt,label:"Jadwal",path:"/admin/schedules"},{icon:Ks,label:"Lokasi Absensi",path:"/admin/location-settings"},{icon:hd,label:"Naik Kelas",path:"/admin/promotion"},{icon:w3,label:"Pengaturan",path:"/admin/settings"}],guru:[{icon:Ku,label:"Dashboard",path:"/dashboard"},{icon:$x,label:"Absensi Saya",path:"/teacher/attendance"},{icon:cn,label:"Absensi Siswa",path:"/teacher/student-attendance"},{icon:hd,label:"Materi",path:"/teacher/materials"},{icon:ln,label:"Tugas & Quiz",path:"/teacher/tasks"},{icon:dc,label:"Jurnal",path:"/teacher/journals"},{icon:Vs,label:"Poin Siswa",path:"/teacher/points"}],siswa:[{icon:Ku,label:"Dashboard",path:"/dashboard"},{icon:Gt,label:"Jadwal",path:"/student/schedule"},{icon:$x,label:"Presensi Saya",path:"/student/attendance"},{icon:jr,label:"Materi",path:"/student/materials"},{icon:ln,label:"Tugas",path:"/student/tasks"},{icon:Vs,label:"Poin Saya",path:"/student/points"},{icon:dc,label:"Jurnal",path:"/student/journals"}]};function k3(){const{profile:e,signOut:t}=_t(),r=Vc(),n=On(),[a,s]=T.useState(!1),i=async()=>{try{await t(),r("/login")}catch(c){console.error("Error signing out:",c)}};if(!e)return null;const o=S3[e.role]||[];return l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>s(!a),className:"lg:hidden fixed top-4 left-4 z-50 bg-slate-900 text-white p-2 rounded-lg",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a&&l.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>s(!1)}),l.jsxs("div",{className:`bg-slate-900 text-white w-64 min-h-screen flex flex-col fixed lg:relative z-40 transform transition-transform duration-300 ease-in-out ${a?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:[l.jsxs("div",{className:"p-4 lg:p-6 border-b border-slate-700",children:[l.jsx("h1",{className:"text-lg lg:text-xl font-bold",children:"LMS School"}),l.jsx("p",{className:"text-xs lg:text-sm text-slate-300 mt-1",children:e.role==="admin"?"Administrator":e.role==="guru"?"Guru":"Siswa"})]}),l.jsx("nav",{className:"flex-1 p-4",children:l.jsx("div",{className:"space-y-2",children:o.map(c=>{const u=c.icon,d=n.pathname===c.path;return l.jsxs("button",{onClick:()=>{r(c.path),s(!1)},className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${d?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[l.jsx(u,{size:18}),l.jsx("span",{className:"text-sm lg:text-base",children:c.label})]},c.path)})})}),l.jsxs("div",{className:"p-4 border-t border-slate-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm font-medium truncate",children:e.nama}),l.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.email})]}),l.jsxs("button",{onClick:()=>{i(),s(!1)},className:"w-full flex items-center space-x-3 px-3 py-2 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors",children:[l.jsx(v3,{size:18}),l.jsx("span",{className:"text-sm lg:text-base",children:"Keluar"})]})]})]})]})}function j3(){const{profile:e}=_t();return l.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 sm:px-6 py-4 fixed lg:relative top-0 left-0 right-0 z-30 lg:z-auto",children:l.jsxs("div",{className:"flex items-center justify-between ml-0 lg:ml-0",children:[l.jsx("div",{className:"flex items-center space-x-4 ml-12 lg:ml-0",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-48 sm:w-80"})]})}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-600 transition-colors hidden sm:block",children:[l.jsx(p3,{size:20}),l.jsx("span",{className:"absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:"3"})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx("span",{className:"text-white text-sm font-medium",children:e==null?void 0:e.nama.charAt(0).toUpperCase()})}),l.jsxs("div",{className:"hidden sm:block",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-32",children:e==null?void 0:e.nama}),l.jsx("p",{className:"text-xs text-gray-500 capitalize",children:e==null?void 0:e.role})]})]})]})]})})}function ho({children:e}){return l.jsxs("div",{className:"flex h-screen bg-gray-50 relative",children:[l.jsx(k3,{}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden lg:ml-0",children:[l.jsx(j3,{}),l.jsx("main",{className:"flex-1 overflow-auto p-4 sm:p-6 pt-24 lg:pt-6",children:e})]})]})}function E3(){const[e,t]=T.useState(""),[r,n]=T.useState(""),[a,s]=T.useState(!1),[i,o]=T.useState(!1),[c,u]=T.useState(""),{signIn:d}=_t(),f=Vc(),h=async m=>{m.preventDefault(),o(!0),u("");try{await d(e,r),f("/dashboard")}catch(v){u(v.message)}finally{o(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:l.jsx("div",{className:"max-w-md w-full",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:l.jsx(qs,{className:"w-8 h-8 text-blue-600"})}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"LMS School"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Masuk ke akun Anda"})]}),c&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:c}),l.jsxs("form",{onSubmit:h,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),l.jsx("input",{type:"email",value:e,onChange:m=>t(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"nama@email.com",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:a?"text":"password",value:r,onChange:m=>n(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors pr-12",placeholder:"",required:!0}),l.jsx("button",{type:"button",onClick:()=>s(!a),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?l.jsx(g3,{size:20}):l.jsx(Fl,{size:20})})]})]}),l.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Masuk...":"Masuk"})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:l.jsxs("div",{className:"text-center text-sm text-gray-600",children:[l.jsx("p",{className:"mb-2",children:"Demo Akun:"}),l.jsx("div",{className:"space-y-1 text-xs",children:l.jsxs("div",{className:"space-y-1",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Admin:"})," admin@school.com / admin123"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Guru:"})," guru@school.com / guru123"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Siswa:"})," siswa@school.com / siswa123"]})]})})]})})]})})})}function T3(){const[e,t]=T.useState({totalTeachers:0,totalStudents:0,totalClasses:0,totalSubjects:0,totalSchedules:0,totalMajors:0}),[r,n]=T.useState(!0);T.useEffect(()=>{a()},[]);async function a(){try{const[i,o,c,u,d,f]=await Promise.all([Y.from("users").select("id",{count:"exact",head:!0}).eq("role","guru"),Y.from("users").select("id",{count:"exact",head:!0}).eq("role","siswa"),Y.from("classes").select("id",{count:"exact",head:!0}),Y.from("subjects").select("id",{count:"exact",head:!0}),Y.from("schedules").select("id",{count:"exact",head:!0}),Y.from("majors").select("id",{count:"exact",head:!0})]);t({totalTeachers:i.count||0,totalStudents:o.count||0,totalClasses:c.count||0,totalSubjects:u.count||0,totalSchedules:d.count||0,totalMajors:f.count||0})}catch(i){console.error("Error fetching stats:",i)}finally{n(!1)}}const s=[{title:"Total Guru",value:e.totalTeachers,icon:cn,color:"bg-blue-500",bgColor:"bg-blue-50"},{title:"Total Siswa",value:e.totalStudents,icon:qs,color:"bg-green-500",bgColor:"bg-green-50"},{title:"Total Kelas",value:e.totalClasses,icon:hl,color:"bg-purple-500",bgColor:"bg-purple-50"},{title:"Mata Pelajaran",value:e.totalSubjects,icon:jr,color:"bg-orange-500",bgColor:"bg-orange-50"},{title:"Total Jadwal",value:e.totalSchedules,icon:Gt,color:"bg-indigo-500",bgColor:"bg-indigo-50"},{title:"Total Jurusan",value:e.totalMajors,icon:on,color:"bg-pink-500",bgColor:"bg-pink-50"}];return r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Admin"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Selamat datang di panel administrasi LMS School"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:s.map((i,o)=>{const c=i.icon;return l.jsx("div",{className:`${i.bgColor} rounded-xl p-6 border border-gray-100`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:i.title}),l.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:i.value})]}),l.jsx("div",{className:`${i.color} rounded-full p-3`,children:l.jsx(c,{size:24,className:"text-white"})})]})},o)})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aksi Cepat"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{className:"w-full flex items-center justify-between p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[l.jsx("span",{className:"font-medium text-blue-900",children:"Tambah Guru Baru"}),l.jsx(cn,{className:"text-blue-600",size:18})]}),l.jsxs("button",{className:"w-full flex items-center justify-between p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[l.jsx("span",{className:"font-medium text-green-900",children:"Tambah Siswa Baru"}),l.jsx(qs,{className:"text-green-600",size:18})]}),l.jsxs("button",{className:"w-full flex items-center justify-between p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[l.jsx("span",{className:"font-medium text-purple-900",children:"Buat Kelas Baru"}),l.jsx(hl,{className:"text-purple-600",size:18})]}),l.jsxs("button",{className:"w-full flex items-center justify-between p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[l.jsx("span",{className:"font-medium text-orange-900",children:"Proses Naik Kelas"}),l.jsx(on,{className:"text-orange-600",size:18})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aktivitas Terbaru"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Guru baru bergabung"}),l.jsx("p",{className:"text-xs text-gray-500",children:"2 jam yang lalu"})]})]}),l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:"10 siswa baru terdaftar"}),l.jsx("p",{className:"text-xs text-gray-500",children:"5 jam yang lalu"})]})]}),l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-2"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Jadwal baru dibuat"}),l.jsx("p",{className:"text-xs text-gray-500",children:"1 hari yang lalu"})]})]})]})]})]})]})}const U1=6048e5,N3=864e5,zx=Symbol.for("constructDateFrom");function sa(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&zx in e?e[zx](t):e instanceof Date?new e.constructor(t):new Date(t)}function Tr(e,t){return sa(t||e,e)}let C3={};function Qc(){return C3}function ml(e,t){var o,c,u,d;const r=Qc(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Tr(e,t==null?void 0:t.in),s=a.getDay(),i=(s<n?7:0)+s-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function hc(e,t){return ml(e,{...t,weekStartsOn:1})}function $1(e,t){const r=Tr(e,t==null?void 0:t.in),n=r.getFullYear(),a=sa(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=hc(a),i=sa(r,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=hc(i);return r.getTime()>=s.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function Wx(e){const t=Tr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function A3(e,...t){const r=sa.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function Hx(e,t){const r=Tr(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function P3(e,t,r){const[n,a]=A3(r==null?void 0:r.in,e,t),s=Hx(n),i=Hx(a),o=+s-Wx(s),c=+i-Wx(i);return Math.round((o-c)/N3)}function O3(e,t){const r=$1(e,t),n=sa(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),hc(n)}function F3(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function D3(e){return!(!F3(e)&&typeof e!="number"||isNaN(+Tr(e)))}function R3(e,t){const r=Tr(e,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function L3(e,t){const r=Tr(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const M3={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},I3=(e,t,r)=>{let n;const a=M3[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Os(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const B3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},U3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},$3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},z3={date:Os({formats:B3,defaultWidth:"full"}),time:Os({formats:U3,defaultWidth:"full"}),dateTime:Os({formats:$3,defaultWidth:"full"})},W3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},H3=(e,t,r,n)=>W3[e];function rn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;a=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const V3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},G3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},q3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},K3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},X3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Y3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},J3=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Q3={ordinalNumber:J3,era:rn({values:V3,defaultWidth:"wide"}),quarter:rn({values:G3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:rn({values:q3,defaultWidth:"wide"}),day:rn({values:K3,defaultWidth:"wide"}),dayPeriod:rn({values:X3,defaultWidth:"wide",formattingValues:Y3,defaultFormattingWidth:"wide"})};function nn(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?ek(o,f=>f.test(i)):Z3(o,f=>f.test(i));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(i.length);return{value:u,rest:d}}}function Z3(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function ek(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function z1(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(a.length);return{value:i,rest:o}}}const tk=/^(\d+)(th|st|nd|rd)?/i,rk=/\d+/i,nk={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ak={any:[/^b/i,/^(a|c)/i]},sk={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ik={any:[/1/i,/2/i,/3/i,/4/i]},lk={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ok={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ck={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},uk={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},dk={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},fk={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},hk={ordinalNumber:z1({matchPattern:tk,parsePattern:rk,valueCallback:e=>parseInt(e,10)}),era:nn({matchPatterns:nk,defaultMatchWidth:"wide",parsePatterns:ak,defaultParseWidth:"any"}),quarter:nn({matchPatterns:sk,defaultMatchWidth:"wide",parsePatterns:ik,defaultParseWidth:"any",valueCallback:e=>e+1}),month:nn({matchPatterns:lk,defaultMatchWidth:"wide",parsePatterns:ok,defaultParseWidth:"any"}),day:nn({matchPatterns:ck,defaultMatchWidth:"wide",parsePatterns:uk,defaultParseWidth:"any"}),dayPeriod:nn({matchPatterns:dk,defaultMatchWidth:"any",parsePatterns:fk,defaultParseWidth:"any"})},xk={code:"en-US",formatDistance:I3,formatLong:z3,formatRelative:H3,localize:Q3,match:hk,options:{weekStartsOn:0,firstWeekContainsDate:1}};function mk(e,t){const r=Tr(e,t==null?void 0:t.in);return P3(r,L3(r))+1}function pk(e,t){const r=Tr(e,t==null?void 0:t.in),n=+hc(r)-+O3(r);return Math.round(n/U1)+1}function W1(e,t){var d,f,h,m;const r=Tr(e,t==null?void 0:t.in),n=r.getFullYear(),a=Qc(),s=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(h=a.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,i=sa((t==null?void 0:t.in)||e,0);i.setFullYear(n+1,0,s),i.setHours(0,0,0,0);const o=ml(i,t),c=sa((t==null?void 0:t.in)||e,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=ml(c,t);return+r>=+o?n+1:+r>=+u?n:n-1}function gk(e,t){var o,c,u,d;const r=Qc(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=W1(e,t),s=sa((t==null?void 0:t.in)||e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),ml(s,t)}function vk(e,t){const r=Tr(e,t==null?void 0:t.in),n=+ml(r,t)-+gk(r,t);return Math.round(n/U1)+1}function Le(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Mn={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Le(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Le(r+1,2)},d(e,t){return Le(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Le(e.getHours()%12||12,t.length)},H(e,t){return Le(e.getHours(),t.length)},m(e,t){return Le(e.getMinutes(),t.length)},s(e,t){return Le(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Le(a,t.length)}},rs={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vx={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Mn.y(e,t)},Y:function(e,t,r,n){const a=W1(e,n),s=a>0?a:1-a;if(t==="YY"){const i=s%100;return Le(i,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Le(s,t.length)},R:function(e,t){const r=$1(e);return Le(r,t.length)},u:function(e,t){const r=e.getFullYear();return Le(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Le(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Le(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Mn.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Le(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=vk(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Le(a,t.length)},I:function(e,t,r){const n=pk(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Le(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Mn.d(e,t)},D:function(e,t,r){const n=mk(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Le(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Le(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Le(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Le(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=rs.noon:n===0?a=rs.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=rs.evening:n>=12?a=rs.afternoon:n>=4?a=rs.morning:a=rs.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Mn.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Mn.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Mn.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Mn.s(e,t)},S:function(e,t){return Mn.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return qx(n);case"XXXX":case"XX":return ba(n);case"XXXXX":case"XXX":default:return ba(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return qx(n);case"xxxx":case"xx":return ba(n);case"xxxxx":case"xxx":default:return ba(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Gx(n,":");case"OOOO":default:return"GMT"+ba(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Gx(n,":");case"zzzz":default:return"GMT"+ba(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Le(n,t.length)},T:function(e,t,r){return Le(+e,t.length)}};function Gx(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+t+Le(s,2)}function qx(e,t){return e%60===0?(e>0?"-":"+")+Le(Math.abs(e)/60,2):ba(e,t)}function ba(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Le(Math.trunc(n/60),2),s=Le(n%60,2);return r+a+t+s}const Kx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},H1=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},yk=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Kx(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Kx(n,t)).replace("{{time}}",H1(a,t))},wk={p:H1,P:yk},_k=/^D+$/,bk=/^Y+$/,Sk=["D","DD","YY","YYYY"];function kk(e){return _k.test(e)}function jk(e){return bk.test(e)}function Ek(e,t,r){const n=Tk(e,t,r);if(console.warn(n),Sk.includes(e))throw new RangeError(n)}function Tk(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Nk=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ck=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ak=/^'([^]*?)'?$/,Pk=/''/g,Ok=/[a-zA-Z]/;function be(e,t,r){var d,f,h,m,v,x,w,y;const n=Qc(),a=(r==null?void 0:r.locale)??n.locale??xk,s=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((x=(v=r==null?void 0:r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??n.weekStartsOn??((y=(w=n.locale)==null?void 0:w.options)==null?void 0:y.weekStartsOn)??0,o=Tr(e,r==null?void 0:r.in);if(!D3(o))throw new RangeError("Invalid time value");let c=t.match(Ck).map(p=>{const g=p[0];if(g==="p"||g==="P"){const b=wk[g];return b(p,a.formatLong)}return p}).join("").match(Nk).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const g=p[0];if(g==="'")return{isToken:!1,value:Fk(p)};if(Vx[g])return{isToken:!0,value:p};if(g.match(Ok))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const u={firstWeekContainsDate:s,weekStartsOn:i,locale:a};return c.map(p=>{if(!p.isToken)return p.value;const g=p.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&jk(g)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&kk(g))&&Ek(g,t,String(e));const b=Vx[g[0]];return b(o,g,a.localize,u)}).join("")}function Fk(e){const t=e.match(Ak);return t?t[1].replace(Pk,"'"):e}const Dk={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},Rk=(e,t,r)=>{let n;const a=Dk[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dalam waktu "+n:n+" yang lalu":n},Lk={full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},Mk={full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},Ik={full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Bk={date:Os({formats:Lk,defaultWidth:"full"}),time:Os({formats:Mk,defaultWidth:"full"}),dateTime:Os({formats:Ik,defaultWidth:"full"})},Uk={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},$k=(e,t,r,n)=>Uk[e],zk={narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},Wk={narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},Hk={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},Vk={narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},Gk={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},qk={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},Kk=(e,t)=>"ke-"+Number(e),Xk={ordinalNumber:Kk,era:rn({values:zk,defaultWidth:"wide"}),quarter:rn({values:Wk,defaultWidth:"wide",argumentCallback:e=>e-1}),month:rn({values:Hk,defaultWidth:"wide"}),day:rn({values:Vk,defaultWidth:"wide"}),dayPeriod:rn({values:Gk,defaultWidth:"wide",formattingValues:qk,defaultFormattingWidth:"wide"})},Yk=/^ke-(\d+)?/i,Jk=/\d+/i,Qk={narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},Zk={any:[/^s/i,/^(m|e)/i]},ej={narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},tj={any:[/1/i,/2/i,/3/i,/4/i]},rj={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},nj={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},aj={narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},sj={narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},ij={narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},lj={any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},oj={ordinalNumber:z1({matchPattern:Yk,parsePattern:Jk,valueCallback:e=>parseInt(e,10)}),era:nn({matchPatterns:Qk,defaultMatchWidth:"wide",parsePatterns:Zk,defaultParseWidth:"any"}),quarter:nn({matchPatterns:ej,defaultMatchWidth:"wide",parsePatterns:tj,defaultParseWidth:"any",valueCallback:e=>e+1}),month:nn({matchPatterns:rj,defaultMatchWidth:"wide",parsePatterns:nj,defaultParseWidth:"any"}),day:nn({matchPatterns:aj,defaultMatchWidth:"wide",parsePatterns:sj,defaultParseWidth:"any"}),dayPeriod:nn({matchPatterns:ij,defaultMatchWidth:"any",parsePatterns:lj,defaultParseWidth:"any"})},nt={code:"id",formatDistance:Rk,formatLong:Bk,formatRelative:$k,localize:Xk,match:oj,options:{weekStartsOn:1,firstWeekContainsDate:1}};function cj(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState({totalStudents:0,totalTasks:0,totalMaterials:0,totalClasses:0,attendanceToday:0}),[o,c]=T.useState(!0);T.useEffect(()=>{e&&(u(),d())},[e]);async function u(){try{const m=be(new Date,"EEEE",{locale:nt}),v=be(new Date,"yyyy-MM-dd"),{data:x}=await Y.from("schedules").select(`
          id,
          hari,
          jam_mulai,
          jam_selesai,
          subject:subjects(nama_mapel),
          class:classes(nama_kelas)
        `).eq("guru_id",e==null?void 0:e.id).eq("hari",m);r(x||[]);const{data:w}=await Y.from("teacher_attendance").select("id, schedule_id, status, jam_masuk, jam_pulang").eq("guru_id",e==null?void 0:e.id).eq("tanggal",v);a(Array.isArray(w)?w:[])}catch(m){console.error("Error fetching today data:",m)}}async function d(){try{const{data:m}=await Y.from("schedules").select("kelas_id").eq("guru_id",e==null?void 0:e.id),v=[...new Set((m==null?void 0:m.map(b=>b.kelas_id))||[])];let x=0;if(v.length>0){const{count:b}=await Y.from("students_classes").select("siswa_id",{count:"exact",head:!0}).in("kelas_id",v).eq("status","aktif");x=b||0}const{count:w}=await Y.from("tasks").select("id",{count:"exact",head:!0}).eq("guru_id",e==null?void 0:e.id),{count:y}=await Y.from("materials").select("id",{count:"exact",head:!0}).eq("guru_id",e==null?void 0:e.id),p=be(new Date,"yyyy-MM-dd"),{count:g}=await Y.from("teacher_attendance").select("id",{count:"exact",head:!0}).eq("guru_id",e==null?void 0:e.id).eq("tanggal",p).not("jam_masuk","is",null);i({totalStudents:x,totalTasks:w||0,totalMaterials:y||0,totalClasses:v.length,attendanceToday:g||0})}catch(m){console.error("Error fetching teacher stats:",m)}finally{c(!1)}}async function f(m,v){try{const x=be(new Date,"yyyy-MM-dd"),w=be(new Date,"HH:mm:ss"),y=n.find(p=>p.schedule_id===m);if(y){const p=v==="masuk"?{jam_masuk:w}:{jam_pulang:w},{error:g}=await Y.from("teacher_attendance").update(p).eq("id",y.id);if(g)throw g}else{const{error:p}=await Y.from("teacher_attendance").insert({guru_id:e==null?void 0:e.id,schedule_id:m,tanggal:x,[v==="masuk"?"jam_masuk":"jam_pulang"]:w,status:"hadir"});if(p)throw p}u()}catch(x){console.error("Error marking attendance:",x)}}const h=m=>n.find(v=>v.schedule_id===m);return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Guru"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Selamat datang, ",e==null?void 0:e.nama]})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:l.jsxs("div",{className:"lg:col-span-3 bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Jadwal Hari Ini"}),t.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"Tidak ada jadwal hari ini"}):l.jsx("div",{className:"space-y-3",children:t.map(m=>l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 bg-gray-50 rounded-lg gap-3",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[l.jsx(jr,{className:"text-blue-500",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-sm sm:text-base",children:m.subject.nama_mapel}),l.jsx("p",{className:"text-sm text-gray-600",children:m.class.nama_kelas}),l.jsxs("p",{className:"text-xs text-gray-500",children:[m.jam_mulai," - ",m.jam_selesai]})]})]}),l.jsx("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:(()=>{const v=h(m.id);return v!=null&&v.jam_masuk?v!=null&&v.jam_pulang?l.jsxs("div",{className:"text-xs text-gray-600 text-right",children:[l.jsxs("div",{children:["Mulai: ",v.jam_masuk]}),l.jsxs("div",{children:["Selesai: ",v.jam_pulang]})]}):l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-2 w-full sm:w-auto",children:[l.jsxs("span",{className:"text-xs text-green-600 font-medium whitespace-nowrap",children:["Mulai: ",v.jam_masuk]}),l.jsxs("button",{onClick:()=>f(m.id,"pulang"),className:"bg-red-500 text-white py-2 px-3 rounded text-sm hover:bg-red-600 transition-colors flex items-center space-x-1 flex-1 sm:flex-none justify-center",children:[l.jsx(xl,{size:14}),l.jsx("span",{children:"Selesai"})]})]}):l.jsxs("button",{onClick:()=>f(m.id,"masuk"),className:"bg-green-500 text-white py-2 px-3 rounded text-sm hover:bg-green-600 transition-colors flex items-center space-x-1 flex-1 sm:flex-none justify-center",children:[l.jsx(Gs,{size:14}),l.jsx("span",{children:"Mulai KBM"})]})})()})]},m.id))})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Menu Cepat"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{className:"flex flex-col items-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[l.jsx(cn,{className:"text-blue-600 mb-2",size:24}),l.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Absensi Siswa"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[l.jsx(ln,{className:"text-green-600 mb-2",size:24}),l.jsx("span",{className:"text-sm font-medium text-green-900",children:"Buat Tugas"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[l.jsx(Gt,{className:"text-purple-600 mb-2",size:24}),l.jsx("span",{className:"text-sm font-medium text-purple-900",children:"Jurnal"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[l.jsx(Gs,{className:"text-orange-600 mb-2",size:24}),l.jsx("span",{className:"text-sm font-medium text-orange-900",children:"Nilai Tugas"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistik"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-600",children:"Absen Hari Ini"}),l.jsxs("span",{className:"font-bold text-2xl text-green-600",children:[s.attendanceToday,"/",t.length]})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-600",children:"Kelas Diajar"}),l.jsx("span",{className:"font-bold text-2xl text-blue-600",children:s.totalClasses})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-600",children:"Total Siswa"}),l.jsx("span",{className:"font-bold text-2xl text-purple-600",children:s.totalStudents})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-600",children:"Total Tugas"}),l.jsx("span",{className:"font-bold text-2xl text-orange-600",children:s.totalTasks})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-600",children:"Total Materi"}),l.jsx("span",{className:"font-bold text-2xl text-indigo-600",children:s.totalMaterials})]})]})]})]})]})}function uj(){var d;const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState(null),[s,i]=T.useState({totalTasks:0,completedTasks:0,points:0,attendancePercentage:0}),[o,c]=T.useState(!0);T.useEffect(()=>{e&&u()},[e]);async function u(){var f,h,m;try{const{data:v}=await Y.from("students_classes").select(`
          id,
          kelas:classes(
            id,
            nama_kelas,
            tingkat,
            major:majors(nama_jurusan)
          )
        `).eq("siswa_id",e==null?void 0:e.id).eq("status","aktif").maybeSingle();if(a(v),v){const x=be(new Date,"EEEE",{locale:nt}),{data:w}=await Y.from("schedules").select(`
            id,
            hari,
            jam_mulai,
            jam_selesai,
            subject:subjects(nama_mapel),
            guru:users(nama)
          `).eq("kelas_id",v.kelas.id).eq("hari",x);r(w||[]);const[y,p,g,b]=await Promise.all([Y.from("tasks").select("id",{count:"exact",head:!0}).eq("kelas_id",v.kelas.id),Y.from("task_submissions").select("id",{count:"exact",head:!0}).eq("siswa_id",e==null?void 0:e.id),Y.from("points").select("poin").eq("siswa_id",e==null?void 0:e.id),Y.from("attendance").select("status").eq("siswa_id",e==null?void 0:e.id)]),j=((f=g.data)==null?void 0:f.reduce((_,N)=>_+N.poin,0))||0,A=((h=b.data)==null?void 0:h.length)||0,k=((m=b.data)==null?void 0:m.filter(_=>_.status==="hadir").length)||0,D=A>0?Math.round(k/A*100):0;i({totalTasks:y.count||0,completedTasks:p.count||0,points:j,attendancePercentage:D})}}catch(v){console.error("Error fetching student data:",v)}finally{c(!1)}}return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Siswa"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Selamat datang, ",e==null?void 0:e.nama]}),n&&l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Kelas ",n.kelas.tingkat," ",n.kelas.nama_kelas," - ",(d=n.kelas.major)==null?void 0:d.nama_jurusan]})]}),l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8",children:[l.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Tugas Selesai"}),l.jsxs("p",{className:"text-xl sm:text-3xl font-bold text-green-600",children:[s.completedTasks,"/",s.totalTasks]})]}),l.jsx("div",{className:"bg-green-100 rounded-full p-2 sm:p-3",children:l.jsx(ln,{size:20,className:"text-green-600 sm:w-6 sm:h-6"})})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Kehadiran"}),l.jsxs("p",{className:"text-xl sm:text-3xl font-bold text-blue-600",children:[s.attendancePercentage,"%"]})]}),l.jsx("div",{className:"bg-blue-100 rounded-full p-2 sm:p-3",children:l.jsx(on,{size:20,className:"text-blue-600 sm:w-6 sm:h-6"})})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Poin"}),l.jsx("p",{className:"text-xl sm:text-3xl font-bold text-purple-600",children:s.points})]}),l.jsx("div",{className:"bg-purple-100 rounded-full p-2 sm:p-3",children:l.jsx(Vs,{size:20,className:"text-purple-600 sm:w-6 sm:h-6"})})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Jadwal Hari Ini"}),l.jsx("p",{className:"text-xl sm:text-3xl font-bold text-orange-600",children:t.length})]}),l.jsx("div",{className:"bg-orange-100 rounded-full p-2 sm:p-3",children:l.jsx(Gt,{size:20,className:"text-orange-600 sm:w-6 sm:h-6"})})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Jadwal Hari Ini"}),t.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"Tidak ada jadwal hari ini"}):l.jsx("div",{className:"space-y-3",children:t.map(f=>l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 bg-gray-50 rounded-lg gap-2 sm:gap-0",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(zr,{className:"text-blue-500",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-sm sm:text-base",children:f.subject.nama_mapel}),l.jsx("p",{className:"text-sm text-gray-600",children:f.guru.nama})]})]}),l.jsx("div",{className:"text-left sm:text-right ml-8 sm:ml-0",children:l.jsxs("p",{className:"font-medium text-sm sm:text-base",children:[f.jam_mulai," - ",f.jam_selesai]})})]},f.id))})]}),l.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Menu Cepat"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{className:"flex flex-col items-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[l.jsx(jr,{className:"text-blue-600 mb-2",size:20}),l.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Materi"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[l.jsx(ln,{className:"text-green-600 mb-2",size:20}),l.jsx("span",{className:"text-sm font-medium text-green-900",children:"Tugas"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[l.jsx(on,{className:"text-purple-600 mb-2",size:20}),l.jsx("span",{className:"text-sm font-medium text-purple-900",children:"Nilai"})]}),l.jsxs("button",{className:"flex flex-col items-center p-4 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[l.jsx(Vs,{className:"text-orange-600 mb-2",size:20}),l.jsx("span",{className:"text-sm font-medium text-orange-900",children:"Poin"})]})]})]})]})]})}function dj(){const{profile:e}=_t();if(!e)return null;switch(e.role){case"admin":return l.jsx(T3,{});case"guru":return l.jsx(cj,{});case"siswa":return l.jsx(uj,{});default:return l.jsx("div",{children:"Role tidak dikenali"})}}function fj(){const[e,t]=T.useState([]),[r,n]=T.useState(!0),[a,s]=T.useState(""),[i,o]=T.useState(!1),[c,u]=T.useState(null),[d,f]=T.useState({nama:"",email:"",password:""});T.useEffect(()=>{h()},[]);async function h(){try{const{data:w,error:y}=await Y.from("users").select("*").eq("role","guru").order("created_at",{ascending:!1});if(y)throw y;t(w||[])}catch(w){console.error("Error fetching teachers:",w)}finally{n(!1)}}async function m(w){w.preventDefault();try{if(c){const y={nama:d.nama,email:d.email,updated_at:new Date().toISOString()};d.password&&(y.password=d.password);const{error:p}=await Y.from("users").update(y).eq("id",c.id);if(p)throw p}else{const{error:y}=await Y.from("users").insert({nama:d.nama,email:d.email,password:d.password,role:"guru",auth_id:null});if(y)throw y}o(!1),u(null),f({nama:"",email:"",password:""}),h()}catch(y){console.error("Error saving teacher:",y),alert("Error: "+(y.message||"Gagal menyimpan data guru"))}}async function v(w){if(confirm(`Hapus guru ${w.nama}?`))try{const{error:y}=await Y.from("users").delete().eq("id",w.id);if(y)throw y;h()}catch(y){alert("Error: "+y.message)}}const x=e.filter(w=>w.nama.toLowerCase().includes(a.toLowerCase())||w.email.toLowerCase().includes(a.toLowerCase()));return r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kelola Guru"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen data guru dan akun"})]}),l.jsxs("button",{onClick:()=>{u(null),f({nama:"",email:"",password:""}),o(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Guru"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari guru...",value:a,onChange:w=>s(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full max-w-md"})]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Dibuat"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(w=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium",children:w.nama.charAt(0).toUpperCase()})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.nama})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.email}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(w.created_at).toLocaleDateString("id-ID")}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>{u(w),f({nama:w.nama,email:w.email,password:""}),o(!0)},className:"text-blue-600 hover:text-blue-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>v(w),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})})]},w.id))})]})}),x.length===0&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"Tidak ada data guru"})})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:c?"Edit Guru":"Tambah Guru Baru"}),l.jsxs("form",{onSubmit:m,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),l.jsx("input",{type:"text",value:d.nama,onChange:w=>f({...d,nama:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",value:d.email,onChange:w=>f({...d,email:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),!c&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"password",value:d.password,onChange:w=>f({...d,password:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),c&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru (Kosongkan jika tidak ingin mengubah)"}),l.jsx("input",{type:"password",value:d.password,onChange:w=>f({...d,password:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",minLength:6})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:c?"Update":"Simpan"})]})]})]})})]})}function hj(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,s]=T.useState(!0),[i,o]=T.useState(""),[c,u]=T.useState(!1),[d,f]=T.useState(null),[h,m]=T.useState({nama:"",email:"",password:"",kelas_id:""});T.useEffect(()=>{v()},[]);async function v(){try{const[p,g]=await Promise.all([Y.from("users").select("*").eq("role","siswa").order("created_at",{ascending:!1}),Y.from("classes").select(`
            id,
            nama_kelas,
            tingkat,
            major:majors(nama_jurusan)
          `).order("tingkat",{ascending:!0})]);if(p.error)throw p.error;if(g.error)throw g.error;t(p.data||[]),n(g.data||[])}catch(p){console.error("Error fetching data:",p)}finally{s(!1)}}async function x(p){p.preventDefault();try{if(d){const g={nama:h.nama,email:h.email,updated_at:new Date().toISOString()};h.password&&(g.password=h.password);const{error:b}=await Y.from("users").update(g).eq("id",d.id);if(b)throw b}else{const{data:g,error:b}=await Y.from("users").insert({nama:h.nama,email:h.email,password:h.password,role:"siswa",auth_id:null}).select().single();if(b)throw b;if(h.kelas_id&&g){const j=new Date().getFullYear(),{error:A}=await Y.from("students_classes").insert({siswa_id:g.id,kelas_id:h.kelas_id,tahun_ajaran:`${j}/${j+1}`,status:"aktif"});A&&console.error("Error assigning to class:",A)}}u(!1),f(null),m({nama:"",email:"",password:"",kelas_id:""}),v()}catch(g){console.error("Error saving student:",g),alert("Error: "+(g.message||"Gagal menyimpan data siswa"))}}async function w(p){if(confirm(`Hapus siswa ${p.nama}?`))try{const{error:g}=await Y.from("users").delete().eq("id",p.id);if(g)throw g;v()}catch(g){alert("Error: "+g.message)}}const y=e.filter(p=>p.nama.toLowerCase().includes(i.toLowerCase())||p.email.toLowerCase().includes(i.toLowerCase()));return a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kelola Siswa"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen data siswa dan penempatan kelas"})]}),l.jsxs("button",{onClick:()=>{f(null),m({nama:"",email:"",password:"",kelas_id:""}),u(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Siswa"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari siswa...",value:i,onChange:p=>o(p.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 w-full max-w-md"})]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Dibuat"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(p=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-green-600 font-medium",children:p.nama.charAt(0).toUpperCase()})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.nama})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.email}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString("id-ID")}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>{f(p),m({nama:p.nama,email:p.email,password:"",kelas_id:""}),u(!0)},className:"text-green-600 hover:text-green-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>w(p),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})})]},p.id))})]})}),y.length===0&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"Tidak ada data siswa"})})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:d?"Edit Siswa":"Tambah Siswa Baru"}),l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),l.jsx("input",{type:"text",value:h.nama,onChange:p=>m({...h,nama:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",value:h.email,onChange:p=>m({...h,email:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),!d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"password",value:h.password,onChange:p=>m({...h,password:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0,minLength:6})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kelas (Opsional)"}),l.jsxs("select",{value:h.kelas_id,onChange:p=>m({...h,kelas_id:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[l.jsx("option",{value:"",children:"Pilih Kelas"}),r.map(p=>{var g;return l.jsxs("option",{value:p.id,children:[p.tingkat," ",p.nama_kelas," - ",(g=p.major)==null?void 0:g.nama_jurusan]},p.id)})]})]})]}),d&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru (Kosongkan jika tidak ingin mengubah)"}),l.jsx("input",{type:"password",value:h.password,onChange:p=>m({...h,password:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",minLength:6})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:d?"Update":"Simpan"})]})]})]})})]})}function xj(){const[e,t]=T.useState([]),[r,n]=T.useState(!0),[a,s]=T.useState(""),[i,o]=T.useState(!1),[c,u]=T.useState(null),[d,f]=T.useState({kode_jurusan:"",nama_jurusan:""});T.useEffect(()=>{h()},[]);async function h(){try{const{data:w,error:y}=await Y.from("majors").select("*").order("kode_jurusan",{ascending:!0});if(y)throw y;t(w||[])}catch(w){console.error("Error fetching majors:",w)}finally{n(!1)}}async function m(w){w.preventDefault();try{if(c){const{error:y}=await Y.from("majors").update({kode_jurusan:d.kode_jurusan.toUpperCase(),nama_jurusan:d.nama_jurusan}).eq("id",c.id);if(y)throw y}else{const{error:y}=await Y.from("majors").insert({kode_jurusan:d.kode_jurusan.toUpperCase(),nama_jurusan:d.nama_jurusan});if(y)throw y}o(!1),u(null),f({kode_jurusan:"",nama_jurusan:""}),h()}catch(y){alert("Error: "+y.message)}}async function v(w){if(confirm(`Hapus jurusan ${w.nama_jurusan}?`))try{const{error:y}=await Y.from("majors").delete().eq("id",w.id);if(y)throw y;h()}catch(y){alert("Error: "+y.message)}}const x=e.filter(w=>w.nama_jurusan.toLowerCase().includes(a.toLowerCase())||w.kode_jurusan.toLowerCase().includes(a.toLowerCase()));return r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kelola Jurusan"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen data jurusan dan program keahlian"})]}),l.jsxs("button",{onClick:()=>{u(null),f({kode_jurusan:"",nama_jurusan:""}),o(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Jurusan"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari jurusan...",value:a,onChange:w=>s(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:x.map(w=>l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(qs,{className:"text-purple-600",size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:w.kode_jurusan}),l.jsx("p",{className:"text-sm text-gray-600",children:"Kode Jurusan"})]})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>{u(w),f({kode_jurusan:w.kode_jurusan,nama_jurusan:w.nama_jurusan}),o(!0)},className:"text-purple-600 hover:text-purple-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>v(w),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:w.nama_jurusan}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Dibuat: ",new Date(w.created_at).toLocaleDateString("id-ID")]})]})]},w.id))}),x.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(qs,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data jurusan"})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:c?"Edit Jurusan":"Tambah Jurusan Baru"}),l.jsxs("form",{onSubmit:m,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Jurusan"}),l.jsx("input",{type:"text",value:d.kode_jurusan,onChange:w=>f({...d,kode_jurusan:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 uppercase",placeholder:"Contoh: TJKT",required:!0,maxLength:10})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Jurusan"}),l.jsx("input",{type:"text",value:d.nama_jurusan,onChange:w=>f({...d,nama_jurusan:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Contoh: Teknik Jaringan Komputer dan Telekomunikasi",required:!0})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:c?"Update":"Simpan"})]})]})]})})]})}function mj(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,s]=T.useState([]),[i,o]=T.useState(!0),[c,u]=T.useState(""),[d,f]=T.useState(!1),[h,m]=T.useState(null),[v,x]=T.useState({tingkat:1,nama_kelas:"",major_id:"",wali_kelas:""});T.useEffect(()=>{w()},[]);async function w(){try{const[b,j,A]=await Promise.all([Y.from("classes").select(`
            *,
            major:majors(nama_jurusan, kode_jurusan),
            wali:users!classes_wali_kelas_fkey(nama)
          `).order("tingkat",{ascending:!0}),Y.from("majors").select("*").order("kode_jurusan",{ascending:!0}),Y.from("users").select("id, nama").eq("role","guru").order("nama",{ascending:!0})]);if(b.error)throw b.error;if(j.error)throw j.error;if(A.error)throw A.error;t(b.data||[]),n(j.data||[]),s(A.data||[])}catch(b){console.error("Error fetching data:",b)}finally{o(!1)}}async function y(b){b.preventDefault();try{const j={tingkat:v.tingkat,nama_kelas:v.nama_kelas,major_id:v.major_id,wali_kelas:v.wali_kelas||null};if(h){const{error:A}=await Y.from("classes").update(j).eq("id",h.id);if(A)throw A}else{const{error:A}=await Y.from("classes").insert(j);if(A)throw A}f(!1),m(null),x({tingkat:1,nama_kelas:"",major_id:"",wali_kelas:""}),w()}catch(j){alert("Error: "+j.message)}}async function p(b){if(confirm(`Hapus kelas ${b.tingkat} ${b.nama_kelas}?`))try{const{error:j}=await Y.from("classes").delete().eq("id",b.id);if(j)throw j;w()}catch(j){alert("Error: "+j.message)}}const g=e.filter(b=>{var j,A;return b.nama_kelas.toLowerCase().includes(c.toLowerCase())||((j=b.major)==null?void 0:j.nama_jurusan.toLowerCase().includes(c.toLowerCase()))||((A=b.major)==null?void 0:A.kode_jurusan.toLowerCase().includes(c.toLowerCase()))});return i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kelola Kelas"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen kelas dan wali kelas"})]}),l.jsxs("button",{onClick:()=>{m(null),x({tingkat:1,nama_kelas:"",major_id:"",wali_kelas:""}),f(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Kelas"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari kelas...",value:c,onChange:b=>u(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:g.map(b=>{var j,A,k;return l.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl p-6 border border-indigo-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center",children:l.jsx(hl,{className:"text-indigo-600",size:24})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold text-lg text-gray-900",children:[b.tingkat," ",b.nama_kelas]}),l.jsx("p",{className:"text-sm text-gray-600",children:(j=b.major)==null?void 0:j.kode_jurusan})]})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>{m(b),x({tingkat:b.tingkat,nama_kelas:b.nama_kelas,major_id:b.major_id,wali_kelas:b.wali_kelas||""}),f(!0)},className:"text-indigo-600 hover:text-indigo-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>p(b),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Jurusan:"})," ",(A=b.major)==null?void 0:A.nama_jurusan]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Wali Kelas:"})," ",((k=b.wali)==null?void 0:k.nama)||"Belum ditentukan"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mt-3",children:[l.jsx(cn,{size:14}),l.jsxs("span",{children:["Dibuat: ",new Date(b.created_at).toLocaleDateString("id-ID")]})]})]})]},b.id)})}),g.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(hl,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data kelas"})]})]}),d&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:h?"Edit Kelas":"Tambah Kelas Baru"}),l.jsxs("form",{onSubmit:y,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tingkat"}),l.jsxs("select",{value:v.tingkat,onChange:b=>x({...v,tingkat:parseInt(b.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[l.jsx("option",{value:1,children:"1"}),l.jsx("option",{value:2,children:"2"}),l.jsx("option",{value:3,children:"3"}),l.jsx("option",{value:4,children:"4"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Kelas"}),l.jsx("input",{type:"text",value:v.nama_kelas,onChange:b=>x({...v,nama_kelas:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Contoh: A, B, C",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jurusan"}),l.jsxs("select",{value:v.major_id,onChange:b=>x({...v,major_id:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Jurusan"}),r.map(b=>l.jsxs("option",{value:b.id,children:[b.kode_jurusan," - ",b.nama_jurusan]},b.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wali Kelas (Opsional)"}),l.jsxs("select",{value:v.wali_kelas,onChange:b=>x({...v,wali_kelas:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[l.jsx("option",{value:"",children:"Pilih Wali Kelas"}),a.map(b=>l.jsx("option",{value:b.id,children:b.nama},b.id))]})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>f(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:h?"Update":"Simpan"})]})]})]})})]})}function pj(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,s]=T.useState(!0),[i,o]=T.useState(""),[c,u]=T.useState(!1),[d,f]=T.useState(null),[h,m]=T.useState({nama_mapel:"",guru_id:""});T.useEffect(()=>{v()},[]);async function v(){try{const[p,g]=await Promise.all([Y.from("subjects").select(`
            *,
            guru:users(nama)
          `).order("nama_mapel",{ascending:!0}),Y.from("users").select("id, nama").eq("role","guru").order("nama",{ascending:!0})]);if(p.error)throw p.error;if(g.error)throw g.error;t(p.data||[]),n(g.data||[])}catch(p){console.error("Error fetching data:",p)}finally{s(!1)}}async function x(p){p.preventDefault();try{const g={nama_mapel:h.nama_mapel,guru_id:h.guru_id||null};if(d){const{error:b}=await Y.from("subjects").update(g).eq("id",d.id);if(b)throw b}else{const{error:b}=await Y.from("subjects").insert(g);if(b)throw b}u(!1),f(null),m({nama_mapel:"",guru_id:""}),v()}catch(g){alert("Error: "+g.message)}}async function w(p){if(confirm(`Hapus mata pelajaran ${p.nama_mapel}?`))try{const{error:g}=await Y.from("subjects").delete().eq("id",p.id);if(g)throw g;v()}catch(g){alert("Error: "+g.message)}}const y=e.filter(p=>{var g;return p.nama_mapel.toLowerCase().includes(i.toLowerCase())||((g=p.guru)==null?void 0:g.nama.toLowerCase().includes(i.toLowerCase()))});return a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mata Pelajaran"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen mata pelajaran dan pengampu"})]}),l.jsxs("button",{onClick:()=>{f(null),m({nama_mapel:"",guru_id:""}),u(!0)},className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Mata Pelajaran"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari mata pelajaran...",value:i,onChange:p=>o(p.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:y.map(p=>{var g;return l.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx(jr,{className:"text-orange-600",size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:p.nama_mapel}),l.jsx("p",{className:"text-sm text-gray-600",children:"Mata Pelajaran"})]})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>{f(p),m({nama_mapel:p.nama_mapel,guru_id:p.guru_id||""}),u(!0)},className:"text-orange-600 hover:text-orange-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>w(p),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Tf,{size:16,className:"text-gray-400"}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Pengampu:"})," ",((g=p.guru)==null?void 0:g.nama)||"Belum ditentukan"]})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Dibuat: ",new Date(p.created_at).toLocaleDateString("id-ID")]})]})]},p.id)})}),y.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(jr,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data mata pelajaran"})]})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:d?"Edit Mata Pelajaran":"Tambah Mata Pelajaran Baru"}),l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Mata Pelajaran"}),l.jsx("input",{type:"text",value:h.nama_mapel,onChange:p=>m({...h,nama_mapel:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Contoh: Matematika, Bahasa Indonesia",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guru Pengampu (Opsional)"}),l.jsxs("select",{value:h.guru_id,onChange:p=>m({...h,guru_id:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[l.jsx("option",{value:"",children:"Pilih Guru"}),r.map(p=>l.jsx("option",{value:p.id,children:p.nama},p.id))]})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:d?"Update":"Simpan"})]})]})]})})]})}const xo=["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];function gj(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,s]=T.useState([]),[i,o]=T.useState([]),[c,u]=T.useState(!0),[d,f]=T.useState(""),[h,m]=T.useState(""),[v,x]=T.useState(!1),[w,y]=T.useState(null),[p,g]=T.useState({hari:"Senin",jam_mulai:"",jam_selesai:"",mapel_id:"",guru_id:"",kelas_id:""});T.useEffect(()=>{b()},[]);async function b(){try{const[_,N,B,q]=await Promise.all([Y.from("schedules").select(`
            *,
            subject:subjects(nama_mapel),
            guru:users(nama),
            class:classes(
              tingkat,
              nama_kelas,
              major:majors(kode_jurusan)
            )
          `).order("hari",{ascending:!0}),Y.from("subjects").select("id, nama_mapel").order("nama_mapel",{ascending:!0}),Y.from("users").select("id, nama").eq("role","guru").order("nama",{ascending:!0}),Y.from("classes").select(`
            id,
            tingkat,
            nama_kelas,
            major:majors(kode_jurusan)
          `).order("tingkat",{ascending:!0})]);if(_.error)throw _.error;if(N.error)throw N.error;if(B.error)throw B.error;if(q.error)throw q.error;t(_.data||[]),n(N.data||[]),s(B.data||[]),o(q.data||[])}catch(_){console.error("Error fetching data:",_)}finally{u(!1)}}async function j(_){_.preventDefault();try{if(w){const{error:N}=await Y.from("schedules").update(p).eq("id",w.id);if(N)throw N}else{const{error:N}=await Y.from("schedules").insert(p);if(N)throw N}x(!1),y(null),g({hari:"Senin",jam_mulai:"",jam_selesai:"",mapel_id:"",guru_id:"",kelas_id:""}),b()}catch(N){alert("Error: "+N.message)}}async function A(_){if(confirm(`Hapus jadwal ${_.subject.nama_mapel}?`))try{const{error:N}=await Y.from("schedules").delete().eq("id",_.id);if(N)throw N;b()}catch(N){alert("Error: "+N.message)}}const k=e.filter(_=>{const N=_.subject.nama_mapel.toLowerCase().includes(d.toLowerCase())||_.guru.nama.toLowerCase().includes(d.toLowerCase())||`${_.class.tingkat} ${_.class.nama_kelas}`.toLowerCase().includes(d.toLowerCase()),B=h===""||_.hari===h;return N&&B}),D=xo.reduce((_,N)=>(_[N]=k.filter(B=>B.hari===N),_),{});return c?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Jadwal Pelajaran"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Manajemen jadwal mengajar"})]}),l.jsxs("button",{onClick:()=>{y(null),g({hari:"Senin",jam_mulai:"",jam_selesai:"",mapel_id:"",guru_id:"",kelas_id:""}),x(!0)},className:"bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Jadwal"})]})]}),l.jsx("div",{className:"bg-white rounded-xl border border-gray-200 mb-6",children:l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari jadwal...",value:d,onChange:_=>f(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 w-full"})]}),l.jsxs("select",{value:h,onChange:_=>m(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",children:[l.jsx("option",{value:"",children:"Semua Hari"}),xo.map(_=>l.jsx("option",{value:_,children:_},_))]})]})})}),l.jsx("div",{className:"space-y-6",children:xo.map(_=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"bg-gradient-to-r from-pink-50 to-rose-50 px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Gt,{className:"text-pink-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:_}),l.jsxs("span",{className:"bg-pink-100 text-pink-800 px-2 py-1 rounded-full text-sm",children:[D[_].length," jadwal"]})]})}),D[_].length===0?l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx(zr,{className:"mx-auto mb-2",size:32}),l.jsx("p",{children:"Tidak ada jadwal"})]}):l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D[_].map(N=>l.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-rose-50 rounded-lg p-4 border border-pink-100 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(zr,{className:"text-pink-600",size:16}),l.jsxs("span",{className:"font-semibold text-pink-800",children:[N.jam_mulai," - ",N.jam_selesai]})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>{y(N),g({hari:N.hari,jam_mulai:N.jam_mulai,jam_selesai:N.jam_selesai,mapel_id:N.mapel_id,guru_id:N.guru_id,kelas_id:N.kelas_id}),x(!0)},className:"text-pink-600 hover:text-pink-900 p-1",children:l.jsx(Kr,{size:14})}),l.jsx("button",{onClick:()=>A(N),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:14})})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("h4",{className:"font-bold text-gray-900",children:N.subject.nama_mapel}),l.jsxs("p",{className:"text-sm text-gray-600",children:[N.class.tingkat," ",N.class.nama_kelas," - ",N.class.major.kode_jurusan]}),l.jsx("p",{className:"text-sm text-gray-600",children:N.guru.nama})]})]},N.id))})})]},_))}),v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:w?"Edit Jadwal":"Tambah Jadwal Baru"}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hari"}),l.jsx("select",{value:p.hari,onChange:_=>g({...p,hari:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0,children:xo.map(_=>l.jsx("option",{value:_,children:_},_))})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Mulai"}),l.jsx("input",{type:"time",value:p.jam_mulai,onChange:_=>g({...p,jam_mulai:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Selesai"}),l.jsx("input",{type:"time",value:p.jam_selesai,onChange:_=>g({...p,jam_selesai:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mata Pelajaran"}),l.jsxs("select",{value:p.mapel_id,onChange:_=>g({...p,mapel_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Mata Pelajaran"}),r.map(_=>l.jsx("option",{value:_.id,children:_.nama_mapel},_.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guru"}),l.jsxs("select",{value:p.guru_id,onChange:_=>g({...p,guru_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Guru"}),a.map(_=>l.jsx("option",{value:_.id,children:_.nama},_.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kelas"}),l.jsxs("select",{value:p.kelas_id,onChange:_=>g({...p,kelas_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Kelas"}),i.map(_=>l.jsxs("option",{value:_.id,children:[_.tingkat," ",_.nama_kelas," - ",_.major.kode_jurusan]},_.id))]})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors",children:w?"Update":"Simpan"})]})]})]})})]})}function vj(){const[e,t]=T.useState([]),[r,n]=T.useState(!0),[a,s]=T.useState(""),[i,o]=T.useState(!1),[c,u]=T.useState(null),[d,f]=T.useState({name:"",latitude:"",longitude:"",radius:"100",is_active:!0});T.useEffect(()=>{h()},[]);async function h(){try{const{data:y,error:p}=await Y.from("location_settings").select("*").order("created_at",{ascending:!1});if(p)throw p;t(y||[])}catch(y){console.error("Error fetching locations:",y)}finally{n(!1)}}async function m(y){y.preventDefault();try{const p={name:d.name,latitude:parseFloat(d.latitude),longitude:parseFloat(d.longitude),radius:parseInt(d.radius),is_active:d.is_active};if(c){const{error:g}=await Y.from("location_settings").update(p).eq("id",c.id);if(g)throw g}else{const{error:g}=await Y.from("location_settings").insert(p);if(g)throw g}o(!1),u(null),f({name:"",latitude:"",longitude:"",radius:"100",is_active:!0}),h()}catch(p){alert("Error: "+p.message)}}async function v(y){if(confirm(`Hapus lokasi "${y.name}"?`))try{const{error:p}=await Y.from("location_settings").delete().eq("id",y.id);if(p)throw p;h()}catch(p){alert("Error: "+p.message)}}function x(){navigator.geolocation?navigator.geolocation.getCurrentPosition(y=>{f({...d,latitude:y.coords.latitude.toString(),longitude:y.coords.longitude.toString()})},y=>{alert("Error getting location: "+y.message)}):alert("Geolocation is not supported by this browser.")}const w=e.filter(y=>y.name.toLowerCase().includes(a.toLowerCase()));return r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pengaturan Lokasi Absensi"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola lokasi dan radius untuk absensi guru"})]}),l.jsxs("button",{onClick:()=>{u(null),f({name:"",latitude:"",longitude:"",radius:"100",is_active:!0}),o(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Lokasi"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari lokasi...",value:a,onChange:y=>s(y.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:w.map(y=>l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Ks,{className:"text-blue-600",size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:y.name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Radius: ",y.radius,"m"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.is_active?"Aktif":"Nonaktif"}),l.jsx("button",{onClick:()=>{u(y),f({name:y.name,latitude:y.latitude.toString(),longitude:y.longitude.toString(),radius:y.radius.toString(),is_active:y.is_active}),o(!0)},className:"text-blue-600 hover:text-blue-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>v(y),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Latitude:"})," ",y.latitude]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Longitude:"})," ",y.longitude]}),l.jsxs("a",{href:`https://maps.google.com/?q=${y.latitude},${y.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-600 hover:text-blue-800 text-sm",children:[l.jsx(Ux,{size:14}),l.jsx("span",{children:"Lihat di Maps"})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Dibuat: ",new Date(y.created_at).toLocaleDateString("id-ID")]})]})]},y.id))}),w.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ks,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data lokasi"})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:c?"Edit Lokasi":"Tambah Lokasi Baru"}),l.jsxs("form",{onSubmit:m,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lokasi"}),l.jsx("input",{type:"text",value:d.name,onChange:y=>f({...d,name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Contoh: Sekolah Utama",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),l.jsx("input",{type:"number",step:"any",value:d.latitude,onChange:y=>f({...d,latitude:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"-6.2088",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),l.jsx("input",{type:"number",step:"any",value:d.longitude,onChange:y=>f({...d,longitude:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"106.8456",required:!0})]})]}),l.jsx("div",{children:l.jsxs("button",{type:"button",onClick:x,className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2 mb-3",children:[l.jsx(Ux,{size:16}),l.jsx("span",{children:"Gunakan Lokasi Saat Ini"})]})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Radius (meter)"}),l.jsx("input",{type:"number",value:d.radius,onChange:y=>f({...d,radius:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"10",max:"1000",required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Radius dalam meter (10-1000m)"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:d.is_active,onChange:y=>f({...d,is_active:y.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Lokasi Aktif"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:c?"Update":"Simpan"})]})]})]})})]})}function yj(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState([]),[o,c]=T.useState(null),[u,d]=T.useState(""),[f,h]=T.useState(be(new Date,"yyyy-MM-dd")),[m,v]=T.useState(!0),[x,w]=T.useState(new Date);T.useEffect(()=>{e&&(j(),A(),y(),p());const _=setInterval(()=>{w(new Date)},1e3);return()=>clearInterval(_)},[e,f]);async function y(){try{const{data:_,error:N}=await Y.from("location_settings").select("*").eq("is_active",!0);if(N)throw N;i(_||[])}catch(_){console.error("Error fetching location settings:",_)}}function p(){navigator.geolocation?navigator.geolocation.getCurrentPosition(_=>{c({latitude:_.coords.latitude,longitude:_.coords.longitude}),d("")},_=>{d("Tidak dapat mengakses lokasi: "+_.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}):d("Browser tidak mendukung geolocation")}function g(_,N,B,q){const _e=_*Math.PI/180,ce=B*Math.PI/180,we=(B-_)*Math.PI/180,pe=(q-N)*Math.PI/180,Q=Math.sin(we/2)*Math.sin(we/2)+Math.cos(_e)*Math.cos(ce)*Math.sin(pe/2)*Math.sin(pe/2);return 6371e3*(2*Math.atan2(Math.sqrt(Q),Math.sqrt(1-Q)))}function b(){if(!o||s.length===0)return{allowed:!1};for(const N of s){const B=g(o.latitude,o.longitude,N.latitude,N.longitude);if(B<=N.radius)return{allowed:!0,nearestLocation:N,distance:B}}const _=s.reduce((N,B)=>{const q=g(o.latitude,o.longitude,B.latitude,B.longitude);return!N||q<N.distance?{location:B,distance:q}:N},null);return{allowed:!1,nearestLocation:_==null?void 0:_.location,distance:_==null?void 0:_.distance}}async function j(){try{const _=be(new Date(f),"EEEE",{locale:nt}),{data:N,error:B}=await Y.from("schedules").select(`
          id,
          hari,
          jam_mulai,
          jam_selesai,
          subject:subjects(nama_mapel),
          class:classes(
            nama_kelas,
            tingkat,
            major:majors(kode_jurusan)
          )
        `).eq("guru_id",e==null?void 0:e.id).eq("hari",_).order("jam_mulai",{ascending:!0});if(B)throw B;r(N||[])}catch(_){console.error("Error fetching schedules:",_)}}async function A(){try{const{data:_,error:N}=await Y.from("teacher_attendance").select(`
          *,
          schedule:schedules(
            hari,
            jam_mulai,
            jam_selesai,
            subject:subjects(nama_mapel),
            class:classes(
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            )
          )
        `).eq("guru_id",e==null?void 0:e.id).gte("tanggal",be(new Date(f).setDate(new Date(f).getDate()-30),"yyyy-MM-dd")).lte("tanggal",f).order("tanggal",{ascending:!1});if(N)throw N;a(_||[])}catch(_){console.error("Error fetching attendances:",_)}finally{v(!1)}}async function k(_,N,B,q){const Z=b();if(!Z.allowed){if(u){alert("Error lokasi: "+u+`

Silakan aktifkan GPS dan refresh halaman.`);return}Z.nearestLocation&&Z.distance?alert(`Anda berada di luar area absensi!

Lokasi terdekat: ${Z.nearestLocation.name}
Jarak Anda: ${Math.round(Z.distance)}m
Radius yang diizinkan: ${Z.nearestLocation.radius}m

Silakan mendekati lokasi sekolah untuk melakukan absensi.`):alert("Tidak ada lokasi absensi yang tersedia atau Anda berada terlalu jauh dari semua lokasi.");return}try{if(!(e!=null&&e.id)){alert("Error: User tidak valid. Silakan login ulang.");return}const _e=be(new Date,"HH:mm:ss"),ce=n.find(we=>we.schedule_id===_&&we.tanggal===f);if(ce){const we={};N==="masuk"?(we.jam_masuk=_e,B&&(we.status=B),q&&(we.keterangan=q)):we.jam_pulang=_e;const{error:pe}=await Y.from("teacher_attendance").update(we).eq("id",ce.id);if(pe)throw pe}else{const we={guru_id:e.id,schedule_id:_,tanggal:f,status:B||"hadir"};N==="masuk"?(we.jam_masuk=_e,q&&(we.keterangan=q)):we.jam_pulang=_e;const{error:pe}=await Y.from("teacher_attendance").insert(we);if(pe)throw pe}A()}catch(_e){console.error("Error marking attendance:",_e),alert("Gagal mencatat kehadiran: "+_e.message)}}const D=_=>n.find(N=>N.schedule_id===_&&N.tanggal===f);return n.filter(_=>_.tanggal===f),m?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Absensi Saya"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola kehadiran per mata pelajaran yang diampu"})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pilih Tanggal"}),l.jsx("p",{className:"text-gray-600",children:"Lihat jadwal dan absensi untuk tanggal tertentu"})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(Ks,{className:"text-blue-600",size:16}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status Lokasi"})]}),u?l.jsxs("div",{className:"text-xs text-red-600",children:[l.jsx("p",{children:u}),l.jsx("button",{onClick:p,className:"text-blue-600 hover:text-blue-800 underline mt-1",children:"Coba Lagi"})]}):o?(()=>{var N;const _=b();return l.jsx("div",{className:`text-xs ${_.allowed?"text-green-600":"text-red-600"}`,children:_.allowed?l.jsxs("div",{children:[l.jsx("p",{children:" Dalam area absensi"}),l.jsxs("p",{className:"text-gray-500",children:[(N=_.nearestLocation)==null?void 0:N.name,"(",Math.round(_.distance||0),"m)"]})]}):l.jsxs("div",{children:[l.jsx("p",{children:" Di luar area absensi"}),_.nearestLocation&&l.jsxs("p",{className:"text-gray-500",children:["Terdekat: ",_.nearestLocation.name,"(",Math.round(_.distance||0),"m)"]})]})})})():l.jsx("div",{className:"text-xs text-yellow-600",children:l.jsx("p",{children:" Mengambil lokasi..."})})]}),l.jsxs("div",{className:"text-left lg:text-right",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:be(x,"HH:mm:ss")}),l.jsx("p",{className:"text-sm text-gray-500",children:"Waktu Sekarang"})]})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 mb-8",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Gt,{className:"text-blue-600",size:24}),l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Jadwal ",be(new Date(f),"EEEE, dd MMMM yyyy",{locale:nt})]}),l.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm",children:[t.length," mata pelajaran"]})]})}),t.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(jr,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada jadwal mengajar pada tanggal ini"})]}):l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-4",children:t.map(_=>{const N=D(_.id);return l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 sm:p-6 border border-blue-100",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between mb-4 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(jr,{className:"text-blue-600",size:24})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-base sm:text-lg text-gray-900",children:_.subject.nama_mapel}),l.jsxs("p",{className:"text-sm sm:text-base text-gray-600",children:["Kelas ",_.class.tingkat," ",_.class.nama_kelas," - ",_.class.major.kode_jurusan]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[_.jam_mulai," - ",_.jam_selesai]})]})]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-xs sm:text-sm font-medium whitespace-nowrap ${(N==null?void 0:N.status)==="hadir"?"bg-green-100 text-green-800":(N==null?void 0:N.status)==="izin"?"bg-yellow-100 text-yellow-800":(N==null?void 0:N.status)==="sakit"?"bg-blue-100 text-blue-800":(N==null?void 0:N.status)==="tidak_hadir"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:(N==null?void 0:N.status)||"Belum Absen"})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4",children:[l.jsx("div",{className:"bg-white rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(zr,{className:"text-green-600",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Mulai KBM"}),l.jsx("p",{className:"font-semibold text-green-800",children:(N==null?void 0:N.jam_masuk)||"-"})]})]})}),l.jsx("div",{className:"bg-white rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(zr,{className:"text-red-600",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Selesai KBM"}),l.jsx("p",{className:"font-semibold text-red-800",children:(N==null?void 0:N.jam_pulang)||"-"})]})]})}),l.jsx("div",{className:"bg-white rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(As,{className:"text-gray-600",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Keterangan"}),l.jsx("p",{className:"font-semibold text-gray-800",children:(N==null?void 0:N.keterangan)||"-"})]})]})})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[!(N!=null&&N.jam_masuk)&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>k(_.id,"masuk","hadir"),className:"bg-green-500 text-white py-2 px-3 sm:px-4 rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-1 sm:space-x-2 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b().allowed,children:[l.jsx(Gs,{size:16}),l.jsx("span",{children:"Mulai KBM"})]}),l.jsxs("button",{onClick:()=>{const B=prompt("Keterangan izin:");B!==null&&k(_.id,"masuk","izin",B)},className:"bg-yellow-500 text-white py-2 px-3 sm:px-4 rounded-lg hover:bg-yellow-600 transition-colors flex items-center space-x-1 sm:space-x-2 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b().allowed,children:[l.jsx(As,{size:16}),l.jsx("span",{children:"Izin"})]}),l.jsxs("button",{onClick:()=>{const B=prompt("Keterangan sakit:");B!==null&&k(_.id,"masuk","sakit",B)},className:"bg-blue-500 text-white py-2 px-3 sm:px-4 rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-1 sm:space-x-2 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b().allowed,children:[l.jsx(zr,{size:16}),l.jsx("span",{children:"Sakit"})]})]}),(N==null?void 0:N.jam_masuk)&&!(N!=null&&N.jam_pulang)&&N.status==="hadir"&&l.jsxs("button",{onClick:()=>k(_.id,"pulang"),className:"bg-red-500 text-white py-2 px-3 sm:px-4 rounded-lg hover:bg-red-600 transition-colors flex items-center space-x-1 sm:space-x-2 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b().allowed,children:[l.jsx(xl,{size:16}),l.jsx("span",{children:"Selesai Kelas"})]}),(N==null?void 0:N.jam_masuk)&&(N==null?void 0:N.jam_pulang)&&l.jsx("div",{className:"bg-gray-100 text-gray-600 py-2 px-3 sm:px-4 rounded-lg flex items-center text-sm sm:text-base",children:l.jsx("span",{children:"Absensi Lengkap"})})]}),!b().allowed&&!(N!=null&&N.jam_masuk)&&l.jsx("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ks,{className:"text-yellow-600",size:16}),l.jsx("p",{className:"text-xs text-yellow-800",children:"Anda harus berada di area sekolah untuk melakukan absensi"})]})})]},_.id)})})})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(cn,{className:"text-blue-600",size:24}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Riwayat Kehadiran (30 Hari Terakhir)"})]})}),l.jsx("div",{className:"overflow-x-auto -mx-6 sm:mx-0",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mata Pelajaran"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell",children:"Kelas"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mulai KBM"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Selesai Kelas"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell",children:"Keterangan"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(_=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:be(new Date(_.tanggal),"dd MMM yyyy",{locale:nt})}),l.jsxs("td",{className:"px-3 sm:px-6 py-4 text-xs sm:text-sm text-gray-900",children:[l.jsx("div",{className:"font-medium",children:_.schedule.subject.nama_mapel}),l.jsxs("div",{className:"text-xs text-gray-500 sm:hidden",children:[_.schedule.class.tingkat," ",_.schedule.class.nama_kelas]})]}),l.jsxs("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900 hidden sm:table-cell",children:[_.schedule.class.tingkat," ",_.schedule.class.nama_kelas]}),l.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:_.jam_masuk||"-"}),l.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:_.jam_pulang||"-"}),l.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_.status==="hadir"?"bg-green-100 text-green-800":_.status==="izin"?"bg-yellow-100 text-yellow-800":_.status==="sakit"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:_.status})}),l.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500 hidden lg:table-cell",children:_.keterangan||"-"})]},_.id))})]})}),n.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(cn,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada data kehadiran"})]})]})]})}function wj(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState(null),[s,i]=T.useState([]),[o,c]=T.useState([]),[u,d]=T.useState(be(new Date,"yyyy-MM-dd")),[f,h]=T.useState(!0);T.useEffect(()=>{e&&m()},[e]),T.useEffect(()=>{n&&v()},[n,u]);async function m(){try{const{data:g,error:b}=await Y.from("schedules").select(`
          id,
          hari,
          jam_mulai,
          jam_selesai,
          subject:subjects(nama_mapel),
          class:classes(
            id,
            nama_kelas,
            tingkat,
            major:majors(kode_jurusan)
          )
        `).eq("guru_id",e==null?void 0:e.id).order("hari",{ascending:!0});if(b)throw b;r(g||[]),g&&g.length>0&&a(g[0])}catch(g){console.error("Error fetching schedules:",g)}finally{h(!1)}}async function v(){if(n)try{const{data:g,error:b}=await Y.from("students_classes").select(`
          siswa_id,
          student:users(id, nama, email)
        `).eq("kelas_id",n.class.id).eq("status","aktif");if(b)throw b;const j=(g==null?void 0:g.map(D=>D.student).filter(Boolean))||[];i(j);const{data:A,error:k}=await Y.from("attendance").select(`
          id,
          siswa_id,
          status,
          keterangan,
          student:users(nama)
        `).eq("schedule_id",n.id).eq("tanggal",u);if(k)throw k;c(A||[])}catch(g){console.error("Error fetching students and attendance:",g)}}async function x(g,b,j){if(n)try{const A=o.find(k=>k.siswa_id===g);if(A){const{error:k}=await Y.from("attendance").update({status:b,keterangan:j||null}).eq("id",A.id);if(k)throw k}else{const{error:k}=await Y.from("attendance").insert({schedule_id:n.id,siswa_id:g,status:b,tanggal:u,keterangan:j||null});if(k)throw k}v()}catch(A){console.error("Error marking attendance:",A),alert("Gagal menyimpan absensi")}}async function w(){if(n)try{const g=s.map(b=>{const j=o.find(A=>A.siswa_id===b.id);return j?Y.from("attendance").update({status:"hadir"}).eq("id",j.id):Y.from("attendance").insert({schedule_id:n.id,siswa_id:b.id,status:"hadir",tanggal:u})});await Promise.all(g),v()}catch(g){console.error("Error marking all present:",g),alert("Gagal menandai semua hadir")}}const y=g=>{var b;return((b=o.find(j=>j.siswa_id===g))==null?void 0:b.status)||""},p=g=>{var b;return((b=o.find(j=>j.siswa_id===g))==null?void 0:b.keterangan)||""};return f?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Absensi Siswa"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola kehadiran siswa untuk setiap kelas"})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Jadwal"}),l.jsxs("select",{value:(n==null?void 0:n.id)||"",onChange:g=>{const b=t.find(j=>j.id===g.target.value);a(b||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Pilih Jadwal"}),t.map(g=>l.jsxs("option",{value:g.id,children:[g.hari," - ",g.subject.nama_mapel," - ",g.class.tingkat," ",g.class.nama_kelas]},g.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal"}),l.jsx("input",{type:"date",value:u,onChange:g=>d(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx("button",{onClick:w,disabled:!n||s.length===0,className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Tandai Semua Hadir"})})]})}),n&&l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n.subject.nama_mapel}),l.jsxs("p",{className:"text-gray-600",children:["Kelas ",n.class.tingkat," ",n.class.nama_kelas," - ",n.class.major.kode_jurusan]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[n.hari,", ",n.jam_mulai," - ",n.jam_selesai]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Siswa"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.length})]})]})}),s.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(cn,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada siswa di kelas ini"})]}):l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-4",children:s.map((g,b)=>{const j=y(g.id),A=p(g.id);return l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium",children:b+1})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:g.nama}),l.jsx("p",{className:"text-sm text-gray-600",children:g.email})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>x(g.id,"hadir"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${j==="hadir"?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-green-100"}`,children:[l.jsx(Gs,{size:16,className:"inline mr-1"}),"Hadir"]}),l.jsxs("button",{onClick:()=>x(g.id,"tidak_hadir"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${j==="tidak_hadir"?"bg-red-500 text-white":"bg-gray-200 text-gray-700 hover:bg-red-100"}`,children:[l.jsx(xl,{size:16,className:"inline mr-1"}),"Tidak Hadir"]}),l.jsxs("button",{onClick:()=>{const k=prompt("Keterangan izin:",A);k!==null&&x(g.id,"izin",k)},className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${j==="izin"?"bg-yellow-500 text-white":"bg-gray-200 text-gray-700 hover:bg-yellow-100"}`,children:[l.jsx(As,{size:16,className:"inline mr-1"}),"Izin"]}),l.jsxs("button",{onClick:()=>{const k=prompt("Keterangan sakit:",A);k!==null&&x(g.id,"sakit",k)},className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${j==="sakit"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-blue-100"}`,children:[l.jsx(zr,{size:16,className:"inline mr-1"}),"Sakit"]})]})]},g.id)})})})]})]})}function _j(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState([]),[o,c]=T.useState(!0),[u,d]=T.useState(""),[f,h]=T.useState(!1),[m,v]=T.useState(null),[x,w]=T.useState({judul:"",tipe:"text",konten:"",file_url:"",kelas_id:"",mapel_id:""});T.useEffect(()=>{e&&y()},[e]);async function y(){var j,A;try{const[k,D,_]=await Promise.all([Y.from("materials").select(`
            *,
            class:classes(
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            ),
            subject:subjects(nama_mapel)
          `).eq("guru_id",e==null?void 0:e.id).order("created_at",{ascending:!1}),Y.from("schedules").select(`
            class:classes(
              id,
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            )
          `).eq("guru_id",e==null?void 0:e.id),Y.from("schedules").select(`
            subject:subjects(id, nama_mapel)
          `).eq("guru_id",e==null?void 0:e.id)]);if(k.error)throw k.error;if(D.error)throw D.error;if(_.error)throw _.error;r(k.data||[]);const N=((j=D.data)==null?void 0:j.map(q=>q.class).filter(Boolean))||[],B=((A=_.data)==null?void 0:A.map(q=>q.subject).filter(Boolean))||[];a(N),i(B)}catch(k){console.error("Error fetching data:",k)}finally{c(!1)}}async function p(j){j.preventDefault();try{const A={guru_id:e==null?void 0:e.id,kelas_id:x.kelas_id,mapel_id:x.mapel_id,judul:x.judul,tipe:x.tipe,konten:x.tipe==="text"?x.konten:null,file_url:x.tipe==="pdf"?x.file_url:null};if(m){const{error:k}=await Y.from("materials").update(A).eq("id",m.id);if(k)throw k}else{const{error:k}=await Y.from("materials").insert(A);if(k)throw k}h(!1),v(null),w({judul:"",tipe:"text",konten:"",file_url:"",kelas_id:"",mapel_id:""}),y()}catch(A){alert("Error: "+A.message)}}async function g(j){if(confirm(`Hapus materi "${j.judul}"?`))try{const{error:A}=await Y.from("materials").delete().eq("id",j.id);if(A)throw A;y()}catch(A){alert("Error: "+A.message)}}const b=t.filter(j=>j.judul.toLowerCase().includes(u.toLowerCase())||j.subject.nama_mapel.toLowerCase().includes(u.toLowerCase()));return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Materi Pembelajaran"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola materi untuk siswa Anda"})]}),l.jsxs("button",{onClick:()=>{v(null),w({judul:"",tipe:"text",konten:"",file_url:"",kelas_id:"",mapel_id:""}),h(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Materi"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari materi...",value:u,onChange:j=>d(j.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:b.map(j=>l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:j.tipe==="text"?l.jsx(Ps,{className:"text-purple-600",size:24}):l.jsx(hd,{className:"text-purple-600",size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:j.judul}),l.jsx("p",{className:"text-sm text-gray-600",children:j.subject.nama_mapel})]})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>{v(j),w({judul:j.judul,tipe:j.tipe,konten:j.konten||"",file_url:j.file_url||"",kelas_id:"",mapel_id:""}),h(!0)},className:"text-purple-600 hover:text-purple-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>g(j),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Kelas:"})," ",j.class.tingkat," ",j.class.nama_kelas," - ",j.class.major.kode_jurusan]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Tipe:"})," ",j.tipe==="text"?"Teks":"PDF"]}),j.tipe==="text"&&j.konten&&l.jsxs("p",{className:"text-sm text-gray-600 line-clamp-3",children:[j.konten.substring(0,100),"..."]}),j.tipe==="pdf"&&j.file_url&&l.jsxs("a",{href:j.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-purple-600 hover:text-purple-800 text-sm",children:[l.jsx(Fl,{size:14}),l.jsx("span",{children:"Lihat File"})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Dibuat: ",new Date(j.created_at).toLocaleDateString("id-ID")]})]})]},j.id))}),b.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ps,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada materi pembelajaran"})]})]}),f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:m?"Edit Materi":"Tambah Materi Baru"}),l.jsxs("form",{onSubmit:p,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul Materi"}),l.jsx("input",{type:"text",value:x.judul,onChange:j=>w({...x,judul:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kelas"}),l.jsxs("select",{value:x.kelas_id,onChange:j=>w({...x,kelas_id:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Kelas"}),n.map(j=>l.jsxs("option",{value:j.id,children:[j.tingkat," ",j.nama_kelas," - ",j.major.kode_jurusan]},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mata Pelajaran"}),l.jsxs("select",{value:x.mapel_id,onChange:j=>w({...x,mapel_id:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Mata Pelajaran"}),s.map(j=>l.jsx("option",{value:j.id,children:j.nama_mapel},j.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe Materi"}),l.jsxs("select",{value:x.tipe,onChange:j=>w({...x,tipe:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0,children:[l.jsx("option",{value:"text",children:"Teks"}),l.jsx("option",{value:"pdf",children:"PDF"})]})]}),x.tipe==="text"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konten Materi"}),l.jsx("textarea",{value:x.konten,onChange:j=>w({...x,konten:j.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Tulis konten materi di sini...",required:!0})]}),x.tipe==="pdf"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL File PDF"}),l.jsx("input",{type:"url",value:x.file_url,onChange:j=>w({...x,file_url:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"https://example.com/file.pdf",required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Masukkan URL file PDF yang dapat diakses secara online"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:m?"Update":"Simpan"})]})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xc={};xc.version="0.18.5";var V1=1252,bj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],G1=function(e){bj.indexOf(e)!=-1&&(V1=e)};function Sj(){G1(1252)}var pl=function(e){G1(e)};function kj(){pl(1200),Sj()}var mo=function(t){return String.fromCharCode(t)},Xx=function(t){return String.fromCharCode(t)},ka,qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gl(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=qn.charAt(s)+qn.charAt(i)+qn.charAt(o)+qn.charAt(c);return t}function Cn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=qn.indexOf(e.charAt(u++)),i=qn.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=qn.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=qn.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Oe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Fn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ma(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Yx(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Mr=function(t){return Oe?Fn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Zc(e){if(typeof ArrayBuffer>"u")return Mr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Dl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function jj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var jt=Oe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Fn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Ej(e){for(var t=[],r=0,n=e.length+250,a=Ma(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ma(65535),n=65530)}return t.push(a.slice(0,r)),jt(t)}var Ui=/\u0000/g,po=/[\u0001-\u0006]/g;function Fs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Br(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}function Nf(e,t){var r=""+e;return r.length>=t?r:rt(" ",t-r.length)+r}function mc(e,t){var r=""+e;return r.length>=t?r:r+rt(" ",t-r.length)}function Tj(e,t){var r=""+Math.round(e);return r.length>=t?r:rt("0",t-r.length)+r}function Nj(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}var Jx=Math.pow(2,32);function ns(e,t){if(e>Jx||e<-Jx)return Tj(e,t);var r=Math.round(e);return Nj(r,t)}function pc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Qx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Cj(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Aj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gc(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*i+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=s):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function go(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Mj(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var q1=new Date(1899,11,31,0,0,0),Pj=q1.getTime(),Oj=new Date(1900,2,1,0,0,0);function K1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Oj&&(r+=24*60*60*1e3),(r-(Pj+(e.getTimezoneOffset()-q1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Fj(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Dj(e){var t=e<0?12:11,r=Cf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Rj(e){var t=Cf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Lj(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Dj(e):t===10?r=e.toFixed(10).substr(0,12):r=Rj(e),Cf(Fj(r.toUpperCase()))}function xd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Lj(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ia(14,K1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Mj(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ij(e,t,r,n){var a="",s=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Xu[r.m-1][1];case 5:return Xu[r.m-1][0];default:return Xu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Qx[r.q][0];default:return Qx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Br(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Br(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Br(c,u):"";return d}function Kn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var X1=/%/g;function Bj(e,t,r){var n=t.replace(X1,""),a=t.length-n.length;return _n(e,n,r*Math.pow(10,2*a))+rt("%",a)}function Uj(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y1(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J1=/# (\?+)( ?)\/( ?)(\d+)/;function $j(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?rt(" ",e[1].length+1+e[4].length):Nf(i,e[1].length)+e[2]+"/"+e[3]+Br(o,e[4].length))}function zj(e,t,r){return r+(t===0?"":""+t)+rt(" ",e[1].length+2+e[4].length)}var Q1=/^#*0*\.([0#]+)/,Z1=/\).*[0#]/,ev=/\(###\) ###\\?-####/;function zt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function em(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function tm(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Wj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Hj(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function pr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pr("n",n,r):"("+pr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Uj(e,t,r);if(t.indexOf("%")!==-1)return Bj(e,t,r);if(t.indexOf("E")!==-1)return Y1(t,r);if(t.charCodeAt(0)===36)return"$"+pr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ns(c,t.length);if(t.match(/^[#?]+$/))return a=ns(r,0),a==="0"&&(a=""),a.length>t.length?a:zt(t.substr(0,t.length-a.length))+a;if(s=t.match(J1))return $j(s,c,u);if(t.match(/^#+0+$/))return u+ns(c,t.length-t.indexOf("0"));if(s=t.match(Q1))return a=em(r,s[1].length).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+rt("0",zt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+em(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Kn(ns(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pr(e,t,-r):Kn(""+(Math.floor(r)+Wj(r,s[1].length)))+"."+Br(tm(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return pr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(pr(e,t.replace(/[\\-]/g,""),r)),i=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(ev))return a=pr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=gc(c,Math.pow(10,i)-1,!1),a=""+u,d=_n("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=mc(o[2],i),d.length<s[4].length&&(d=zt(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=gc(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Nf(o[1],i)+s[2]+"/"+s[3]+mc(o[2],i):rt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=ns(r,0),t.length<=a.length?a:zt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return zt(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=tm(r,s[1].length),r<0?"-"+pr(e,t,-r):Kn(Hj(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Br(0,3-v.length):"")+v})+"."+Br(i,s[1].length);switch(t){case"###,##0.00":return pr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Kn(ns(c,0));return m!=="0"?u+m:"";case"###,###.00":return pr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return pr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Vj(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Gj(e,t,r){var n=t.replace(X1,""),a=t.length-n.length;return _n(e,n,r*Math.pow(10,2*a))+rt("%",a)}function tv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Vj(e,t,r);if(t.indexOf("%")!==-1)return Gj(e,t,r);if(t.indexOf("E")!==-1)return tv(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Br(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:zt(t.substr(0,t.length-a.length))+a;if(s=t.match(J1))return zj(s,c,u);if(t.match(/^#+0+$/))return u+Br(c,t.length-t.indexOf("0"));if(s=t.match(Q1))return a=(""+r).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])),a=a.replace(/\.(\d*)$/,function(v,x){return"."+x+rt("0",zt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Kn(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Kn(""+r)+"."+rt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(Jr(e,t.replace(/[\\-]/g,""),r)),i=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(ev))return a=Jr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=gc(c,Math.pow(10,i)-1,!1),a=""+u,d=_n("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=mc(o[2],i),d.length<s[4].length&&(d=zt(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=gc(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Nf(o[1],i)+s[2]+"/"+s[3]+mc(o[2],i):rt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:zt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return zt(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Kn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Br(0,3-v.length):"")+v})+"."+Br(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Kn(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Jr(e,t.slice(0,t.lastIndexOf(".")),r)+zt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _n(e,t,r){return(r|0)===r?Jr(e,t,r):pr(e,t,r)}function qj(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nv(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":pc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rv))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Kj(e,t,r,n){for(var a=[],s="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!pc(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var m=e.charAt(++i),v=m==="("||m===")"?m:"t";a[a.length]={t:v,v:m},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=go(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=go(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=go(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),u==null&&x.t==="T")return"";a[a.length]=x,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(rv)){if(u==null&&(u=go(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",nv(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var w=0,y=0,p;for(i=a.length-1,c="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,c="h",w<1&&(w=1);break;case"s":(p=a[i].v.match(/\.0+$/))&&(y=Math.max(y,p[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=a[i].t;break;case"m":c==="s"&&(a[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[i].v.match(/[Hh]/)&&(w=1),w<2&&a[i].v.match(/[Mm]/)&&(w=2),w<3&&a[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",b;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=Ij(a[i].t.charCodeAt(0),a[i].v,u,y),a[i].t="t";break;case"n":case"?":for(b=i+1;a[b]!=null&&((o=a[b].t)==="?"||o==="D"||(o===" "||o==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[i].v+=a[b].v,a[b]={v:"",t:";"},++b;g+=a[i].v,i=b-1;break;case"G":a[i].t="t",a[i].v=xd(t,r);break}var j="",A,k;if(g.length>0){g.charCodeAt(0)==40?(A=t<0&&g.charCodeAt(0)===45?-t:t,k=_n("n",g,A)):(A=t<0&&n>1?-t:t,k=_n("n",g,A),A<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),b=k.length-1;var D=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){D=i;break}var _=a.length;if(D===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(b>=a[i].v.length-1?(b-=a[i].v.length,a[i].v=k.substr(b+1,a[i].v.length)):b<0?a[i].v="":(a[i].v=k.substr(0,b+1),b=-1),a[i].t="t",_=i);b>=0&&_<a.length&&(a[_].v=k.substr(0,b+1)+a[_].v)}else if(D!==a.length&&k.indexOf("E")===-1){for(b=k.indexOf(".")-1,i=D;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===D?a[i].v.indexOf(".")-1:a[i].v.length-1,j=a[i].v.substr(d+1);d>=0;--d)b>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(j=k.charAt(b--)+j);a[i].v=j,a[i].t="t",_=i}for(b>=0&&_<a.length&&(a[_].v=k.substr(0,b+1)+a[_].v),b=k.indexOf(".")+1,i=D;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==D)){for(d=a[i].v.indexOf(".")>-1&&i===D?a[i].v.indexOf(".")+1:0,j=a[i].v.substr(0,d);d<a[i].v.length;++d)b<k.length&&(j+=k.charAt(b++));a[i].v=j,a[i].t="t",_=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(A=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=_n(a[i].t,a[i].v,A),a[i].t="t");var N="";for(i=0;i!==a.length;++i)a[i]!=null&&(N+=a[i].v);return N}var rm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Xj(e,t){var r=qj(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(rm),o=r[1].match(rm);return nm(t,i)?[n,r[0]]:nm(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function ia(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[e],n==null&&(n=r.table&&r.table[Zx[e]]||at[Zx[e]]),n==null&&(n=Aj[e]||"General");break}if(pc(n,0))return xd(t,r);t instanceof Date&&(t=K1(t,r.date1904));var a=Xj(n,t);if(pc(a[1]))return xd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Kj(a[1],t,r,a[0])}function av(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(at[r]==null){t<0&&(t=r);continue}if(at[r]==e){t=r;break}}t<0&&(t=391)}return at[t]=e,t}function eu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&av(e[t],t)}function tu(){at=Cj()}var sv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Yj(e){var t=typeof e=="number"?at[e]:e;return t=t.replace(sv,"(\\d+)"),new RegExp("^"+t+"$")}function Jj(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(t.match(sv)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?o=m:a=m;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var Qj=function(){var e={};e.version="1.2.0";function t(){for(var k=0,D=new Array(256),_=0;_!=256;++_)k=_,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,D[_]=k;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(k){var D=0,_=0,N=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)B[N]=k[N];for(N=0;N!=256;++N)for(_=k[N],D=256+N;D<4096;D+=256)_=B[D]=_>>>8^k[_&255];var q=[];for(N=1;N!=16;++N)q[N-1]=typeof Int32Array<"u"?B.subarray(N*256,N*256+256):B.slice(N*256,N*256+256);return q}var a=n(r),s=a[0],i=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],m=a[8],v=a[9],x=a[10],w=a[11],y=a[12],p=a[13],g=a[14];function b(k,D){for(var _=D^-1,N=0,B=k.length;N<B;)_=_>>>8^r[(_^k.charCodeAt(N++))&255];return~_}function j(k,D){for(var _=D^-1,N=k.length-15,B=0;B<N;)_=g[k[B++]^_&255]^p[k[B++]^_>>8&255]^y[k[B++]^_>>16&255]^w[k[B++]^_>>>24]^x[k[B++]]^v[k[B++]]^m[k[B++]]^h[k[B++]]^f[k[B++]]^d[k[B++]]^u[k[B++]]^c[k[B++]]^o[k[B++]]^i[k[B++]]^s[k[B++]]^r[k[B++]];for(N+=15;B<N;)_=_>>>8^r[(_^k[B++])&255];return~_}function A(k,D){for(var _=D^-1,N=0,B=k.length,q=0,Z=0;N<B;)q=k.charCodeAt(N++),q<128?_=_>>>8^r[(_^q)&255]:q<2048?(_=_>>>8^r[(_^(192|q>>6&31))&255],_=_>>>8^r[(_^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,Z=k.charCodeAt(N++)&1023,_=_>>>8^r[(_^(240|q>>8&7))&255],_=_>>>8^r[(_^(128|q>>2&63))&255],_=_>>>8^r[(_^(128|Z>>6&15|(q&3)<<4))&255],_=_>>>8^r[(_^(128|Z&63))&255]):(_=_>>>8^r[(_^(224|q>>12&15))&255],_=_>>>8^r[(_^(128|q>>6&63))&255],_=_>>>8^r[(_^(128|q&63))&255]);return~_}return e.table=r,e.bstr=b,e.buf=j,e.str=A,e}(),ze=function(){var t={};t.version="1.2.1";function r(S,P){for(var E=S.split("/"),C=P.split("/"),O=0,F=0,z=Math.min(E.length,C.length);O<z;++O){if(F=E[O].length-C[O].length)return F;if(E[O]!=C[O])return E[O]<C[O]?-1:1}return E.length-C.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var P=S.lastIndexOf("/");return P===-1?S:S.slice(0,P+1)}function a(S){if(S.charAt(S.length-1)=="/")return a(S.slice(0,-1));var P=S.lastIndexOf("/");return P===-1?S:S.slice(P+1)}function s(S,P){typeof P=="string"&&(P=new Date(P));var E=P.getHours();E=E<<6|P.getMinutes(),E=E<<5|P.getSeconds()>>>1,S.write_shift(2,E);var C=P.getFullYear()-1980;C=C<<4|P.getMonth()+1,C=C<<5|P.getDate(),S.write_shift(2,C)}function i(S){var P=S.read_shift(2)&65535,E=S.read_shift(2)&65535,C=new Date,O=E&31;E>>>=5;var F=E&15;E>>>=4,C.setMilliseconds(0),C.setFullYear(E+1980),C.setMonth(F-1),C.setDate(O);var z=P&31;P>>>=5;var K=P&63;return P>>>=6,C.setHours(P),C.setMinutes(K),C.setSeconds(z<<1),C}function o(S){ir(S,0);for(var P={},E=0;S.l<=S.length-4;){var C=S.read_shift(2),O=S.read_shift(2),F=S.l+O,z={};switch(C){case 21589:E=S.read_shift(1),E&1&&(z.mtime=S.read_shift(4)),O>5&&(E&2&&(z.atime=S.read_shift(4)),E&4&&(z.ctime=S.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}S.l=F,P[C]=z}return P}var c;function u(){return c||(c={})}function d(S,P){if(S[0]==80&&S[1]==75)return ah(S,P);if((S[0]|32)==109&&(S[1]|32)==105)return Ry(S,P);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var E=3,C=512,O=0,F=0,z=0,K=0,U=0,W=[],V=S.slice(0,512);ir(V,0);var ee=f(V);switch(E=ee[0],E){case 3:C=512;break;case 4:C=4096;break;case 0:if(ee[1]==0)return ah(S,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}C!==512&&(V=S.slice(0,C),ir(V,28));var ie=S.slice(0,C);h(V,E);var fe=V.read_shift(4,"i");if(E===3&&fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+fe);V.l+=4,z=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),K=V.read_shift(4,"i"),O=V.read_shift(4,"i"),U=V.read_shift(4,"i"),F=V.read_shift(4,"i");for(var ne=-1,oe=0;oe<109&&(ne=V.read_shift(4,"i"),!(ne<0));++oe)W[oe]=ne;var Se=m(S,C);w(U,F,Se,C,W);var Ye=p(Se,z,W,C);Ye[z].name="!Directory",O>0&&K!==Z&&(Ye[K].name="!MiniFAT"),Ye[W[0]].name="!FAT",Ye.fat_addrs=W,Ye.ssz=C;var Je={},Ft=[],oi=[],ci=[];g(z,Ye,Se,Ft,O,Je,oi,K),v(oi,ci,Ft),Ft.shift();var ui={FileIndex:oi,FullPaths:ci};return P&&P.raw&&(ui.raw={header:ie,sectors:Se}),ui}function f(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(_e,"Header Signature: "),S.l+=16;var P=S.read_shift(2,"u");return[S.read_shift(2,"u"),P]}function h(S,P){var E=9;switch(S.l+=2,E=S.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,P){for(var E=Math.ceil(S.length/P)-1,C=[],O=1;O<E;++O)C[O-1]=S.slice(O*P,(O+1)*P);return C[E-1]=S.slice(E*P),C}function v(S,P,E){for(var C=0,O=0,F=0,z=0,K=0,U=E.length,W=[],V=[];C<U;++C)W[C]=V[C]=C,P[C]=E[C];for(;K<V.length;++K)C=V[K],O=S[C].L,F=S[C].R,z=S[C].C,W[C]===C&&(O!==-1&&W[O]!==O&&(W[C]=W[O]),F!==-1&&W[F]!==F&&(W[C]=W[F])),z!==-1&&(W[z]=C),O!==-1&&C!=W[C]&&(W[O]=W[C],V.lastIndexOf(O)<K&&V.push(O)),F!==-1&&C!=W[C]&&(W[F]=W[C],V.lastIndexOf(F)<K&&V.push(F));for(C=1;C<U;++C)W[C]===C&&(F!==-1&&W[F]!==F?W[C]=W[F]:O!==-1&&W[O]!==O&&(W[C]=W[O]));for(C=1;C<U;++C)if(S[C].type!==0){if(K=C,K!=W[K])do K=W[K],P[C]=P[K]+"/"+P[C];while(K!==0&&W[K]!==-1&&K!=W[K]);W[C]=-1}for(P[0]+="/",C=1;C<U;++C)S[C].type!==2&&(P[C]+="/")}function x(S,P,E){for(var C=S.start,O=S.size,F=[],z=C;E&&O>0&&z>=0;)F.push(P.slice(z*q,z*q+q)),O-=q,z=ja(E,z*4);return F.length===0?G(0):jt(F).slice(0,S.size)}function w(S,P,E,C,O){var F=Z;if(S===Z){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var z=E[S],K=(C>>>2)-1;if(!z)return;for(var U=0;U<K&&(F=ja(z,U*4))!==Z;++U)O.push(F);w(ja(z,C-4),P-1,E,C,O)}}function y(S,P,E,C,O){var F=[],z=[];O||(O=[]);var K=C-1,U=0,W=0;for(U=P;U>=0;){O[U]=!0,F[F.length]=U,z.push(S[U]);var V=E[Math.floor(U*4/C)];if(W=U*4&K,C<4+W)throw new Error("FAT boundary crossed: "+U+" 4 "+C);if(!S[V])break;U=ja(S[V],W)}return{nodes:F,data:dm([z])}}function p(S,P,E,C){var O=S.length,F=[],z=[],K=[],U=[],W=C-1,V=0,ee=0,ie=0,fe=0;for(V=0;V<O;++V)if(K=[],ie=V+P,ie>=O&&(ie-=O),!z[ie]){U=[];var ne=[];for(ee=ie;ee>=0;){ne[ee]=!0,z[ee]=!0,K[K.length]=ee,U.push(S[ee]);var oe=E[Math.floor(ee*4/C)];if(fe=ee*4&W,C<4+fe)throw new Error("FAT boundary crossed: "+ee+" 4 "+C);if(!S[oe]||(ee=ja(S[oe],fe),ne[ee]))break}F[ie]={nodes:K,data:dm([U])}}return F}function g(S,P,E,C,O,F,z,K){for(var U=0,W=C.length?2:0,V=P[S].data,ee=0,ie=0,fe;ee<V.length;ee+=128){var ne=V.slice(ee,ee+128);ir(ne,64),ie=ne.read_shift(2),fe=Df(ne,0,ie-W),C.push(fe);var oe={name:fe,type:ne.read_shift(1),color:ne.read_shift(1),L:ne.read_shift(4,"i"),R:ne.read_shift(4,"i"),C:ne.read_shift(4,"i"),clsid:ne.read_shift(16),state:ne.read_shift(4,"i"),start:0,size:0},Se=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);Se!==0&&(oe.ct=b(ne,ne.l-8));var Ye=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);Ye!==0&&(oe.mt=b(ne,ne.l-8)),oe.start=ne.read_shift(4,"i"),oe.size=ne.read_shift(4,"i"),oe.size<0&&oe.start<0&&(oe.size=oe.type=0,oe.start=Z,oe.name=""),oe.type===5?(U=oe.start,O>0&&U!==Z&&(P[U].name="!StreamData")):oe.size>=4096?(oe.storage="fat",P[oe.start]===void 0&&(P[oe.start]=y(E,oe.start,P.fat_addrs,P.ssz)),P[oe.start].name=oe.name,oe.content=P[oe.start].data.slice(0,oe.size)):(oe.storage="minifat",oe.size<0?oe.size=0:U!==Z&&oe.start!==Z&&P[U]&&(oe.content=x(oe,P[U].data,(P[K]||{}).data))),oe.content&&ir(oe.content,0),F[fe]=oe,z.push(oe)}}function b(S,P){return new Date((or(S,P+4)/1e7*Math.pow(2,32)+or(S,P)/1e7-11644473600)*1e3)}function j(S,P){return u(),d(c.readFileSync(S),P)}function A(S,P){var E=P&&P.type;switch(E||Oe&&Buffer.isBuffer(S)&&(E="buffer"),E||"base64"){case"file":return j(S,P);case"base64":return d(Mr(Cn(S)),P);case"binary":return d(Mr(S),P)}return d(S,P)}function k(S,P){var E=P||{},C=E.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=C+"/",S.FileIndex[0]={name:C,type:5}),E.CLSID&&(S.FileIndex[0].clsid=E.CLSID),D(S)}function D(S){var P="Sh33tJ5";if(!ze.find(S,"/"+P)){var E=G(4);E[0]=55,E[1]=E[3]=50,E[2]=54,S.FileIndex.push({name:P,type:2,content:E,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+P),_(S)}}function _(S,P){k(S);for(var E=!1,C=!1,O=S.FullPaths.length-1;O>=0;--O){var F=S.FileIndex[O];switch(F.type){case 0:C?E=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(F.R*F.L*F.C)&&(E=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!P)){var z=new Date(1987,1,19),K=0,U=Object.create?Object.create(null):{},W=[];for(O=0;O<S.FullPaths.length;++O)U[S.FullPaths[O]]=!0,S.FileIndex[O].type!==0&&W.push([S.FullPaths[O],S.FileIndex[O]]);for(O=0;O<W.length;++O){var V=n(W[O][0]);C=U[V],C||(W.push([V,{name:a(V).replace("/",""),type:1,clsid:we,ct:z,mt:z,content:null}]),U[V]=!0)}for(W.sort(function(fe,ne){return r(fe[0],ne[0])}),S.FullPaths=[],S.FileIndex=[],O=0;O<W.length;++O)S.FullPaths[O]=W[O][0],S.FileIndex[O]=W[O][1];for(O=0;O<W.length;++O){var ee=S.FileIndex[O],ie=S.FullPaths[O];if(ee.name=a(ie).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||we,O===0)ee.C=W.length>1?1:-1,ee.size=0,ee.type=5;else if(ie.slice(-1)=="/"){for(K=O+1;K<W.length&&n(S.FullPaths[K])!=ie;++K);for(ee.C=K>=W.length?-1:K,K=O+1;K<W.length&&n(S.FullPaths[K])!=n(ie);++K);ee.R=K>=W.length?-1:K,ee.type=1}else n(S.FullPaths[O+1]||"")==n(ie)&&(ee.R=O+1),ee.type=2}}}function N(S,P){var E=P||{};if(E.fileType=="mad")return Ly(S,E);switch(_(S),E.fileType){case"zip":return Cy(S,E)}var C=function(fe){for(var ne=0,oe=0,Se=0;Se<fe.FileIndex.length;++Se){var Ye=fe.FileIndex[Se];if(Ye.content){var Je=Ye.content.length;Je>0&&(Je<4096?ne+=Je+63>>6:oe+=Je+511>>9)}}for(var Ft=fe.FullPaths.length+3>>2,oi=ne+7>>3,ci=ne+127>>7,ui=oi+oe+Ft+ci,pa=ui+127>>7,du=pa<=109?0:Math.ceil((pa-109)/127);ui+pa+du+127>>7>pa;)du=++pa<=109?0:Math.ceil((pa-109)/127);var fn=[1,du,pa,ci,Ft,oe,ne,0];return fe.FileIndex[0].size=ne<<6,fn[7]=(fe.FileIndex[0].start=fn[0]+fn[1]+fn[2]+fn[3]+fn[4]+fn[5])+(fn[6]+7>>3),fn}(S),O=G(C[7]<<9),F=0,z=0;{for(F=0;F<8;++F)O.write_shift(1,ce[F]);for(F=0;F<8;++F)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),F=0;F<3;++F)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,C[2]),O.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:Z),O.write_shift(4,C[3]),O.write_shift(-4,C[1]?C[0]-1:Z),O.write_shift(4,C[1]),F=0;F<109;++F)O.write_shift(-4,F<C[2]?C[1]+F:-1)}if(C[1])for(z=0;z<C[1];++z){for(;F<236+z*127;++F)O.write_shift(-4,F<C[2]?C[1]+F:-1);O.write_shift(-4,z===C[1]-1?Z:z+1)}var K=function(fe){for(z+=fe;F<z-1;++F)O.write_shift(-4,F+1);fe&&(++F,O.write_shift(-4,Z))};for(z=F=0,z+=C[1];F<z;++F)O.write_shift(-4,pe.DIFSECT);for(z+=C[2];F<z;++F)O.write_shift(-4,pe.FATSECT);K(C[3]),K(C[4]);for(var U=0,W=0,V=S.FileIndex[0];U<S.FileIndex.length;++U)V=S.FileIndex[U],V.content&&(W=V.content.length,!(W<4096)&&(V.start=z,K(W+511>>9)));for(K(C[6]+7>>3);O.l&511;)O.write_shift(-4,pe.ENDOFCHAIN);for(z=F=0,U=0;U<S.FileIndex.length;++U)V=S.FileIndex[U],V.content&&(W=V.content.length,!(!W||W>=4096)&&(V.start=z,K(W+63>>6)));for(;O.l&511;)O.write_shift(-4,pe.ENDOFCHAIN);for(F=0;F<C[4]<<2;++F){var ee=S.FullPaths[F];if(!ee||ee.length===0){for(U=0;U<17;++U)O.write_shift(4,0);for(U=0;U<3;++U)O.write_shift(4,-1);for(U=0;U<12;++U)O.write_shift(4,0);continue}V=S.FileIndex[F],F===0&&(V.start=V.size?V.start-1:Z);var ie=F===0&&E.root||V.name;if(W=2*(ie.length+1),O.write_shift(64,ie,"utf16le"),O.write_shift(2,W),O.write_shift(1,V.type),O.write_shift(1,V.color),O.write_shift(-4,V.L),O.write_shift(-4,V.R),O.write_shift(-4,V.C),V.clsid)O.write_shift(16,V.clsid,"hex");else for(U=0;U<4;++U)O.write_shift(4,0);O.write_shift(4,V.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,V.start),O.write_shift(4,V.size),O.write_shift(4,0)}for(F=1;F<S.FileIndex.length;++F)if(V=S.FileIndex[F],V.size>=4096)if(O.l=V.start+1<<9,Oe&&Buffer.isBuffer(V.content))V.content.copy(O,O.l,0,V.size),O.l+=V.size+511&-512;else{for(U=0;U<V.size;++U)O.write_shift(1,V.content[U]);for(;U&511;++U)O.write_shift(1,0)}for(F=1;F<S.FileIndex.length;++F)if(V=S.FileIndex[F],V.size>0&&V.size<4096)if(Oe&&Buffer.isBuffer(V.content))V.content.copy(O,O.l,0,V.size),O.l+=V.size+63&-64;else{for(U=0;U<V.size;++U)O.write_shift(1,V.content[U]);for(;U&63;++U)O.write_shift(1,0)}if(Oe)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function B(S,P){var E=S.FullPaths.map(function(U){return U.toUpperCase()}),C=E.map(function(U){var W=U.split("/");return W[W.length-(U.slice(-1)=="/"?2:1)]}),O=!1;P.charCodeAt(0)===47?(O=!0,P=E[0].slice(0,-1)+P):O=P.indexOf("/")!==-1;var F=P.toUpperCase(),z=O===!0?E.indexOf(F):C.indexOf(F);if(z!==-1)return S.FileIndex[z];var K=!F.match(po);for(F=F.replace(Ui,""),K&&(F=F.replace(po,"!")),z=0;z<E.length;++z)if((K?E[z].replace(po,"!"):E[z]).replace(Ui,"")==F||(K?C[z].replace(po,"!"):C[z]).replace(Ui,"")==F)return S.FileIndex[z];return null}var q=64,Z=-2,_e="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(S,P,E){u();var C=N(S,E);c.writeFileSync(P,C)}function re(S){for(var P=new Array(S.length),E=0;E<S.length;++E)P[E]=String.fromCharCode(S[E]);return P.join("")}function xe(S,P){var E=N(S,P);switch(P&&P.type||"buffer"){case"file":return u(),c.writeFileSync(P.filename,E),E;case"binary":return typeof E=="string"?E:re(E);case"base64":return gl(typeof E=="string"?E:re(E));case"buffer":if(Oe)return Buffer.isBuffer(E)?E:Fn(E);case"array":return typeof E=="string"?Mr(E):E}return E}var Ee;function R(S){try{var P=S.InflateRaw,E=new P;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)Ee=S;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function H(S,P){if(!Ee)return rh(S,P);var E=Ee.InflateRaw,C=new E,O=C._processChunk(S.slice(S.l),C._finishFlushFlag);return S.l+=C.bytesRead,O}function M(S){return Ee?Ee.deflateRawSync(S):Yf(S)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(S){var P=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(P>>16|P>>8|P)&255}for(var me=typeof Uint8Array<"u",le=me?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)le[Fe]=ge(Fe);function I(S,P){var E=le[S&255];return P<=8?E>>>8-P:(E=E<<8|le[S>>8&255],P<=16?E>>>16-P:(E=E<<8|le[S>>16&255],E>>>24-P))}function ye(S,P){var E=P&7,C=P>>>3;return(S[C]|(E<=6?0:S[C+1]<<8))>>>E&3}function ve(S,P){var E=P&7,C=P>>>3;return(S[C]|(E<=5?0:S[C+1]<<8))>>>E&7}function Pt(S,P){var E=P&7,C=P>>>3;return(S[C]|(E<=4?0:S[C+1]<<8))>>>E&15}function De(S,P){var E=P&7,C=P>>>3;return(S[C]|(E<=3?0:S[C+1]<<8))>>>E&31}function de(S,P){var E=P&7,C=P>>>3;return(S[C]|(E<=1?0:S[C+1]<<8))>>>E&127}function Ot(S,P,E){var C=P&7,O=P>>>3,F=(1<<E)-1,z=S[O]>>>C;return E<8-C||(z|=S[O+1]<<8-C,E<16-C)||(z|=S[O+2]<<16-C,E<24-C)||(z|=S[O+3]<<24-C),z&F}function ut(S,P,E){var C=P&7,O=P>>>3;return C<=5?S[O]|=(E&7)<<C:(S[O]|=E<<C&255,S[O+1]=(E&7)>>8-C),P+3}function xa(S,P,E){var C=P&7,O=P>>>3;return E=(E&1)<<C,S[O]|=E,P+1}function Ka(S,P,E){var C=P&7,O=P>>>3;return E<<=C,S[O]|=E&255,E>>>=8,S[O+1]=E,P+8}function Xf(S,P,E){var C=P&7,O=P>>>3;return E<<=C,S[O]|=E&255,E>>>=8,S[O+1]=E&255,S[O+2]=E>>>8,P+16}function lu(S,P){var E=S.length,C=2*E>P?2*E:P+5,O=0;if(E>=P)return S;if(Oe){var F=Yx(C);if(S.copy)S.copy(F);else for(;O<S.length;++O)F[O]=S[O];return F}else if(me){var z=new Uint8Array(C);if(z.set)z.set(S);else for(;O<E;++O)z[O]=S[O];return z}return S.length=C,S}function Xr(S){for(var P=new Array(S),E=0;E<S;++E)P[E]=0;return P}function Ul(S,P,E){var C=1,O=0,F=0,z=0,K=0,U=S.length,W=me?new Uint16Array(32):Xr(32);for(F=0;F<32;++F)W[F]=0;for(F=U;F<E;++F)S[F]=0;U=S.length;var V=me?new Uint16Array(U):Xr(U);for(F=0;F<U;++F)W[O=S[F]]++,C<O&&(C=O),V[F]=0;for(W[0]=0,F=1;F<=C;++F)W[F+16]=K=K+W[F-1]<<1;for(F=0;F<U;++F)K=S[F],K!=0&&(V[F]=W[K+16]++);var ee=0;for(F=0;F<U;++F)if(ee=S[F],ee!=0)for(K=I(V[F],C)>>C-ee,z=(1<<C+4-ee)-1;z>=0;--z)P[K|z<<ee]=ee&15|F<<4;return C}var ou=me?new Uint16Array(512):Xr(512),cu=me?new Uint16Array(32):Xr(32);if(!me){for(var ma=0;ma<512;++ma)ou[ma]=0;for(ma=0;ma<32;++ma)cu[ma]=0}(function(){for(var S=[],P=0;P<32;P++)S.push(5);Ul(S,cu,32);var E=[];for(P=0;P<=143;P++)E.push(8);for(;P<=255;P++)E.push(9);for(;P<=279;P++)E.push(7);for(;P<=287;P++)E.push(8);Ul(E,ou,288)})();var jy=function(){for(var P=me?new Uint8Array(32768):[],E=0,C=0;E<ue.length-1;++E)for(;C<ue[E+1];++C)P[C]=E;for(;C<32768;++C)P[C]=29;var O=me?new Uint8Array(259):[];for(E=0,C=0;E<X.length-1;++E)for(;C<X[E+1];++C)O[C]=E;function F(K,U){for(var W=0;W<K.length;){var V=Math.min(65535,K.length-W),ee=W+V==K.length;for(U.write_shift(1,+ee),U.write_shift(2,V),U.write_shift(2,~V&65535);V-- >0;)U[U.l++]=K[W++]}return U.l}function z(K,U){for(var W=0,V=0,ee=me?new Uint16Array(32768):[];V<K.length;){var ie=Math.min(65535,K.length-V);if(ie<10){for(W=ut(U,W,+(V+ie==K.length)),W&7&&(W+=8-(W&7)),U.l=W/8|0,U.write_shift(2,ie),U.write_shift(2,~ie&65535);ie-- >0;)U[U.l++]=K[V++];W=U.l*8;continue}W=ut(U,W,+(V+ie==K.length)+2);for(var fe=0;ie-- >0;){var ne=K[V];fe=(fe<<5^ne)&32767;var oe=-1,Se=0;if((oe=ee[fe])&&(oe|=V&-32768,oe>V&&(oe-=32768),oe<V))for(;K[oe+Se]==K[V+Se]&&Se<250;)++Se;if(Se>2){ne=O[Se],ne<=22?W=Ka(U,W,le[ne+1]>>1)-1:(Ka(U,W,3),W+=5,Ka(U,W,le[ne-23]>>5),W+=3);var Ye=ne<8?0:ne-4>>2;Ye>0&&(Xf(U,W,Se-X[ne]),W+=Ye),ne=P[V-oe],W=Ka(U,W,le[ne]>>3),W-=3;var Je=ne<4?0:ne-2>>1;Je>0&&(Xf(U,W,V-oe-ue[ne]),W+=Je);for(var Ft=0;Ft<Se;++Ft)ee[fe]=V&32767,fe=(fe<<5^K[V])&32767,++V;ie-=Se-1}else ne<=143?ne=ne+48:W=xa(U,W,1),W=Ka(U,W,le[ne]),ee[fe]=V&32767,++V}W=Ka(U,W,0)-1}return U.l=(W+7)/8|0,U.l}return function(U,W){return U.length<8?F(U,W):z(U,W)}}();function Yf(S){var P=G(50+Math.floor(S.length*1.1)),E=jy(S,P);return P.slice(0,E)}var Jf=me?new Uint16Array(32768):Xr(32768),Qf=me?new Uint16Array(32768):Xr(32768),Zf=me?new Uint16Array(128):Xr(128),eh=1,th=1;function Ey(S,P){var E=De(S,P)+257;P+=5;var C=De(S,P)+1;P+=5;var O=Pt(S,P)+4;P+=4;for(var F=0,z=me?new Uint8Array(19):Xr(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],U=1,W=me?new Uint8Array(8):Xr(8),V=me?new Uint8Array(8):Xr(8),ee=z.length,ie=0;ie<O;++ie)z[L[ie]]=F=ve(S,P),U<F&&(U=F),W[F]++,P+=3;var fe=0;for(W[0]=0,ie=1;ie<=U;++ie)V[ie]=fe=fe+W[ie-1]<<1;for(ie=0;ie<ee;++ie)(fe=z[ie])!=0&&(K[ie]=V[fe]++);var ne=0;for(ie=0;ie<ee;++ie)if(ne=z[ie],ne!=0){fe=le[K[ie]]>>8-ne;for(var oe=(1<<7-ne)-1;oe>=0;--oe)Zf[fe|oe<<ne]=ne&7|ie<<3}var Se=[];for(U=1;Se.length<E+C;)switch(fe=Zf[de(S,P)],P+=fe&7,fe>>>=3){case 16:for(F=3+ye(S,P),P+=2,fe=Se[Se.length-1];F-- >0;)Se.push(fe);break;case 17:for(F=3+ve(S,P),P+=3;F-- >0;)Se.push(0);break;case 18:for(F=11+de(S,P),P+=7;F-- >0;)Se.push(0);break;default:Se.push(fe),U<fe&&(U=fe);break}var Ye=Se.slice(0,E),Je=Se.slice(E);for(ie=E;ie<286;++ie)Ye[ie]=0;for(ie=C;ie<30;++ie)Je[ie]=0;return eh=Ul(Ye,Jf,286),th=Ul(Je,Qf,30),P}function Ty(S,P){if(S[0]==3&&!(S[1]&3))return[Ma(P),2];for(var E=0,C=0,O=Yx(P||1<<18),F=0,z=O.length>>>0,K=0,U=0;!(C&1);){if(C=ve(S,E),E+=3,C>>>1)C>>1==1?(K=9,U=5):(E=Ey(S,E),K=eh,U=th);else{E&7&&(E+=8-(E&7));var W=S[E>>>3]|S[(E>>>3)+1]<<8;if(E+=32,W>0)for(!P&&z<F+W&&(O=lu(O,F+W),z=O.length);W-- >0;)O[F++]=S[E>>>3],E+=8;continue}for(;;){!P&&z<F+32767&&(O=lu(O,F+32767),z=O.length);var V=Ot(S,E,K),ee=C>>>1==1?ou[V]:Jf[V];if(E+=ee&15,ee>>>=4,!(ee>>>8&255))O[F++]=ee;else{if(ee==256)break;ee-=257;var ie=ee<8?0:ee-4>>2;ie>5&&(ie=0);var fe=F+X[ee];ie>0&&(fe+=Ot(S,E,ie),E+=ie),V=Ot(S,E,U),ee=C>>>1==1?cu[V]:Qf[V],E+=ee&15,ee>>>=4;var ne=ee<4?0:ee-2>>1,oe=ue[ee];for(ne>0&&(oe+=Ot(S,E,ne),E+=ne),!P&&z<fe&&(O=lu(O,fe+100),z=O.length);F<fe;)O[F]=O[F-oe],++F}}}return P?[O,E+7>>>3]:[O.slice(0,F),E+7>>>3]}function rh(S,P){var E=S.slice(S.l||0),C=Ty(E,P);return S.l+=C[1],C[0]}function nh(S,P){if(S)typeof console<"u"&&console.error(P);else throw new Error(P)}function ah(S,P){var E=S;ir(E,0);var C=[],O=[],F={FileIndex:C,FullPaths:O};k(F,{root:P.root});for(var z=E.length-4;(E[z]!=80||E[z+1]!=75||E[z+2]!=5||E[z+3]!=6)&&z>=0;)--z;E.l=z+4,E.l+=4;var K=E.read_shift(2);E.l+=6;var U=E.read_shift(4);for(E.l=U,z=0;z<K;++z){E.l+=20;var W=E.read_shift(4),V=E.read_shift(4),ee=E.read_shift(2),ie=E.read_shift(2),fe=E.read_shift(2);E.l+=8;var ne=E.read_shift(4),oe=o(E.slice(E.l+ee,E.l+ee+ie));E.l+=ee+ie+fe;var Se=E.l;E.l=ne+4,Ny(E,W,V,F,oe),E.l=Se}return F}function Ny(S,P,E,C,O){S.l+=2;var F=S.read_shift(2),z=S.read_shift(2),K=i(S);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var U=S.read_shift(4),W=S.read_shift(4),V=S.read_shift(4),ee=S.read_shift(2),ie=S.read_shift(2),fe="",ne=0;ne<ee;++ne)fe+=String.fromCharCode(S[S.l++]);if(ie){var oe=o(S.slice(S.l,S.l+ie));(oe[21589]||{}).mt&&(K=oe[21589].mt),((O||{})[21589]||{}).mt&&(K=O[21589].mt)}S.l+=ie;var Se=S.slice(S.l,S.l+W);switch(z){case 8:Se=H(S,V);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var Ye=!1;F&8&&(U=S.read_shift(4),U==134695760&&(U=S.read_shift(4),Ye=!0),W=S.read_shift(4),V=S.read_shift(4)),W!=P&&nh(Ye,"Bad compressed size: "+P+" != "+W),V!=E&&nh(Ye,"Bad uncompressed size: "+E+" != "+V),uu(C,fe,Se,{unsafe:!0,mt:K})}function Cy(S,P){var E=P||{},C=[],O=[],F=G(1),z=E.compression?8:0,K=0,U=0,W=0,V=0,ee=0,ie=S.FullPaths[0],fe=ie,ne=S.FileIndex[0],oe=[],Se=0;for(U=1;U<S.FullPaths.length;++U)if(fe=S.FullPaths[U].slice(ie.length),ne=S.FileIndex[U],!(!ne.size||!ne.content||fe=="Sh33tJ5")){var Ye=V,Je=G(fe.length);for(W=0;W<fe.length;++W)Je.write_shift(1,fe.charCodeAt(W)&127);Je=Je.slice(0,Je.l),oe[ee]=Qj.buf(ne.content,0);var Ft=ne.content;z==8&&(Ft=M(Ft)),F=G(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,K),F.write_shift(2,z),ne.mt?s(F,ne.mt):F.write_shift(4,0),F.write_shift(-4,oe[ee]),F.write_shift(4,Ft.length),F.write_shift(4,ne.content.length),F.write_shift(2,Je.length),F.write_shift(2,0),V+=F.length,C.push(F),V+=Je.length,C.push(Je),V+=Ft.length,C.push(Ft),F=G(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,K),F.write_shift(2,z),F.write_shift(4,0),F.write_shift(-4,oe[ee]),F.write_shift(4,Ft.length),F.write_shift(4,ne.content.length),F.write_shift(2,Je.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Ye),Se+=F.l,O.push(F),Se+=Je.length,O.push(Je),++ee}return F=G(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ee),F.write_shift(2,ee),F.write_shift(4,Se),F.write_shift(4,V),F.write_shift(2,0),jt([jt(C),jt(O),F])}var $l={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ay(S,P){if(S.ctype)return S.ctype;var E=S.name||"",C=E.match(/\.([^\.]+)$/);return C&&$l[C[1]]||P&&(C=(E=P).match(/[\.\\]([^\.\\])+$/),C&&$l[C[1]])?$l[C[1]]:"application/octet-stream"}function Py(S){for(var P=gl(S),E=[],C=0;C<P.length;C+=76)E.push(P.slice(C,C+76));return E.join(`\r
`)+`\r
`}function Oy(S){var P=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var V=W.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],C=P.split(`\r
`),O=0;O<C.length;++O){var F=C[O];if(F.length==0){E.push("");continue}for(var z=0;z<F.length;){var K=76,U=F.slice(z,z+K);U.charAt(K-1)=="="?K--:U.charAt(K-2)=="="?K-=2:U.charAt(K-3)=="="&&(K-=3),U=F.slice(z,z+K),z+=K,z<F.length&&(U+="="),E.push(U)}}return E.join(`\r
`)}function Fy(S){for(var P=[],E=0;E<S.length;++E){for(var C=S[E];E<=S.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+S[++E];P.push(C)}for(var O=0;O<P.length;++O)P[O]=P[O].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Mr(P.join(`\r
`))}function Dy(S,P,E){for(var C="",O="",F="",z,K=0;K<10;++K){var U=P[K];if(!U||U.match(/^\s*$/))break;var W=U.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":C=W[2].trim();break;case"content-type":F=W[2].trim();break;case"content-transfer-encoding":O=W[2].trim();break}}switch(++K,O.toLowerCase()){case"base64":z=Mr(Cn(P.slice(K).join("")));break;case"quoted-printable":z=Fy(P.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var V=uu(S,C.slice(E.length),z,{unsafe:!0});F&&(V.ctype=F)}function Ry(S,P){if(re(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=P&&P.root||"",C=(Oe&&Buffer.isBuffer(S)?S.toString("binary"):re(S)).split(`\r
`),O=0,F="";for(O=0;O<C.length;++O)if(F=C[O],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),E||(E=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),F.slice(0,E.length)!=E););var z=(C[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var K="--"+(z[1]||""),U=[],W=[],V={FileIndex:U,FullPaths:W};k(V);var ee,ie=0;for(O=0;O<C.length;++O){var fe=C[O];fe!==K&&fe!==K+"--"||(ie++&&Dy(V,C.slice(ee,O),E),ee=O)}return V}function Ly(S,P){var E=P||{},C=E.boundary||"SheetJS";C="------="+C;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],F=S.FullPaths[0],z=F,K=S.FileIndex[0],U=1;U<S.FullPaths.length;++U)if(z=S.FullPaths[U].slice(F.length),K=S.FileIndex[U],!(!K.size||!K.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Se){return"_x"+Se.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Se){return"_u"+Se.charCodeAt(0).toString(16)+"_"});for(var W=K.content,V=Oe&&Buffer.isBuffer(W)?W.toString("binary"):re(W),ee=0,ie=Math.min(1024,V.length),fe=0,ne=0;ne<=ie;++ne)(fe=V.charCodeAt(ne))>=32&&fe<128&&++ee;var oe=ee>=ie*4/5;O.push(C),O.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+z),O.push("Content-Transfer-Encoding: "+(oe?"quoted-printable":"base64")),O.push("Content-Type: "+Ay(K,z)),O.push(""),O.push(oe?Oy(V):Py(V))}return O.push(C+`--\r
`),O.join(`\r
`)}function My(S){var P={};return k(P,S),P}function uu(S,P,E,C){var O=C&&C.unsafe;O||k(S);var F=!O&&ze.find(S,P);if(!F){var z=S.FullPaths[0];P.slice(0,z.length)==z?z=P:(z.slice(-1)!="/"&&(z+="/"),z=(z+P).replace("//","/")),F={name:a(P),type:2},S.FileIndex.push(F),S.FullPaths.push(z),O||ze.utils.cfb_gc(S)}return F.content=E,F.size=E?E.length:0,C&&(C.CLSID&&(F.clsid=C.CLSID),C.mt&&(F.mt=C.mt),C.ct&&(F.ct=C.ct)),F}function Iy(S,P){k(S);var E=ze.find(S,P);if(E){for(var C=0;C<S.FileIndex.length;++C)if(S.FileIndex[C]==E)return S.FileIndex.splice(C,1),S.FullPaths.splice(C,1),!0}return!1}function By(S,P,E){k(S);var C=ze.find(S,P);if(C){for(var O=0;O<S.FileIndex.length;++O)if(S.FileIndex[O]==C)return S.FileIndex[O].name=a(E),S.FullPaths[O]=E,!0}return!1}function Uy(S){_(S,!0)}return t.find=B,t.read=A,t.parse=d,t.write=xe,t.writeFile=Q,t.utils={cfb_new:My,cfb_add:uu,cfb_del:Iy,cfb_mov:By,cfb_gc:Uy,ReadShift:zi,CheckField:Sv,prep_blob:ir,bconcat:jt,use_zlib:R,_deflateRaw:Yf,_inflateRaw:rh,consts:pe},t}();function Zj(e){return typeof e=="string"?Zc(e):Array.isArray(e)?jj(e):e}function Rl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Zc(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?yl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Zj(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Dl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function At(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function am(e,t){for(var r=[],n=At(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Af(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ru(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function eE(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var vc=new Date(1899,11,30,0,0,0);function rr(e,t){var r=e.getTime(),n=vc.getTime()+(e.getTimezoneOffset()-vc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var iv=new Date,tE=vc.getTime()+(iv.getTimezoneOffset()-vc.getTimezoneOffset())*6e4,sm=iv.getTimezoneOffset();function lv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+tE),t.getTimezoneOffset()!==sm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sm)*6e4),t}var im=new Date("2017-02-19T19:06:09.000Z"),ov=isNaN(im.getFullYear())?new Date("2/19/17"):im,rE=ov.getFullYear()==2017;function Vt(e,t){var r=new Date(e);if(rE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ov.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function nu(e,t){if(Oe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function nr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=nr(e[r]));return t}function rt(e,t){for(var r="";r.length<t;)r+=e;return r}function bn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var nE=["january","february","march","april","may","june","july","august","september","october","november","december"];function vl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&nE.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function je(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Oe?n=Fn(r):n=Ej(r),ze.utils.cfb_add(e,t,n)}ze.utils.cfb_add(e,t,r)}else e.file(t,r)}function Pf(){return ze.utils.cfb_new()}var ct=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,aE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Of=Af(aE),Ff=/[&<>'"]/g,sE=/[\u0000-\u0008\u000b-\u001f]/g;function Ie(e){var t=e+"";return t.replace(Ff,function(r){return Of[r]}).replace(sE,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lm(e){return Ie(e).replace(/ /g,"_x0020_")}var cv=/[\u0000-\u001f]/g;function iE(e){var t=e+"";return t.replace(Ff,function(r){return Of[r]}).replace(/\n/g,"<br/>").replace(cv,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function lE(e){var t=e+"";return t.replace(Ff,function(r){return Of[r]}).replace(cv,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function oE(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function cE(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yu(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function om(e){var t=Ma(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function cm(e){return Fn(e,"binary").toString("utf8")}var vo="foo bar baz",$i=Oe&&(cm(vo)==Yu(vo)&&cm||om(vo)==Yu(vo)&&om)||Yu,yl=Oe?function(e){return Fn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),uv=/(^\s|\s$|\n)/;function Et(e,t){return"<"+e+(t.match(uv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function wl(e){return At(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ae(e,t,r){return"<"+e+(r!=null?wl(r):"")+(t!=null?(t.match(uv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function md(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function dE(e,t){switch(typeof e){case"string":var r=ae("vt:lpwstr",Ie(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ae((e|0)==e?"vt:i4":"vt:r8",Ie(String(e)));case"boolean":return ae("vt:bool",e?"true":"false")}if(e instanceof Date)return ae("vt:filetime",md(e));throw new Error("Unable to serialize "+e)}var gt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ai=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],lr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function fE(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function hE(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var um=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},dm=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Fn(t)})):um(e)}:um,fm=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ti(e,a)));return n.join("").replace(Ui,"")},Df=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ui,""):fm(e,t,r)}:fm,hm=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},dv=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):hm(e,t,r)}:hm,xm=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(cs(e,a)));return n.join("")},Ll=Oe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xm(t,r,n)}:xm,fv=function(e,t){var r=or(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},hv=fv,xv=function(e,t){var r=or(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},mv=xv,pv=function(e,t){var r=2*or(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},gv=pv,vv=function(t,r){var n=or(t,r);return n>0?Df(t,r+4,r+4+n):""},yv=vv,wv=function(e,t){var r=or(e,t);return r>0?Ll(e,t+4,t+4+r):""},_v=wv,bv=function(e,t){return fE(e,t)},yc=bv,Rf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Oe&&(hv=function(t,r){if(!Buffer.isBuffer(t))return fv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mv=function(t,r){if(!Buffer.isBuffer(t))return xv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},gv=function(t,r){if(!Buffer.isBuffer(t))return pv(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},yv=function(t,r){if(!Buffer.isBuffer(t))return vv(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},_v=function(t,r){if(!Buffer.isBuffer(t))return wv(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):bv(t,r)},Rf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var cs=function(e,t){return e[t]},Ti=function(e,t){return e[t+1]*256+e[t]},xE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},or=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ja=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},mE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function zi(e,t){var r="",n,a,s=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Oe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ti(this,u)),u+=2;e*=2;break;case"utf8":r=Ll(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Df(this,this.l,this.l+e);break;case"wstr":return zi.call(this,e,"dbcs");case"lpstr-ansi":r=hv(this,this.l),e=4+or(this,this.l);break;case"lpstr-cp":r=mv(this,this.l),e=4+or(this,this.l);break;case"lpwstr":r=gv(this,this.l),e=4+2*or(this,this.l);break;case"lpp4":e=4+or(this,this.l),r=yv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+or(this,this.l),r=_v(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=cs(this,this.l+e++))!==0;)s.push(mo(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Ti(this,this.l+e))!==0;)s.push(mo(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=cs(this,u),this.l=u+1,o=zi.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mo(Ti(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=cs(this,u),this.l=u+1,o=zi.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mo(cs(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=cs(this,this.l),this.l++,n;case 2:return n=(t==="i"?xE:Ti)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ja:mE)(this,this.l),this.l+=4,n):(a=or(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=yc(this,this.l):a=yc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=dv(this,this.l,e);break}}return this.l+=e,r}var pE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},gE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},vE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function yE(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)vE(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,pE(this,t,this.l);break;case 8:if(n=8,r==="f"){hE(this,t,this.l);break}case 16:break;case-4:n=4,gE(this,t,this.l);break}return this.l+=n,this}function Sv(e,t){var r=dv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ir(e,t){e.l=t,e.read_shift=zi,e.chk=Sv,e.write_shift=yE}function un(e,t){e.l+=t}function G(e){var t=Ma(e);return ir(t,0),t}function tr(){var e=[],t=Oe?256:2048,r=function(u){var d=G(u);return ir(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),jt(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function J(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=fC[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Rf(r)&&e.push(r)}}function Wi(e,t,r){var n=nr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function mm(e,t,r){var n=nr(e);return n.s=Wi(n.s,t.s,r),n.e=Wi(n.e,t.s,r),n}function Hi(e,t){if(e.cRel&&e.c<0)for(e=nr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=nr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=bE(r)),!e.rRel&&e.rRel!=null&&(r=wE(r)),r}function Ju(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mt(e.s.c)+":"+(e.e.cRel?"":"$")+Mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nt(e.s.r)+":"+(e.e.rRel?"":"$")+Nt(e.e.r):Hi(e.s,t.biff)+":"+Hi(e.e,t.biff)}function Lf(e){return parseInt(_E(e),10)-1}function Nt(e){return""+(e+1)}function wE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _E(e){return e.replace(/\$(\d+)$/,"$1")}function Mf(e){for(var t=SE(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bE(e){return e.replace(/^([A-Z])/,"$$$1")}function SE(e){return e.replace(/^\$([A-Z])/,"$1")}function kE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fr(e){var t=e.indexOf(":");return t==-1?{s:vt(e),e:vt(e)}:{s:vt(e.slice(0,t)),e:vt(e.slice(t+1))}}function ot(e,t){return typeof t>"u"||typeof t=="number"?ot(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function pm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ia(e.z,r?rr(t):t)}catch{}try{return e.w=ia((e.XF||{}).numFmtId||(r?14:0),r?rr(t):t)}catch{return""+t}}function An(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ml[e.v]||e.v:t==null?pm(e,e.v):pm(e,t))}function Wa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function kv(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?vt(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=qe(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},v=i+f,x=o+h;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||at[14],n.cellDates?(m.t="d",m.w=ia(m.z,rr(m.v))):(m.t="n",m.v=rr(m.v),m.w=ia(m.z,m.v))):m.t="s";if(a)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(m.z=s[v][x].z),s[v][x]=m;else{var w=Ue({c:x,r:v});s[w]&&s[w].z&&(m.z=s[w].z),s[w]=m}}}return u.s.c<1e7&&(s["!ref"]=ot(u)),s}function si(e,t){return kv(null,e,t)}function jE(e){return e.read_shift(4,"i")}function Wr(e,t){return t||(t=G(4)),t.write_shift(4,e),t}function It(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yt(e,t){var r=!1;return t==null&&(r=!0,t=G(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function EE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function TE(e,t){return t||(t=G(4)),t.write_shift(2,0),t.write_shift(2,0),t}function If(e,t){var r=e.l,n=e.read_shift(1),a=It(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(EE(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function NE(e,t){var r=!1;return t==null&&(r=!0,t=G(15+4*e.t.length)),t.write_shift(1,0),yt(e.t,t),r?t.slice(0,t.l):t}var CE=If;function AE(e,t){var r=!1;return t==null&&(r=!0,t=G(23+4*e.t.length)),t.write_shift(1,1),yt(e.t,t),t.write_shift(4,1),TE({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Nr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ha(e,t){return t==null&&(t=G(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Va(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ga(e,t){return t==null&&(t=G(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var PE=It,jv=yt;function Bf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wc(e,t){var r=!1;return t==null&&(r=!0,t=G(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var OE=It,pd=Bf,Uf=wc;function Ev(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?yc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ja(t,0)>>2;return r?a/100:a}function Tv(e,t){t==null&&(t=G(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Nv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function FE(e,t){return t||(t=G(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var qa=Nv,ii=FE;function li(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ia(e,t){return(t||G(8)).write_shift(8,e,"f")}function DE(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=WE[a];u&&(t.rgb=Tm(u));break;case 2:t.rgb=Tm([i,o,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function _c(e,t){if(t||(t=G(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function RE(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function LE(e,t){t||(t=G(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Cv=2,ar=3,yo=11,bc=19,wo=64,ME=65,IE=71,BE=4108,UE=4126,kt=80,gm={1:{n:"CodePage",t:Cv},2:{n:"Category",t:kt},3:{n:"PresentationFormat",t:kt},4:{n:"ByteCount",t:ar},5:{n:"LineCount",t:ar},6:{n:"ParagraphCount",t:ar},7:{n:"SlideCount",t:ar},8:{n:"NoteCount",t:ar},9:{n:"HiddenCount",t:ar},10:{n:"MultimediaClipCount",t:ar},11:{n:"ScaleCrop",t:yo},12:{n:"HeadingPairs",t:BE},13:{n:"TitlesOfParts",t:UE},14:{n:"Manager",t:kt},15:{n:"Company",t:kt},16:{n:"LinksUpToDate",t:yo},17:{n:"CharacterCount",t:ar},19:{n:"SharedDoc",t:yo},22:{n:"HyperlinksChanged",t:yo},23:{n:"AppVersion",t:ar,p:"version"},24:{n:"DigSig",t:ME},26:{n:"ContentType",t:kt},27:{n:"ContentStatus",t:kt},28:{n:"Language",t:kt},29:{n:"Version",t:kt},255:{},2147483648:{n:"Locale",t:bc},2147483651:{n:"Behavior",t:bc},1919054434:{}},vm={1:{n:"CodePage",t:Cv},2:{n:"Title",t:kt},3:{n:"Subject",t:kt},4:{n:"Author",t:kt},5:{n:"Keywords",t:kt},6:{n:"Comments",t:kt},7:{n:"Template",t:kt},8:{n:"LastAuthor",t:kt},9:{n:"RevNumber",t:kt},10:{n:"EditTime",t:wo},11:{n:"LastPrinted",t:wo},12:{n:"CreatedDate",t:wo},13:{n:"ModifiedDate",t:wo},14:{n:"PageCount",t:ar},15:{n:"WordCount",t:ar},16:{n:"CharCount",t:ar},17:{n:"Thumbnail",t:IE},18:{n:"Application",t:kt},19:{n:"DocSecurity",t:ar},255:{},2147483648:{n:"Locale",t:bc},2147483651:{n:"Behavior",t:bc},1919054434:{}};function $E(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var zE=$E([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),WE=nr(zE),Ml={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},HE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_o={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Av(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Pv(e,t){var r=eE(HE),n=[],a;n[n.length]=ct,n[n.length]=ae("Types",null,{xmlns:gt.CT,"xmlns:xsd":gt.xsd,"xmlns:xsi":gt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ae("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ae("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:_o[c][t.bookType]||_o[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ae("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:_o[c][t.bookType]||_o[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ae("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Pe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ov(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ds(e){var t=[ct,ae("Relationships",null,{xmlns:gt.RELS})];return At(e["!id"]).forEach(function(r){t[t.length]=ae("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Me(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Pe.HLINK,Pe.XPATH,Pe.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function VE(e){var t=[ct];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ym(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function GE(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function qE(e){var t=[ct];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ym(e[r][0],e[r][1])),t.push(GE("",e[r][0]));return t.push(ym("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Fv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xc.version+"</meta:generator></office:meta></office:document-meta>"}var Pa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Qu(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ie(t),n[n.length]=r?ae(e,t,r):Et(e,t))}function Dv(e,t){var r=t||{},n=[ct,ae("cp:coreProperties",null,{"xmlns:cp":gt.CORE_PROPS,"xmlns:dc":gt.dc,"xmlns:dcterms":gt.dcterms,"xmlns:dcmitype":gt.dcmitype,"xmlns:xsi":gt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Qu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:md(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Qu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:md(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Pa.length;++s){var i=Pa[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Qu(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Rs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Rv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Lv(e){var t=[],r=ae;return e||(e={}),e.Application="SheetJS",t[t.length]=ct,t[t.length]=ae("Properties",null,{xmlns:gt.EXT_PROPS,"xmlns:vt":gt.vt}),Rs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ie(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ie(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Mv(e){var t=[ct,ae("Properties",null,{xmlns:gt.CUST_PROPS,"xmlns:vt":gt.vt})];if(!e)return t.join("");var r=1;return At(e).forEach(function(a){++r,t[t.length]=ae("property",dE(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ie(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function KE(e,t){var r=[];return At(wm).map(function(n){for(var a=0;a<Pa.length;++a)if(Pa[a][1]==n)return Pa[a];for(a=0;a<Rs.length;++a)if(Rs[a][1]==n)return Rs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Et(wm[n[1]]||n[1],a))}}),ae("DocumentProperties",r.join(""),{xmlns:lr.o})}function XE(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&At(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Pa.length;++i)if(s==Pa[i][1])return;for(i=0;i<Rs.length;++i)if(s==Rs[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ae(lm(s),o,{"dt:dt":c}))}}),t&&At(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ae(lm(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+lr.o+'">'+a.join("")+"</"+n+">"}function YE(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=G(8);return i.write_shift(4,n),i.write_shift(4,a),i}function _m(e,t){var r=G(4),n=G(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=G(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=YE(t);break;case 31:case 80:for(n=G(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return jt([r,n])}var Iv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bm(e,t,r){var n=G(8),a=[],s=[],i=8,o=0,c=G(8),u=G(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),i+=8+c.length,!t){u=G(8),u.write_shift(4,0),a.unshift(u);var d=[G(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=G(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=jt(d),s.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Iv.indexOf(e[o][0])>-1||Rv.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var v=r[m];if(v.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=_m(v.t,h)}else{var w=JE(h);w==-1&&(w=31,h=String(h)),c=_m(w,h)}s.push(c),u=G(8),u.write_shift(4,t?m:2+o),a.push(u),i+=8+c.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),jt([n].concat(a).concat(s))}function Sm(e,t,r,n,a,s){var i=G(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,ze.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var c=bm(e,r,n);if(o.push(c),a){var u=bm(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(u)}return jt(o)}function QE(e,t){t||(t=G(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ZE(e,t){return e.read_shift(t)===1}function Wt(e,t){return t||(t=G(2)),t.write_shift(2,+!!e),t}function Bv(e){return e.read_shift(2,"u")}function gr(e,t){return t||(t=G(2)),t.write_shift(2,e),t}function Uv(e,t,r){return r||(r=G(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $v(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function eT(e){var t=e.t||"",r=G(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=G(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return jt(a)}function tT(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rT(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):tT(e,n,r)}function nT(e,t,r){if(r.biff>5)return rT(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zv(e,t,r){return r||(r=G(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function km(e,t){t||(t=G(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function aT(e){var t=G(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),km(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&km(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ba(e,t,r,n){return n||(n=G(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function sT(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function iT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Wv(e,t){return t||(t=G(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function $f(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=G(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function lT(e,t){var r=!t||t.biff==8,n=G(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function oT(e,t){var r=!t||t.biff>=8?2:1,n=G(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function cT(e,t){var r=G(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=eT(e[a]);var s=jt([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function uT(){var e=G(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function dT(e){var t=G(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function fT(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=G(a);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function hT(e,t,r,n){var a=G(10);return Ba(e,t,n,a),a.write_shift(4,r),a}function xT(e,t,r,n,a){var s=!a||a.biff==8,i=G(8+ +s+(1+s)*r.length);return Ba(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function mT(e,t,r,n){var a=r&&r.biff==5;n||(n=G(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function pT(e,t){var r=t.biff==8||!t.biff?4:2,n=G(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function jm(e,t,r,n){var a=r&&r.biff==5;n||(n=G(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function gT(e){var t=G(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function vT(e,t,r,n,a,s){var i=G(8);return Ba(e,t,n,i),Uv(r,s,i),i}function yT(e,t,r,n){var a=G(14);return Ba(e,t,n,a),Ia(r,a),a}function wT(e,t,r){if(r.biff<8)return _T(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(sT(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function _T(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=$v(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function bT(e){var t=G(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Wv(e[r],t);return t}function ST(e){var t=G(24),r=vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return jt([t,aT(e[1])])}function kT(e){var t=e[1].Tooltip,r=G(10+2*(t.length+1));r.write_shift(2,2048);var n=vt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function jT(e){return e||(e=G(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ET(e,t,r){if(!r.cellStyles)return un(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function TT(e,t){var r=G(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function NT(e){for(var t=G(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function CT(e,t,r){var n=G(15);return Bl(n,e,t),n.write_shift(8,r,"f"),n}function AT(e,t,r){var n=G(9);return Bl(n,e,t),n.write_shift(2,r),n}var PT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Af({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Ma(1);switch(c.type){case"base64":d=Mr(Cn(o));break;case"binary":d=Mr(o);break;case"buffer":case"array":d=o;break}ir(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,w=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(w=d.read_shift(2));var y=d.read_shift(2),p=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(p=e[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var g=[],b={},j=Math.min(d.length,f==2?521:w-10-(m?264:0)),A=v?32:11;d.l<j&&d[d.l]!=13;)switch(b={},b.name=ka.utils.decode(p,d.slice(d.l,d.l+A)).replace(/[\u0000\r\n].*$/g,""),d.l+=A,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!v&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&g.push(b),f!=2&&(d.l+=v?13:14),b.type){case"B":(!m||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var k=0,D=0;for(u[0]=[],D=0;D!=g.length;++D)u[0][D]=g[D].name;for(;x-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++k]=[],D=0,D=0;D!=g.length;++D){var _=d.slice(d.l,d.l+g[D].len);d.l+=g[D].len,ir(_,0);var N=ka.utils.decode(p,_);switch(g[D].type){case"C":N.trim().length&&(u[k][D]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[k][D]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[k][D]=N;break;case"F":u[k][D]=parseFloat(N.trim());break;case"+":case"I":u[k][D]=v?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[k][D]=!0;break;case"N":case"F":u[k][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][D]="##MEMO##"+(v?parseInt(N.trim(),10):_.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[k][D]=+N||0);break;case"@":u[k][D]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":u[k][D]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":u[k][D]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][D]=-_.read_shift(-8,"f");break;case"B":if(m&&g[D].len==8){u[k][D]=_.read_shift(8,"f");break}case"G":case"P":_.l+=g[D].len;break;case"0":if(g[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[D].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=g,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=si(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return Wa(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&pl(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=tr(),f=Tc(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),v=o["!cols"]||[],x=0,w=0,y=0,p=1;for(x=0;x<h.length;++x){if(((v[x]||{}).DBF||{}).name){h[x]=v[x].DBF.name,++y;continue}if(h[x]!=null){if(++y,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(w=0;w<1024;++w)if(h.indexOf(h[x]+"_"+w)==-1){h[x]+="_"+w;break}}}}var g=qe(o["!ref"]),b=[],j=[],A=[];for(x=0;x<=g.e.c-g.s.c;++x){var k="",D="",_=0,N=[];for(w=0;w<m.length;++w)m[w][x]!=null&&N.push(m[w][x]);if(N.length==0||h[x]==null){b[x]="?";continue}for(w=0;w<N.length;++w){switch(typeof N[w]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=N[w]instanceof Date?"D":"C";break;default:D="C"}_=Math.max(_,String(N[w]).length),k=k&&k!=D?"C":D}_>250&&(_=250),D=((v[x]||{}).DBF||{}).type,D=="C"&&v[x].DBF.len>_&&(_=v[x].DBF.len),k=="B"&&D=="N"&&(k="N",A[x]=v[x].DBF.dec,_=v[x].DBF.len),j[x]=k=="C"||D=="N"?_:s[k]||0,p+=j[x],b[x]=k}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,m.length),B.write_shift(2,296+32*y),B.write_shift(2,p),x=0;x<4;++x)B.write_shift(4,0);for(B.write_shift(4,0|(+t[V1]||3)<<8),x=0,w=0;x<h.length;++x)if(h[x]!=null){var q=d.next(32),Z=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,Z,"sbcs"),q.write_shift(1,b[x]=="?"?"C":b[x],"sbcs"),q.write_shift(4,w),q.write_shift(1,j[x]||s[b[x]]||0),q.write_shift(1,A[x]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),w+=j[x]||s[b[x]]||0}var _e=d.next(264);for(_e.write_shift(4,13),x=0;x<65;++x)_e.write_shift(4,0);for(x=0;x<m.length;++x){var ce=d.next(p);for(ce.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(b[w]){case"L":ce.write_shift(1,m[x][w]==null?63:m[x][w]?84:70);break;case"B":ce.write_shift(8,m[x][w]||0,"f");break;case"N":var we="0";for(typeof m[x][w]=="number"&&(we=m[x][w].toFixed(A[w]||0)),y=0;y<j[w]-we.length;++y)ce.write_shift(1,32);ce.write_shift(1,we,"sbcs");break;case"D":m[x][w]?(ce.write_shift(4,("0000"+m[x][w].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(m[x][w].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+m[x][w].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var pe=String(m[x][w]!=null?m[x][w]:"").slice(0,j[w]);for(ce.write_shift(1,pe,"sbcs"),y=0;y<j[w]-pe.length;++y)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),OT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+At(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var v=e[m];return typeof v=="number"?Xx(v):v},n=function(h,m,v){var x=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?h:Xx(x)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return s(Cn(h),m);case"binary":return s(h,m);case"buffer":return s(Oe&&Buffer.isBuffer(h)?h.toString("binary"):Dl(h),m);case"array":return s(nu(h),m)}throw new Error("Unrecognized type "+m.type)}function s(h,m){var v=h.split(/[\n\r]+/),x=-1,w=-1,y=0,p=0,g=[],b=[],j=null,A={},k=[],D=[],_=[],N=0,B;for(+m.codepage>=0&&pl(+m.codepage);y!==v.length;++y){N=0;var q=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=q.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),_e=Z[0],ce;if(q.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&b.push(q.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,pe=!1,Q=!1,re=!1,xe=-1,Ee=-1;for(p=1;p<Z.length;++p)switch(Z[p].charAt(0)){case"A":break;case"X":w=parseInt(Z[p].slice(1))-1,pe=!0;break;case"Y":for(x=parseInt(Z[p].slice(1))-1,pe||(w=0),B=g.length;B<=x;++B)g[B]=[];break;case"K":ce=Z[p].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(bn(ce))?isNaN(vl(ce).getDate())||(ce=Vt(ce)):(ce=bn(ce),j!==null&&nv(j)&&(ce=lv(ce))),we=!0;break;case"E":re=!0;var R=AN(Z[p].slice(1),{r:x,c:w});g[x][w]=[g[x][w],R];break;case"S":Q=!0,g[x][w]=[g[x][w],"S5S"];break;case"G":break;case"R":xe=parseInt(Z[p].slice(1))-1;break;case"C":Ee=parseInt(Z[p].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}if(we&&(g[x][w]&&g[x][w].length==2?g[x][w][0]=ce:g[x][w]=ce,j=null),Q){if(re)throw new Error("SYLK shared formula cannot have own formula");var H=xe>-1&&g[xe][Ee];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");g[x][w][1]=PN(H[1],{r:x-xe,c:w-Ee})}break;case"F":var M=0;for(p=1;p<Z.length;++p)switch(Z[p].charAt(0)){case"X":w=parseInt(Z[p].slice(1))-1,++M;break;case"Y":for(x=parseInt(Z[p].slice(1))-1,B=g.length;B<=x;++B)g[B]=[];break;case"M":N=parseInt(Z[p].slice(1))/20;break;case"F":break;case"G":break;case"P":j=b[parseInt(Z[p].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=Z[p].slice(1).split(" "),B=parseInt(_[0],10);B<=parseInt(_[1],10);++B)N=parseInt(_[2],10),D[B-1]=N===0?{hidden:!0}:{wch:N},zf(D[B-1]);break;case"C":w=parseInt(Z[p].slice(1))-1,D[w]||(D[w]={});break;case"R":x=parseInt(Z[p].slice(1))-1,k[x]||(k[x]={}),N>0?(k[x].hpt=N,k[x].hpx=Kv(N)):N===0&&(k[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}M<1&&(j=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}}return k.length>0&&(A["!rows"]=k),D.length>0&&(A["!cols"]=D),m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),[g,A]}function i(h,m){var v=a(h,m),x=v[0],w=v[1],y=si(x,m);return At(w).forEach(function(p){y[p]=w[p]}),y}function o(h,m){return Wa(i(h,m),m)}function c(h,m,v,x){var w="C;Y"+(v+1)+";X"+(x+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+Hf(h.f,{r:v,c:x}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(h,m){m.forEach(function(v,x){var w="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Sc(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=kc(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function d(h,m){m.forEach(function(v,x){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*jc(v.hpx)+";"),w.length>2&&h.push(w+"R"+(x+1))})}function f(h,m){var v=["ID;PWXL;N;E"],x=[],w=qe(h["!ref"]),y,p=Array.isArray(h),g=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&d(v,h["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var b=w.s.r;b<=w.e.r;++b)for(var j=w.s.c;j<=w.e.c;++j){var A=Ue({r:b,c:j});y=p?(h[b]||[])[j]:h[A],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,h,b,j))}return v.join(g)+g+x.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),FT=function(){function e(s,i){switch(i.type){case"base64":return t(Cn(s),i);case"binary":return t(s,i);case"buffer":return t(Oe&&Buffer.isBuffer(s)?s.toString("binary"):Dl(s),i);case"array":return t(nu(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),m=h[0],v=h[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(bn(v))?isNaN(vl(v).getDate())?f[c][u]=v:f[c][u]=Vt(v):f[c][u]=bn(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return si(e(s,i),i)}function n(s,i){return Wa(r(s,i),i)}var a=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=qe(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(u,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var x=Ue({r:m,c:v});if(f=h?(c[m]||[])[v]:c[x],!f){i(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ia(f.z||at[14],rr(Vt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,p=u.join(y);return p}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Hv=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),v=-1,x=-1,w=0,y=[];w!==m.length;++w){var p=m[w].trim().split(":");if(p[0]==="cell"){var g=vt(p[1]);if(y.length<=g.r)for(v=y.length;v<=g.r;++v)y[v]||(y[v]=[]);switch(v=g.r,x=g.c,p[2]){case"t":y[v][x]=e(p[3]);break;case"v":y[v][x]=+p[3];break;case"vtf":var b=p[p.length-1];case"vtc":switch(p[3]){case"nl":y[v][x]=!!+p[4];break;default:y[v][x]=+p[4];break}p[2]=="vtf"&&(y[v][x]=[y[v][x],b])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return si(r(f,h),h)}function a(f,h){return Wa(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],v,x="",w=fr(f["!ref"]),y=Array.isArray(f),p=w.s.r;p<=w.e.r;++p)for(var g=w.s.c;g<=w.e.c;++g)if(x=Ue({r:p,c:g}),v=y?(f[p]||[])[g]:f[x],!(!v||v.v==null||v.t==="z")){switch(m=["cell",x,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var b=rr(Vt(v.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=v.w||ia(v.z||at[14],b);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,i,o,i,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),DT=function(){function e(d,f,h,m,v){v.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(bn(d))?isNaN(vl(d).getDate())?f[h][m]=d:f[h][m]=Vt(d):f[h][m]=bn(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var v=d.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var w=10,y=0,p=0;p<=x;++p)y=v[p].indexOf(" "),y==-1?y=v[p].length:y++,w=Math.max(w,y);for(p=0;p<=x;++p){m[p]=[];var g=0;for(e(v[p].slice(0,w).trim(),m,p,g,h),g=1;g<=(v[p].length-w)/10+1;++g)e(v[p].slice(w+(g-1)*10,w+g*10).trim(),m,p,g,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,m=0,v=0;m<d.length;++m)(v=d.charCodeAt(m))==34?h=!h:!h&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m]);if(!v.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m])}return v.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[v.pop()[1]]||44}function s(d,f){var h=f||{},m="",v=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=a(d.slice(0,1024)):h&&h.FS?m=h.FS:m=a(d.slice(0,1024));var w=0,y=0,p=0,g=0,b=0,j=m.charCodeAt(0),A=!1,k=0,D=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var _=h.dateNF!=null?Yj(h.dateNF):null;function N(){var B=d.slice(g,b),q={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)q.t="z";else if(h.raw)q.t="s",q.v=B;else if(B.trim().length===0)q.t="s",q.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(q.t="s",q.v=B.slice(2,-1).replace(/""/g,'"')):ON(B)?(q.t="n",q.f=B.slice(1)):(q.t="s",q.v=B);else if(B=="TRUE")q.t="b",q.v=!0;else if(B=="FALSE")q.t="b",q.v=!1;else if(!isNaN(p=bn(B)))q.t="n",h.cellText!==!1&&(q.w=B),q.v=p;else if(!isNaN(vl(B).getDate())||_&&B.match(_)){q.z=h.dateNF||at[14];var Z=0;_&&B.match(_)&&(B=Jj(B,h.dateNF,B.match(_)||[]),Z=1),h.cellDates?(q.t="d",q.v=Vt(B,Z)):(q.t="n",q.v=rr(Vt(B,Z))),h.cellText!==!1&&(q.w=ia(q.z,q.v instanceof Date?rr(q.v):q.v)),h.cellNF||delete q.z}else q.t="s",q.v=B;if(q.t=="z"||(h.dense?(v[w]||(v[w]=[]),v[w][y]=q):v[Ue({c:y,r:w})]=q),g=b+1,D=d.charCodeAt(g),x.e.c<y&&(x.e.c=y),x.e.r<w&&(x.e.r=w),k==j)++y;else if(y=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;b<d.length;++b)switch(k=d.charCodeAt(b)){case 34:D===34&&(A=!A);break;case j:case 10:case 13:if(!A&&N())break e;break}return b-g>0&&N(),v["!ref"]=ot(x),v}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):si(t(d,f),f)}function o(d,f){var h="",m=f.type=="string"?[0,0,0,0]:GC(d,f);switch(f.type){case"base64":h=Cn(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ka<"u"?h=ka.utils.decode(f.codepage,d):h=Oe&&Buffer.isBuffer(d)?d.toString("binary"):Dl(d);break;case"array":h=nu(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=$i(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=$i(h):f.type=="binary"&&typeof ka<"u"&&f.codepage&&(h=ka.utils.decode(f.codepage,ka.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Hv.to_sheet(f.type=="string"?h:$i(h),f):i(h,f)}function c(d,f){return Wa(o(d,f),f)}function u(d){for(var f=[],h=qe(d["!ref"]),m,v=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var w=[],y=h.s.c;y<=h.e.c;++y){var p=Ue({r:x,c:y});if(m=v?(d[x]||[])[y]:d[p],!m||m.v==null){w.push("          ");continue}for(var g=(m.w||(An(m),m.w)||"").slice(0,10);g.length<10;)g+=" ";w.push(g+(y===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Em=function(){function e(R,H,M){if(R){ir(R,R.l||0);for(var L=M.Enum||xe;R.l<R.length;){var X=R.read_shift(2),ue=L[X]||L[65535],ge=R.read_shift(2),me=R.l+ge,le=ue.f&&ue.f(R,ge,M);if(R.l=me,H(le,ue,X))return}}}function t(R,H){switch(H.type){case"base64":return r(Mr(Cn(R)),H);case"binary":return r(Mr(R),H);case"buffer":case"array":return r(R,H)}throw"Unsupported type "+H.type}function r(R,H){if(!R)return R;var M=H||{},L=M.dense?[]:{},X="Sheet1",ue="",ge=0,me={},le=[],Fe=[],I={s:{r:0,c:0},e:{r:0,c:0}},ye=M.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)M.Enum=xe,e(R,function(de,Ot,ut){switch(ut){case 0:M.vers=de,de>=4096&&(M.qpro=!0);break;case 6:I=de;break;case 204:de&&(ue=de);break;case 222:ue=de;break;case 15:case 51:M.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:ut==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=M.dateNF||at[14],M.cellDates&&(de[1].t="d",de[1].v=lv(de[1].v))),M.qpro&&de[3]>ge&&(L["!ref"]=ot(I),me[X]=L,le.push(X),L=M.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ge=de[3],X=ue||"Sheet"+(ge+1),ue="");var xa=M.dense?(L[de[0].r]||[])[de[0].c]:L[Ue(de[0])];if(xa){xa.t=de[1].t,xa.v=de[1].v,de[1].z!=null&&(xa.z=de[1].z),de[1].f!=null&&(xa.f=de[1].f);break}M.dense?(L[de[0].r]||(L[de[0].r]=[]),L[de[0].r][de[0].c]=de[1]):L[Ue(de[0])]=de[1];break}},M);else if(R[2]==26||R[2]==14)M.Enum=Ee,R[2]==14&&(M.qpro=!0,R.l=0),e(R,function(de,Ot,ut){switch(ut){case 204:X=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>ge&&(L["!ref"]=ot(I),me[X]=L,le.push(X),L=M.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ge=de[3],X="Sheet"+(ge+1)),ye>0&&de[0].r>=ye)break;M.dense?(L[de[0].r]||(L[de[0].r]=[]),L[de[0].r][de[0].c]=de[1]):L[Ue(de[0])]=de[1],I.e.c<de[0].c&&(I.e.c=de[0].c),I.e.r<de[0].r&&(I.e.r=de[0].r);break;case 27:de[14e3]&&(Fe[de[14e3][0]]=de[14e3][1]);break;case 1537:Fe[de[0]]=de[1],de[0]==ge&&(X=de[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(L["!ref"]=ot(I),me[ue||X]=L,le.push(ue||X),!Fe.length)return{SheetNames:le,Sheets:me};for(var ve={},Pt=[],De=0;De<Fe.length;++De)me[le[De]]?(Pt.push(Fe[De]||le[De]),ve[Fe[De]]=me[Fe[De]]||me[le[De]]):(Pt.push(Fe[De]),ve[Fe[De]]={"!ref":"A1"});return{SheetNames:Pt,Sheets:ve}}function n(R,H){var M=H||{};if(+M.codepage>=0&&pl(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var L=tr(),X=qe(R["!ref"]),ue=Array.isArray(R),ge=[];se(L,0,s(1030)),se(L,6,c(X));for(var me=Math.min(X.e.r,8191),le=X.s.r;le<=me;++le)for(var Fe=Nt(le),I=X.s.c;I<=X.e.c;++I){le===X.s.r&&(ge[I]=Mt(I));var ye=ge[I]+Fe,ve=ue?(R[le]||[])[I]:R[ye];if(!(!ve||ve.t=="z"))if(ve.t=="n")(ve.v|0)==ve.v&&ve.v>=-32768&&ve.v<=32767?se(L,13,m(le,I,ve.v)):se(L,14,x(le,I,ve.v));else{var Pt=An(ve);se(L,15,f(le,I,Pt.slice(0,239)))}}return se(L,1),L.end()}function a(R,H){var M=H||{};if(+M.codepage>=0&&pl(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var L=tr();se(L,0,i(R));for(var X=0,ue=0;X<R.SheetNames.length;++X)(R.Sheets[R.SheetNames[X]]||{})["!ref"]&&se(L,27,re(R.SheetNames[X],ue++));var ge=0;for(X=0;X<R.SheetNames.length;++X){var me=R.Sheets[R.SheetNames[X]];if(!(!me||!me["!ref"])){for(var le=qe(me["!ref"]),Fe=Array.isArray(me),I=[],ye=Math.min(le.e.r,8191),ve=le.s.r;ve<=ye;++ve)for(var Pt=Nt(ve),De=le.s.c;De<=le.e.c;++De){ve===le.s.r&&(I[De]=Mt(De));var de=I[De]+Pt,Ot=Fe?(me[ve]||[])[De]:me[de];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")se(L,23,N(ve,De,ge,Ot.v));else{var ut=An(Ot);se(L,22,k(ve,De,ge,ut.slice(0,239)))}}++ge}}return se(L,1),L.end()}function s(R){var H=G(2);return H.write_shift(2,R),H}function i(R){var H=G(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var M=0,L=0,X=0,ue=0;ue<R.SheetNames.length;++ue){var ge=R.SheetNames[ue],me=R.Sheets[ge];if(!(!me||!me["!ref"])){++X;var le=fr(me["!ref"]);M<le.e.r&&(M=le.e.r),L<le.e.c&&(L=le.e.c)}}return M>8191&&(M=8191),H.write_shift(2,M),H.write_shift(1,X),H.write_shift(1,L),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(R,H,M){var L={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&M.qpro?(L.s.c=R.read_shift(1),R.l++,L.s.r=R.read_shift(2),L.e.c=R.read_shift(1),R.l++,L.e.r=R.read_shift(2),L):(L.s.c=R.read_shift(2),L.s.r=R.read_shift(2),H==12&&M.qpro&&(R.l+=2),L.e.c=R.read_shift(2),L.e.r=R.read_shift(2),H==12&&M.qpro&&(R.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(R){var H=G(8);return H.write_shift(2,R.s.c),H.write_shift(2,R.s.r),H.write_shift(2,R.e.c),H.write_shift(2,R.e.r),H}function u(R,H,M){var L=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(L[0].c=R.read_shift(1),L[3]=R.read_shift(1),L[0].r=R.read_shift(2),R.l+=2):(L[2]=R.read_shift(1),L[0].c=R.read_shift(2),L[0].r=R.read_shift(2)),L}function d(R,H,M){var L=R.l+H,X=u(R,H,M);if(X[1].t="s",M.vers==20768){R.l++;var ue=R.read_shift(1);return X[1].v=R.read_shift(ue,"utf8"),X}return M.qpro&&R.l++,X[1].v=R.read_shift(L-R.l,"cstr"),X}function f(R,H,M){var L=G(7+M.length);L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,R),L.write_shift(1,39);for(var X=0;X<L.length;++X){var ue=M.charCodeAt(X);L.write_shift(1,ue>=128?95:ue)}return L.write_shift(1,0),L}function h(R,H,M){var L=u(R,H,M);return L[1].v=R.read_shift(2,"i"),L}function m(R,H,M){var L=G(7);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,R),L.write_shift(2,M,"i"),L}function v(R,H,M){var L=u(R,H,M);return L[1].v=R.read_shift(8,"f"),L}function x(R,H,M){var L=G(13);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,R),L.write_shift(8,M,"f"),L}function w(R,H,M){var L=R.l+H,X=u(R,H,M);if(X[1].v=R.read_shift(8,"f"),M.qpro)R.l=L;else{var ue=R.read_shift(2);b(R.slice(R.l,R.l+ue),X),R.l+=ue}return X}function y(R,H,M){var L=H&32768;return H&=-32769,H=(L?R:0)+(H>=8192?H-16384:H),(L?"":"$")+(M?Mt(H):Nt(H))}var p={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(R,H){ir(R,0);for(var M=[],L=0,X="",ue="",ge="",me="";R.l<R.length;){var le=R[R.l++];switch(le){case 0:M.push(R.read_shift(8,"f"));break;case 1:ue=y(H[0].c,R.read_shift(2),!0),X=y(H[0].r,R.read_shift(2),!1),M.push(ue+X);break;case 2:{var Fe=y(H[0].c,R.read_shift(2),!0),I=y(H[0].r,R.read_shift(2),!1);ue=y(H[0].c,R.read_shift(2),!0),X=y(H[0].r,R.read_shift(2),!1),M.push(Fe+I+":"+ue+X)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(R.read_shift(2));break;case 6:{for(var ye="";le=R[R.l++];)ye+=String.fromCharCode(le);M.push('"'+ye.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:me=M.pop(),ge=M.pop(),M.push(["AND","OR"][le-20]+"("+ge+","+me+")");break;default:if(le<32&&g[le])me=M.pop(),ge=M.pop(),M.push(ge+g[le]+me);else if(p[le]){if(L=p[le][1],L==69&&(L=R[R.l++]),L>M.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+M.join("|")+"|");return}var ve=M.slice(-L);M.length-=L,M.push(p[le][0]+"("+ve.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}M.length==1?H[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function j(R){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=R.read_shift(2),H[3]=R[R.l++],H[0].c=R[R.l++],H}function A(R,H){var M=j(R);return M[1].t="s",M[1].v=R.read_shift(H-4,"cstr"),M}function k(R,H,M,L){var X=G(6+L.length);X.write_shift(2,R),X.write_shift(1,M),X.write_shift(1,H),X.write_shift(1,39);for(var ue=0;ue<L.length;++ue){var ge=L.charCodeAt(ue);X.write_shift(1,ge>=128?95:ge)}return X.write_shift(1,0),X}function D(R,H){var M=j(R);M[1].v=R.read_shift(2);var L=M[1].v>>1;if(M[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return M[1].v=L,M}function _(R,H){var M=j(R),L=R.read_shift(4),X=R.read_shift(4),ue=R.read_shift(2);if(ue==65535)return L===0&&X===3221225472?(M[1].t="e",M[1].v=15):L===0&&X===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ge=ue&32768;return ue=(ue&32767)-16446,M[1].v=(1-ge*2)*(X*Math.pow(2,ue+32)+L*Math.pow(2,ue)),M}function N(R,H,M,L){var X=G(14);if(X.write_shift(2,R),X.write_shift(1,M),X.write_shift(1,H),L==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ue=0,ge=0,me=0,le=0;return L<0&&(ue=1,L=-L),ge=Math.log2(L)|0,L/=Math.pow(2,ge-31),le=L>>>0,le&2147483648||(L/=2,++ge,le=L>>>0),L-=le,le|=2147483648,le>>>=0,L*=Math.pow(2,32),me=L>>>0,X.write_shift(4,me),X.write_shift(4,le),ge+=16383+(ue?32768:0),X.write_shift(2,ge),X}function B(R,H){var M=_(R);return R.l+=H-14,M}function q(R,H){var M=j(R),L=R.read_shift(4);return M[1].v=L>>6,M}function Z(R,H){var M=j(R),L=R.read_shift(8,"f");return M[1].v=L,M}function _e(R,H){var M=Z(R);return R.l+=H-10,M}function ce(R,H){return R[R.l+H-1]==0?R.read_shift(H,"cstr"):""}function we(R,H){var M=R[R.l++];M>H-1&&(M=H-1);for(var L="";L.length<M;)L+=String.fromCharCode(R[R.l++]);return L}function pe(R,H,M){if(!(!M.qpro||H<21)){var L=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var X=R.read_shift(H-21,"cstr");return[L,X]}}function Q(R,H){for(var M={},L=R.l+H;R.l<L;){var X=R.read_shift(2);if(X==14e3){for(M[X]=[0,""],M[X][0]=R.read_shift(2);R[R.l];)M[X][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return M}function re(R,H){var M=G(5+R.length);M.write_shift(2,14e3),M.write_shift(2,H);for(var L=0;L<R.length;++L){var X=R.charCodeAt(L);M[M.l++]=X>127?95:X}return M[M.l++]=0,M}var xe={0:{n:"BOF",f:Bv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),RT=/^\s|\s$|[\t\n\r]/;function Vv(e,t){if(!t.bookSST)return"";var r=[ct];r[r.length]=ae("sst",null,{xmlns:ai[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(RT)&&(s+=' xml:space="preserve"'),s+=">"+Ie(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function LT(e){return[e.read_shift(4),e.read_shift(4)]}function MT(e,t){return t||(t=G(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var IT=NE;function BT(e){var t=tr();J(t,159,MT(e));for(var r=0;r<e.length;++r)J(t,19,IT(e[r]));return J(t,160),t.end()}function UT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Gv(e){var t=0,r,n=UT(e),a=n.length+1,s,i,o,c,u;for(r=Ma(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var $T=function(){function e(a,s){switch(s.type){case"base64":return t(Cn(a),s);case"binary":return t(a,s);case"buffer":return t(Oe&&Buffer.isBuffer(a)?a.toString("binary"):Dl(a),s);case"array":return t(nu(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,v,x=-1;v=h.exec(d);){switch(v[0]){case"\\cell":var w=d.slice(m,h.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var y={v:w,t:"s"};Array.isArray(o)?o[f][x]=y:o[Ue({r:f,c:x})]=y}break}m=h.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=ot(u),o}function r(a,s){return Wa(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=qe(a["!ref"]),o,c=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Ue({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(An(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Tm(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var zT=6,Sn=zT;function Sc(e){return Math.floor((e+Math.round(128/Sn)/256)*Sn)}function kc(e){return Math.floor((e-5)/Sn*100+.5)/100}function gd(e){return Math.round((e*Sn+5)/Sn*256)/256}function zf(e){e.width?(e.wpx=Sc(e.width),e.wch=kc(e.wpx),e.MDW=Sn):e.wpx?(e.wch=kc(e.wpx),e.width=gd(e.wch),e.MDW=Sn):typeof e.wch=="number"&&(e.width=gd(e.wch),e.wpx=Sc(e.width),e.MDW=Sn),e.customWidth&&delete e.customWidth}var WT=96,qv=WT;function jc(e){return e*96/qv}function Kv(e){return e*qv/96}function HT(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ae("numFmt",null,{numFmtId:n,formatCode:Ie(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ae("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function VT(e){var t=[];return t[t.length]=ae("cellXfs",null),e.forEach(function(r){t[t.length]=ae("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ae("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Xv(e,t){var r=[ct,ae("styleSheet",null,{xmlns:ai[0],"xmlns:vt":gt.vt})],n;return e.SSF&&(n=HT(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=VT(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function GT(e,t){var r=e.read_shift(2),n=It(e);return[r,n]}function qT(e,t,r){r||(r=G(6+4*t.length)),r.write_shift(2,e),yt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function KT(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=RE(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=DE(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=It(e),n}function XT(e,t){t||(t=G(25+4*32)),t.write_shift(2,e.sz*20),LE(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_c(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),yt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var YT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zu,JT=un;function Nm(e,t){t||(t=G(4*3+8*7+16*1)),Zu||(Zu=Af(YT));var r=Zu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_c({auto:1},t),_c({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function QT(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Yv(e,t,r){r||(r=G(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _i(e,t){return t||(t=G(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ZT=un;function eN(e,t){return t||(t=G(51)),t.write_shift(1,0),_i(null,t),_i(null,t),_i(null,t),_i(null,t),_i(null,t),t.length>t.l?t.slice(0,t.l):t}function tN(e,t){return t||(t=G(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),wc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function rN(e,t,r){var n=G(2052);return n.write_shift(4,e),wc(t,n),wc(r,n),n.length>n.l?n.slice(0,n.l):n}function nN(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(J(e,615,Wr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&J(e,44,qT(a,t[a]))}),J(e,616))}}function aN(e){var t=1;J(e,611,Wr(t)),J(e,43,XT({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),J(e,612)}function sN(e){var t=2;J(e,603,Wr(t)),J(e,45,Nm({patternType:"none"})),J(e,45,Nm({patternType:"gray125"})),J(e,604)}function iN(e){var t=1;J(e,613,Wr(t)),J(e,46,eN()),J(e,614)}function lN(e){var t=1;J(e,626,Wr(t)),J(e,47,Yv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),J(e,627)}function oN(e,t){J(e,617,Wr(t.length)),t.forEach(function(r){J(e,47,Yv(r,0))}),J(e,618)}function cN(e){var t=1;J(e,619,Wr(t)),J(e,48,tN({xfId:0,builtinId:0,name:"Normal"})),J(e,620)}function uN(e){var t=0;J(e,505,Wr(t)),J(e,506)}function dN(e){var t=0;J(e,508,rN(t,"TableStyleMedium9","PivotStyleMedium4")),J(e,509)}function fN(e,t){var r=tr();return J(r,278),nN(r,e.SSF),aN(r),sN(r),iN(r),lN(r),oN(r,t.cellXfs),cN(r),uN(r),dN(r),J(r,279),r.end()}function Jv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ct];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hN(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:It(e)}}function xN(e){var t=G(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yt(e.name,t),t.slice(0,t.l)}function mN(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function pN(e){var t=G(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function gN(e,t){var r=G(8+2*t.length);return r.write_shift(4,e),yt(t,r),r.slice(0,r.l)}function vN(e){return e.l+=4,e.read_shift(4)!=0}function yN(e,t){var r=G(8);return r.write_shift(4,e),r.write_shift(4,1),r}function wN(){var e=tr();return J(e,332),J(e,334,Wr(1)),J(e,335,xN({name:"XLDAPR",version:12e4,flags:3496657072})),J(e,336),J(e,339,gN(1,"XLDAPR")),J(e,52),J(e,35,Wr(514)),J(e,4096,Wr(0)),J(e,4097,gr(1)),J(e,36),J(e,53),J(e,340),J(e,337,yN(1)),J(e,51,pN([[1,0]])),J(e,338),J(e,333),e.end()}function Qv(){var e=[ct];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function _N(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ss=1024;function Zv(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ae("xml",null,{"xmlns:v":lr.v,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:mv":lr.mv}).replace(/\/>/,">"),ae("o:shapelayout",ae("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ae("v:shapetype",[ae("v:stroke",null,{joinstyle:"miter"}),ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ss<e*1e3;)Ss+=1e3;return t.forEach(function(s){var i=vt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ae("v:fill",c,o),d={on:"t",obscured:"t"};++Ss,a=a.concat(["<v:shape"+wl({id:"_x0000_s"+Ss,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ae("v:shadow",null,d),ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Et("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Et("x:AutoFill","False"),Et("x:Row",String(i.r)),Et("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ey(e){var t=[ct,ae("comments",null,{xmlns:ai[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Ie(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Ie(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Et("t",Ie(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(Et("t",Ie(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function bN(e,t,r){var n=[ct,ae("ThreadedComments",null,{xmlns:gt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ae("threadedComment",Et("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function SN(e){var t=[ct,ae("personList",null,{xmlns:gt.TCMNT,"xmlns:x":ai[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ae("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kN(e){var t={};t.iauthor=e.read_shift(4);var r=qa(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function jN(e,t){return t==null&&(t=G(36)),t.write_shift(4,e[1].iauthor),ii(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var EN=It;function TN(e){return yt(e.slice(0,54))}function NN(e){var t=tr(),r=[];return J(t,628),J(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),J(t,632,TN(a.a)))})}),J(t,631),J(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:vt(n[0]),e:vt(n[0])};J(t,635,jN([s,a])),a.t&&a.t.length>0&&J(t,637,AE(a)),J(t,636),delete a.iauthor})}),J(t,634),J(t,629),t.end()}function CN(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ze.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var ty=["xlsb","xlsm","xlam","biff8","xla"],AN=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+Mt(d)+(c?"":"$")+Nt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),Wf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hf=function(){return function(t,r){return t.replace(Wf,function(n,a,s,i,o,c){var u=Mf(i)-(s?0:r.c),d=Lf(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function PN(e,t){return e.replace(Wf,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Mt(Mf(s)+t.c))+(i=="$"?i+o:Nt(Lf(o)+t.r))})}function ON(e){return e.length!=1}function it(e){e.l+=1}function la(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ry(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ny(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=la(e),o=la(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ny(e){var t=la(e),r=la(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function FN(e,t,r){if(r.biff<8)return ny(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=la(e),i=la(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function ay(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return DN(e);var n=e.read_shift(r&&r.biff==12?4:2),a=la(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function DN(e){var t=la(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function RN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function LN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return MN(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function MN(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function IN(e,t,r){var n=(e[e.l++]&96)>>5,a=ry(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function BN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=ry(e,s,r);return[n,a,i]}function UN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function $N(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function zN(e,t,r){var n=(e[e.l++]&96)>>5,a=FN(e,t-1,r);return[n,a]}function WN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Cm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function HN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function VN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function GN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function qN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function KN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function sy(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function XN(e){return e.read_shift(2),sy(e)}function YN(e){return e.read_shift(2),sy(e)}function JN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=ay(e,0,r);return[n,a]}function QN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=LN(e,0,r);return[n,a]}function ZN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=ay(e,0,r);return[n,a,s]}function e6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[e5[a],oy[a],n]}function t6(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:r6(e);return[a,(s[0]===0?oy:Z6)[s[1]]]}function r6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function n6(e,t,r){e.l+=r&&r.biff==2?3:4}function a6(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function s6(e){return e.l++,Ml[e.read_shift(1)]}function i6(e){return e.l++,e.read_shift(2)}function l6(e){return e.l++,e.read_shift(1)!==0}function o6(e){return e.l++,li(e)}function c6(e,t,r){return e.l++,$v(e,t-1,r)}function u6(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ZE(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ml[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=li(e);break;case 2:r[1]=nT(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function d6(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?qa:iT)(e));return a}function f6(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=u6(e,r.biff);return i}function h6(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function x6(e,t,r){if(r.biff==5)return m6(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function m6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function p6(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function g6(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function v6(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function y6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var w6=un,_6=un,b6=un;function Il(e,t,r){return e.l+=2,[RN(e)]}function Vf(e){return e.l+=6,[]}var S6=Il,k6=Vf,j6=Vf,E6=Il;function iy(e){return e.l+=2,[Bv(e),e.read_shift(2)&1]}var T6=Il,N6=iy,C6=Vf,A6=Il,P6=Il,O6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function F6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=O6[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function D6(e){return e.l+=2,[e.read_shift(4)]}function R6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function L6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function M6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function I6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function B6(e){return e.l+=4,[0,0]}var Am={1:{n:"PtgExp",f:a6},2:{n:"PtgTbl",f:b6},3:{n:"PtgAdd",f:it},4:{n:"PtgSub",f:it},5:{n:"PtgMul",f:it},6:{n:"PtgDiv",f:it},7:{n:"PtgPower",f:it},8:{n:"PtgConcat",f:it},9:{n:"PtgLt",f:it},10:{n:"PtgLe",f:it},11:{n:"PtgEq",f:it},12:{n:"PtgGe",f:it},13:{n:"PtgGt",f:it},14:{n:"PtgNe",f:it},15:{n:"PtgIsect",f:it},16:{n:"PtgUnion",f:it},17:{n:"PtgRange",f:it},18:{n:"PtgUplus",f:it},19:{n:"PtgUminus",f:it},20:{n:"PtgPercent",f:it},21:{n:"PtgParen",f:it},22:{n:"PtgMissArg",f:it},23:{n:"PtgStr",f:c6},26:{n:"PtgSheet",f:R6},27:{n:"PtgEndSheet",f:L6},28:{n:"PtgErr",f:s6},29:{n:"PtgBool",f:l6},30:{n:"PtgInt",f:i6},31:{n:"PtgNum",f:o6},32:{n:"PtgArray",f:WN},33:{n:"PtgFunc",f:e6},34:{n:"PtgFuncVar",f:t6},35:{n:"PtgName",f:h6},36:{n:"PtgRef",f:JN},37:{n:"PtgArea",f:IN},38:{n:"PtgMemArea",f:p6},39:{n:"PtgMemErr",f:w6},40:{n:"PtgMemNoMem",f:_6},41:{n:"PtgMemFunc",f:g6},42:{n:"PtgRefErr",f:v6},43:{n:"PtgAreaErr",f:UN},44:{n:"PtgRefN",f:QN},45:{n:"PtgAreaN",f:zN},46:{n:"PtgMemAreaN",f:M6},47:{n:"PtgMemNoMemN",f:I6},57:{n:"PtgNameX",f:x6},58:{n:"PtgRef3d",f:ZN},59:{n:"PtgArea3d",f:BN},60:{n:"PtgRefErr3d",f:y6},61:{n:"PtgAreaErr3d",f:$N},255:{}},U6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$6={1:{n:"PtgElfLel",f:iy},2:{n:"PtgElfRw",f:A6},3:{n:"PtgElfCol",f:S6},6:{n:"PtgElfRwV",f:P6},7:{n:"PtgElfColV",f:E6},10:{n:"PtgElfRadical",f:T6},11:{n:"PtgElfRadicalS",f:C6},13:{n:"PtgElfColS",f:k6},15:{n:"PtgElfColSV",f:j6},16:{n:"PtgElfRadicalLel",f:N6},25:{n:"PtgList",f:F6},29:{n:"PtgSxName",f:D6},255:{}},z6={0:{n:"PtgAttrNoop",f:B6},1:{n:"PtgAttrSemi",f:KN},2:{n:"PtgAttrIf",f:GN},4:{n:"PtgAttrChoose",f:HN},8:{n:"PtgAttrGoto",f:VN},16:{n:"PtgAttrSum",f:n6},32:{n:"PtgAttrBaxcel",f:Cm},33:{n:"PtgAttrBaxcel",f:Cm},64:{n:"PtgAttrSpace",f:XN},65:{n:"PtgAttrSpaceSemi",f:YN},128:{n:"PtgAttrIfError",f:qN},255:{}};function W6(e,t,r,n){if(n.biff<8)return un(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=f6(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=d6(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(un(e,t)),s}function H6(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Am[s]||Am[U6[s]],(s===24||s===25)&&(a=(s===24?$6:z6)[e[e.l+1]]),!a||!a.f?un(e,t):i.push([a.n,a.f(e,t,r)]);return i}function V6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var G6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function q6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ly(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Pm(e,t,r){var n=ly(e,t,r);return n=="#REF"?n:q6(n,r)}function Xs(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,h=0,m,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,w="",y=0,p=e[0].length;y<p;++y){var g=e[0][y];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:w=rt(" ",e[0][x][1][1]);break;case 1:w=rt("\r",e[0][x][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+w,x=-1}o.push(u+G6[g[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Wi(g[1][1],i,a),o.push(Hi(d,s));break;case"PtgRefN":d=r?Wi(g[1][1],r,a):g[1][1],o.push(Hi(d,s));break;case"PtgRef3d":f=g[1][1],d=Wi(g[1][2],i,a),v=Pm(n,f,a),o.push(v+"!"+Hi(d,s));break;case"PtgFunc":case"PtgFuncVar":var b=g[1][0],j=g[1][1];b||(b=0),b&=127;var A=b==0?[]:o.slice(-b);o.length-=b,j==="User"&&(j=A.shift()),o.push(j+"("+A.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":m=mm(g[1][1],r?{s:r}:i,a),o.push(Ju(m,a));break;case"PtgArea":m=mm(g[1][1],i,a),o.push(Ju(m,a));break;case"PtgArea3d":f=g[1][1],m=g[1][2],v=Pm(n,f,a),o.push(v+"!"+Ju(m,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],D=k?k.Name:"SH33TJSNAME"+String(h);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var _=g[1][1];h=g[1][2];var N;if(a.biff<=5)_<0&&(_=-_),n[_]&&(N=n[_][h]);else{var B="";if(((n[_]||[])[0]||[])[0]==14849||(((n[_]||[])[0]||[])[0]==1025?n[_][h]&&n[_][h].itab>0&&(B=n.SheetNames[n[_][h].itab-1]+"!"):B=n.SheetNames[h-1]+"!"),n[_]&&n[_][h])B+=n[_][h].Name;else if(n[0]&&n[0][h])B+=n[0][h].Name;else{var q=(ly(n,_,a)||"").split(";;");q[h-1]?B=q[h-1]:B+="SH33TJSERRX"}o.push(B);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var Z="(",_e=")";if(x>=0){switch(w="",e[0][x][1][0]){case 2:Z=rt(" ",e[0][x][1][1])+Z;break;case 3:Z=rt("\r",e[0][x][1][1])+Z;break;case 4:_e=rt(" ",e[0][x][1][1])+_e;break;case 5:_e=rt("\r",e[0][x][1][1])+_e;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(Z+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:g[1][1],r:g[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[Ue(d)]){var we=n.sharedf[Ue(d)];o.push(Xs(we,i,ce,n,a))}else{var pe=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Xs(u[1],i,ce,n,a)),pe=!0;break}pe||o.push(g[1])}break;case"PtgArray":o.push("{"+V6(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&Q.indexOf(e[0][y][0])==-1){g=e[0][x];var re=!0;switch(g[1][0]){case 4:re=!1;case 0:w=rt(" ",g[1][1]);break;case 5:re=!1;case 1:w=rt("\r",g[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((re?w:"")+o.pop()+(re?"":w)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function K6(e){if(e==null){var t=G(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ia(e);return Ia(0)}function X6(e,t,r,n,a){var s=Ba(t,r,a),i=K6(e.v),o=G(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=G(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=jt([s,i,o,u]);return f}function au(e,t,r){var n=e.read_shift(4),a=H6(e,n,r),s=e.read_shift(4),i=s>0?W6(e,s,a,r):null;return[a,i]}var Y6=au,su=au,J6=au,Q6=au,Z6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function t5(e){var t="of:="+e.replace(Wf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function r5(e){return e.replace(/\./,"!")}var Vi=typeof Map<"u";function Gf(e,t,r){var n=0,a=e.length;if(r){if(Vi?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Vi?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Vi?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function iu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=kc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=gd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function cy(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ha(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){av(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function n5(e,t,r){if(e&&e["!ref"]){var n=qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function a5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ot(e[r])+'"/>';return t+"</mergeCells>"}function s5(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,i.codeName=yl(Ie(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ae("outlinePr",null,u)}!s&&!o||(a[a.length]=ae("sheetPr",o,i))}var i5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],l5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function o5(e){var t={sheet:1};return i5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),l5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Gv(e.password).toString(16).toUpperCase()),ae("sheetProtection",null,t)}function c5(e){return cy(e),ae("pageMargins",null,e)}function u5(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ae("col",null,iu(a,n)));return r[r.length]="</cols>",r.join("")}function d5(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ot(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=fr(a);i.s.r==i.e.r&&(i.e.r=fr(t["!ref"]).e.r,a=ot(i));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ae("autoFilter",null,{ref:a})}function f5(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ae("sheetViews",ae("sheetView",null,a),{})}function h5(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ml[e.v];break;case"d":n&&n.cellDates?a=Vt(e.v,-1).toISOString():(e=nr(e),e.t="n",a=""+(e.v=rr(Vt(e.v)))),typeof e.z>"u"&&(e.z=at[14]);break;default:a=e.v;break}var o=Et("v",Ie(a)),c={r:t},u=ha(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Et("v",""+Gf(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ae("f",Ie(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ae("c",o,c)}function x5(e,t,r,n){var a=[],s=[],i=qe(e["!ref"]),o="",c,u="",d=[],f=0,h=0,m=e["!rows"],v=Array.isArray(e),x={r:u},w,y=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=Mt(h);for(f=i.s.r;f<=i.e.r;++f){for(s=[],u=Nt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var p=v?(e[f]||[])[h]:e[c];p!==void 0&&(o=h5(p,c,e,t))!=null&&s.push(o)}(s.length>0||m&&m[f])&&(x={r:u},m&&m[f]&&(w=m[f],w.hidden&&(x.hidden=1),y=-1,w.hpx?y=jc(w.hpx):w.hpt&&(y=w.hpt),y>-1&&(x.ht=y,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),a[a.length]=ae("row",s.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},w=m[f],w.hidden&&(x.hidden=1),y=-1,w.hpx?y=jc(w.hpx):w.hpt&&(y=w.hpt),y>-1&&(x.ht=y,x.customHeight=1),w.level&&(x.outlineLevel=w.level),a[a.length]=ae("row","",x));return a.join("")}function uy(e,t,r,n){var a=[ct,ae("worksheet",null,{xmlns:ai[0],"xmlns:r":gt.r})],s=r.SheetNames[e],i=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=qe(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ot(d)}n||(n={}),c["!comments"]=[];var f=[];s5(c,r,e,t,a),a[a.length]=ae("dimension",null,{ref:u}),a[a.length]=f5(c,t,e,r),t.sheetFormat&&(a[a.length]=ae("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=u5(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=x5(c,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=o5(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=d5(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=a5(c["!merges"]));var h=-1,m,v=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Me(n,-1,Ie(x[1].Target).replace(/#.*$/,""),Pe.HLINK),m["r:id"]="rId"+v),(h=x[1].Target.indexOf("#"))>-1&&(m.location=Ie(x[1].Target.slice(h+1))),x[1].Tooltip&&(m.tooltip=Ie(x[1].Tooltip)),a[a.length]=ae("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=c5(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Et("ignoredErrors",ae("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=Me(n,-1,"../drawings/drawing"+(e+1)+".xml",Pe.DRAW),a[a.length]=ae("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=Me(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Pe.VML),a[a.length]=ae("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function m5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function p5(e,t,r){var n=G(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=jc(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ue(u)];v&&(f<0&&(f=m),h=m)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function g5(e,t,r,n){var a=p5(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&J(e,0,a)}var v5=qa,y5=ii;function w5(){}function _5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=PE(e),r}function b5(e,t,r){r==null&&(r=G(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return _c({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jv(e,r),r.slice(0,r.l)}function S5(e){var t=Nr(e);return[t]}function k5(e,t,r){return r==null&&(r=G(8)),Ha(t,r)}function j5(e){var t=Va(e);return[t]}function E5(e,t,r){return r==null&&(r=G(4)),Ga(t,r)}function T5(e){var t=Nr(e),r=e.read_shift(1);return[t,r,"b"]}function N5(e,t,r){return r==null&&(r=G(9)),Ha(t,r),r.write_shift(1,e.v?1:0),r}function C5(e){var t=Va(e),r=e.read_shift(1);return[t,r,"b"]}function A5(e,t,r){return r==null&&(r=G(5)),Ga(t,r),r.write_shift(1,e.v?1:0),r}function P5(e){var t=Nr(e),r=e.read_shift(1);return[t,r,"e"]}function O5(e,t,r){return r==null&&(r=G(9)),Ha(t,r),r.write_shift(1,e.v),r}function F5(e){var t=Va(e),r=e.read_shift(1);return[t,r,"e"]}function D5(e,t,r){return r==null&&(r=G(8)),Ga(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function R5(e){var t=Nr(e),r=e.read_shift(4);return[t,r,"s"]}function L5(e,t,r){return r==null&&(r=G(12)),Ha(t,r),r.write_shift(4,t.v),r}function M5(e){var t=Va(e),r=e.read_shift(4);return[t,r,"s"]}function I5(e,t,r){return r==null&&(r=G(8)),Ga(t,r),r.write_shift(4,t.v),r}function B5(e){var t=Nr(e),r=li(e);return[t,r,"n"]}function U5(e,t,r){return r==null&&(r=G(16)),Ha(t,r),Ia(e.v,r),r}function $5(e){var t=Va(e),r=li(e);return[t,r,"n"]}function z5(e,t,r){return r==null&&(r=G(12)),Ga(t,r),Ia(e.v,r),r}function W5(e){var t=Nr(e),r=Ev(e);return[t,r,"n"]}function H5(e,t,r){return r==null&&(r=G(12)),Ha(t,r),Tv(e.v,r),r}function V5(e){var t=Va(e),r=Ev(e);return[t,r,"n"]}function G5(e,t,r){return r==null&&(r=G(8)),Ga(t,r),Tv(e.v,r),r}function q5(e){var t=Nr(e),r=If(e);return[t,r,"is"]}function K5(e){var t=Nr(e),r=It(e);return[t,r,"str"]}function X5(e,t,r){return r==null&&(r=G(12+4*e.v.length)),Ha(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Y5(e){var t=Va(e),r=It(e);return[t,r,"str"]}function J5(e,t,r){return r==null&&(r=G(8+4*e.v.length)),Ga(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Q5(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);i[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return i}function Z5(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);i[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return i}function e8(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=li(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);i[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return i}function t8(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=It(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);i[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return i}var r8=qa,n8=ii;function a8(e,t){return t==null&&(t=G(4)),t.write_shift(4,e),t}function s8(e,t){var r=e.l+t,n=qa(e),a=Bf(e),s=It(e),i=It(e),o=It(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function i8(e,t){var r=G(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ii({s:vt(e[0]),e:vt(e[0])},r),Uf("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return yt(a||"",r),yt(e[1].Tooltip||"",r),yt("",r),r.slice(0,r.l)}function l8(){}function o8(e,t,r){var n=e.l+t,a=Nv(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Y6(e,n-e.l,r);i[1]=o}else e.l=n;return i}function c8(e,t,r){var n=e.l+t,a=qa(e),s=[a];if(r.cellFormula){var i=Q6(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function u8(e,t,r){r==null&&(r=G(18));var n=iu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var dy=["left","right","top","bottom","header","footer"];function d8(e){var t={};return dy.forEach(function(r){t[r]=li(e)}),t}function f8(e,t){return t==null&&(t=G(6*8)),cy(e),dy.forEach(function(r){Ia(e[r],t)}),t}function h8(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function x8(e,t,r){r==null&&(r=G(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function m8(e){var t=G(24);return t.write_shift(4,4),t.write_shift(4,1),ii(e,t),t}function p8(e,t){return t==null&&(t=G(16*4+2)),t.write_shift(2,e.password?Gv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function g8(){}function v8(){}function y8(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=nr(t),t.z=t.z||at[14],t.v=rr(Vt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=ha(a.cellXfs,t,a),t.l&&s["!links"].push([Ue(c),t.l]),t.c&&s["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Gf(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,i?J(e,18,I5(t,c)):J(e,7,L5(t,c))):(c.t="str",i?J(e,17,J5(t,c)):J(e,6,X5(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?J(e,13,G5(t,c)):J(e,2,H5(t,c)):i?J(e,16,z5(t,c)):J(e,5,U5(t,c)),!0;case"b":return c.t="b",i?J(e,15,A5(t,c)):J(e,4,N5(t,c)),!0;case"e":return c.t="e",i?J(e,14,D5(t,c)):J(e,3,O5(t,c)),!0}return i?J(e,12,E5(t,c)):J(e,1,k5(t,c)),!0}function w8(e,t,r,n){var a=qe(t["!ref"]||"A1"),s,i="",o=[];J(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){i=Nt(d),g5(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(o[h]=Mt(h)),s=o[h]+i;var m=c?(t[d]||[])[h]:t[s];if(!m){f=!1;continue}f=y8(e,m,d,h,n,t,f)}}J(e,146)}function _8(e,t){!t||!t["!merges"]||(J(e,177,a8(t["!merges"].length)),t["!merges"].forEach(function(r){J(e,176,n8(r))}),J(e,178))}function b8(e,t){!t||!t["!cols"]||(J(e,390),t["!cols"].forEach(function(r,n){r&&J(e,60,u8(n,r))}),J(e,391))}function S8(e,t){!t||!t["!ref"]||(J(e,648),J(e,649,m8(qe(t["!ref"]))),J(e,650))}function k8(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Me(r,-1,n[1].Target.replace(/#.*$/,""),Pe.HLINK);J(e,494,i8(n,a))}}),delete t["!links"]}function j8(e,t,r,n){if(t["!comments"].length>0){var a=Me(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pe.VML);J(e,551,Uf("rId"+a)),t["!legacy"]=a}}function E8(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:ot(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=fr(s);o.s.r==o.e.r&&(o.e.r=fr(t["!ref"]).e.r,s=ot(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),J(e,161,ii(qe(s))),J(e,162)}}function T8(e,t,r){J(e,133),J(e,137,x8(t,r)),J(e,138),J(e,134)}function N8(e,t){t["!protect"]&&J(e,535,p8(t["!protect"]))}function C8(e,t,r,n){var a=tr(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=qe(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],J(a,129),(r.vbaraw||i["!outline"])&&J(a,147,b5(o,i["!outline"])),J(a,148,y5(c)),T8(a,i,r.Workbook),b8(a,i),w8(a,i,e,t),N8(a,i),E8(a,i,r,e),_8(a,i),k8(a,i,n),i["!margins"]&&J(a,476,f8(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&S8(a,i),j8(a,i,e,n),J(a,130),a.end()}function A8(e,t){e.l+=10;var r=It(e);return{name:r}}var P8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function O8(e){return!e.Workbook||!e.Workbook.WBProps?"false":cE(e.Workbook.WBProps.date1904)?"true":"false"}var F8="][*?/\\".split("");function fy(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return F8.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function D8(e,t,r){e.forEach(function(n,a){fy(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function R8(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];D8(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)n5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function hy(e){var t=[ct];t[t.length]=ae("workbook",null,{xmlns:ai[0],"xmlns:r":gt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(P8.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ae("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:Ie(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ae("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ae("definedName",Ie(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function L8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pd(e),r.name=It(e),r}function M8(e,t){return t||(t=G(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Uf(e.strRelID,t),yt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function I8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?It(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function B8(e,t){t||(t=G(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),jv(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function U8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=OE(e),i=J6(e,0,r),o=Bf(e);e.l=n;var c={Name:s,Ptg:i};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function $8(e,t){J(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};J(e,156,M8(a))}J(e,144)}function z8(e,t){t||(t=G(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return yt("SheetJS",t),yt(xc.version,t),yt(xc.version,t),yt("7262",t),t.length>t.l?t.slice(0,t.l):t}function W8(e,t){t||(t=G(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function H8(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(J(e,135),J(e,158,W8(a)),J(e,136))}}function V8(e,t){var r=tr();return J(r,131),J(r,128,z8()),J(r,153,B8(e.Workbook&&e.Workbook.WBProps||null)),H8(r,e),$8(r,e),J(r,132),r.end()}function G8(e,t,r){return(t.slice(-4)===".bin"?V8:hy)(e)}function q8(e,t,r,n,a){return(t.slice(-4)===".bin"?C8:uy)(e,r,n,a)}function K8(e,t,r){return(t.slice(-4)===".bin"?fN:Xv)(e,r)}function X8(e,t,r){return(t.slice(-4)===".bin"?BT:Vv)(e,r)}function Y8(e,t,r){return(t.slice(-4)===".bin"?NN:ey)(e)}function J8(e){return(e.slice(-4)===".bin"?wN:Qv)()}function Q8(e,t){var r=[];return e.Props&&r.push(KE(e.Props,t)),e.Custprops&&r.push(XE(e.Props,e.Custprops)),r.join("")}function Z8(){return""}function eC(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(ae("NumberFormat",null,{"ss:Format":Ie(at[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(ae("Style",s.join(""),i))}),ae("Styles",r.join(""))}function xy(e){return ae("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hf(e.Ref,{r:0,c:0})})}function tC(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(xy(a)))}return ae("Names",r.join(""))}function rC(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(xy(o)))}return s.join("")}function nC(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ae("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ae("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ae("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ae("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Et("ProtectContents","True")),e["!protect"].objects&&a.push(Et("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Et("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Et("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Et("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ae("WorksheetOptions",a.join(""),{xmlns:lr.x})}function aC(e){return e.map(function(t){var r=oE(t.t||""),n=ae("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ae("Comment",n,{"ss:Author":t.a})}).join("")}function sC(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ie(Hf(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=vt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ie(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ie(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Ml[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||at[14]);break;case"s":f="String",h=lE(e.v||"");break}var m=ha(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var v=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=aC(e.c)),ae("Cell",x,o)}function iC(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Kv(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function lC(e,t,r,n){if(!e["!ref"])return"";var a=qe(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,y){zf(w);var p=!!w.width,g=iu(y,w),b={"ss:Index":y+1};p&&(b["ss:Width"]=Sc(g.width)),w.hidden&&(b["ss:Hidden"]="1"),o.push(ae("Column",null,b))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[iC(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>f)&&!(s[i].s.r>u)&&!(s[i].e.c<f)&&!(s[i].e.r<u)){(s[i].s.c!=f||s[i].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},v=Ue(m),x=c?(e[u]||[])[f]:e[v];d.push(sC(x,v,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function oC(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?rC(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?lC(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(nC(s,t,e,r)),n.join("")}function cC(e,t){t||(t={}),e.SSF||(e.SSF=nr(at)),e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ha(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Q8(e,t)),r.push(Z8()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ae("Worksheet",oC(n,t,e),{"ss:Name":Ie(e.SheetNames[n])}));return r[2]=eC(e,t),r[3]=tC(e),ct+ae("Workbook",r.join(""),{xmlns:lr.ss,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:ss":lr.ss,"xmlns:dt":lr.dt,"xmlns:html":lr.html})}var e0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function uC(e,t){var r=[],n=[],a=[],s=0,i,o=am(gm,"n"),c=am(vm,"n");if(e.Props)for(i=At(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=At(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)Iv.indexOf(a[s][0])>-1||Rv.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&ze.utils.cfb_add(t,"/SummaryInformation",Sm(n,e0.SI,c,vm)),(r.length||u.length)&&ze.utils.cfb_add(t,"/DocumentSummaryInformation",Sm(r,e0.DSI,o,gm,u.length?u:null,e0.UDI))}function dC(e,t){var r=t||{},n=ze.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ze.utils.cfb_add(n,a,my(e,r)),r.biff==8&&(e.Props||e.Custprops)&&uC(e,n),r.biff==8&&e.vbaraw&&CN(n,ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var fC={0:{f:m5},1:{f:S5},2:{f:W5},3:{f:P5},4:{f:T5},5:{f:B5},6:{f:K5},7:{f:R5},8:{f:t8},9:{f:e8},10:{f:Q5},11:{f:Z5},12:{f:j5},13:{f:V5},14:{f:F5},15:{f:C5},16:{f:$5},17:{f:Y5},18:{f:M5},19:{f:If},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:U8},40:{},42:{},43:{f:KT},44:{f:GT},45:{f:JT},46:{f:ZT},47:{f:QT},48:{},49:{f:jE},50:{},51:{f:mN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ET},62:{f:q5},63:{f:_N},64:{f:g8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:h8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_5},148:{f:v5,p:16},151:{f:l8},152:{},153:{f:I8},154:{},155:{},156:{f:L8},157:{},158:{},159:{T:1,f:LT},160:{T:-1},161:{T:1,f:qa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:r8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hN},336:{T:-1},337:{f:vN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:wT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:o8},427:{f:c8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:d8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:w5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:s8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EN},633:{T:1},634:{T:-1},635:{T:1,f:kN},636:{T:-1},637:{f:CE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:A8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:v8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function se(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Rf(r)&&e.push(r)}}function hC(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return se(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Bl(e,t,r){return e||(e=G(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function xC(e,t,r,n){var a=G(9);return Bl(a,e,t),Uv(r,n||"b",a),a}function mC(e,t,r){var n=G(8+2*r.length);return Bl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function pC(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?rr(Vt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?se(e,2,AT(r,n,a)):se(e,3,CT(r,n,a));return;case"b":case"e":se(e,5,xC(r,n,t.v,t.t));return;case"s":case"str":se(e,4,mC(r,n,(t.v||"").slice(0,255)));return}se(e,1,Bl(null,r,n))}function gC(e,t,r,n){var a=Array.isArray(t),s=qe(t["!ref"]||"A1"),i,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=ot(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Nt(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Mt(d)),i=c[d]+o;var f=a?(t[u]||[])[d]:t[i];f&&pC(e,f,u,d)}}}function vC(e,t){for(var r=t||{},n=tr(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return se(n,r.biff==4?1033:r.biff==3?521:9,$f(e,16,r)),gC(n,e.Sheets[e.SheetNames[a]],a,r),se(n,10),n.end()}function yC(e,t,r){se(e,49,fT({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function wC(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&se(e,1054,mT(a,t[a],r))})}function _C(e,t){var r=G(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),se(e,2151,r),r=G(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Wv(qe(t["!ref"]||"A1"),r),r.write_shift(4,4),se(e,2152,r)}function bC(e,t){for(var r=0;r<16;++r)se(e,224,jm({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){se(e,224,jm(n,0,t))})}function SC(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];se(e,440,ST(n)),n[1].Tooltip&&se(e,2048,kT(n))}delete t["!links"]}function kC(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&se(e,125,TT(iu(a,n),a))})}}function jC(e,t,r,n,a){var s=16+ha(a.cellXfs,t,a);if(t.v==null&&!t.bf){se(e,513,Ba(r,n,s));return}if(t.bf)se(e,6,X6(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?rr(Vt(t.v)):t.v;se(e,515,yT(r,n,i,s));break;case"b":case"e":se(e,517,vT(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Gf(a.Strings,t.v,a.revStrings);se(e,253,hT(r,n,o,s))}else se(e,516,xT(r,n,(t.v||"").slice(0,255),s,a));break;default:se(e,513,Ba(r,n,s))}}function EC(e,t,r){var n=tr(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],m=qe(s["!ref"]||"A1"),v=u?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}se(n,2057,$f(r,16,t)),se(n,13,gr(1)),se(n,12,gr(100)),se(n,15,Wt(!0)),se(n,17,Wt(!1)),se(n,16,Ia(.001)),se(n,95,Wt(!0)),se(n,42,Wt(!1)),se(n,43,Wt(!1)),se(n,130,gr(1)),se(n,128,gT()),se(n,131,Wt(!1)),se(n,132,Wt(!1)),u&&kC(n,s["!cols"]),se(n,512,pT(m,t)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=Nt(x);for(var w=m.s.c;w<=m.e.c;++w){x===m.s.r&&(h[w]=Mt(w)),d=h[w]+f;var y=c?(s[x]||[])[w]:s[d];y&&(jC(n,y,x,w,t),u&&y.l&&s["!links"].push([d,y.l]))}}var p=o.CodeName||o.name||a;return u&&se(n,574,dT((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&se(n,229,bT(s["!merges"])),u&&SC(n,s),se(n,442,zv(p)),u&&_C(n,s),se(n,10),n.end()}function TC(e,t,r){var n=tr(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(se(n,2057,$f(e,5,r)),r.bookType=="xla"&&se(n,135),se(n,225,o?gr(1200):null),se(n,193,QE(2)),c&&se(n,191),c&&se(n,192),se(n,226),se(n,92,lT("SheetJS",r)),se(n,66,gr(o?1200:1252)),o&&se(n,353,gr(0)),o&&se(n,448),se(n,317,NT(e.SheetNames.length)),o&&e.vbaraw&&se(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";se(n,442,zv(u))}se(n,156,gr(17)),se(n,25,Wt(!1)),se(n,18,Wt(!1)),se(n,19,gr(0)),o&&se(n,431,Wt(!1)),o&&se(n,444,gr(0)),se(n,61,uT()),se(n,64,Wt(!1)),se(n,141,gr(0)),se(n,34,Wt(O8(e)=="true")),se(n,14,Wt(!0)),o&&se(n,439,Wt(!1)),se(n,218,gr(0)),yC(n,e,r),wC(n,e.SSF,r),bC(n,r),o&&se(n,352,Wt(!1));var d=n.end(),f=tr();o&&se(f,140,jT()),o&&r.Strings&&hC(f,252,cT(r.Strings)),se(f,10);var h=f.end(),m=tr(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var w=d.length+v+h.length;for(x=0;x<e.SheetNames.length;++x){var y=s[x]||{};se(m,133,oT({pos:w,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),w+=t[x].length}var p=m.end();if(v!=p.length)throw new Error("BS8 "+v+" != "+p.length);var g=[];return d.length&&g.push(d),p.length&&g.push(p),h.length&&g.push(h),jt(g)}function NC(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=nr(at)),e&&e.SSF&&(tu(),eu(e.SSF),r.revssf=ru(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qf(r),r.cellXfs=[],ha(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=EC(a,r,e);return n.unshift(TC(e,n,r)),jt(n)}function my(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=fr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return NC(e,t);case 4:case 3:case 2:return vC(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function CC(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=Ue({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||iE(f.w||(An(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,s.push(ae("td",h,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var AC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PC="</body></html>";function OC(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function py(e,t){var r=t||{},n=r.header!=null?r.header:AC,a=r.footer!=null?r.footer:PC,s=[n],i=fr(e["!ref"]);r.dense=Array.isArray(e),s.push(OC(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(CC(e,i,o,r));return s.push("</table>"+a),s.join("")}function gy(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?vt(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=fr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),v=0,x=0,w=0,y=0,p=0,g=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&x<c;++v){var b=o[v];if(Om(b)){if(n.display)continue;m[x]={hidden:!0}}var j=b.children;for(w=y=0;w<j.length;++w){var A=j[w];if(!(n.display&&Om(A))){var k=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):uE(A.innerHTML),D=A.getAttribute("data-z")||A.getAttribute("z");for(h=0;h<f.length;++h){var _=f[h];_.s.c==y+s&&_.s.r<x+a&&x+a<=_.e.r&&(y=_.e.c+1-s,h=-1)}g=+A.getAttribute("colspan")||1,((p=+A.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:x+a,c:y+s},e:{r:x+a+(p||1)-1,c:y+s+(g||1)-1}});var N={t:"s",v:k},B=A.getAttribute("data-t")||A.getAttribute("t")||"";k!=null&&(k.length==0?N.t=B||"z":n.raw||k.trim().length==0||B=="s"||(k==="TRUE"?N={t:"b",v:!0}:k==="FALSE"?N={t:"b",v:!1}:isNaN(bn(k))?isNaN(vl(k).getDate())||(N={t:"d",v:Vt(k)},n.cellDates||(N={t:"n",v:rr(N.v)}),N.z=n.dateNF||at[14]):N={t:"n",v:bn(k)})),N.z===void 0&&D!=null&&(N.z=D);var q="",Z=A.getElementsByTagName("A");if(Z&&Z.length)for(var _e=0;_e<Z.length&&!(Z[_e].hasAttribute("href")&&(q=Z[_e].getAttribute("href"),q.charAt(0)!="#"));++_e);q&&q.charAt(0)!="#"&&(N.l={Target:q}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][y+s]=N):e[Ue({c:y+s,r:x+a})]=N,u.e.c<y+s&&(u.e.c=y+s),y+=g}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+a),e["!ref"]=ot(u),x>=c&&(e["!fullref"]=ot((u.e.r=o.length-v+x-1+a,u))),e}function vy(e,t){var r=t||{},n=r.dense?[]:{};return gy(n,e,t)}function FC(e,t){return Wa(vy(e,t),t)}function Om(e){var t="",r=DC(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function DC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var RC=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ct+t}}(),Fm=function(){var e=function(s){return Ie(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var c=[];c.push('      <table:table table:name="'+Ie(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=fr(s["!ref"]||"A1"),h=s["!merges"]||[],m=0,v=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,p={},g="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(y=!0),p["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,p["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var b=Ue({r:u,c:d}),j=v?(s[u]||[])[d]:s[b];if(j&&j.f&&(p["table:formula"]=Ie(t5(j.f)),j.F&&j.F.slice(0,b.length)==b)){var A=fr(j.F);p["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,p["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":g=j.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=j.v?"true":"false";break;case"n":g=j.w||String(j.v||0),p["office:value-type"]="float",p["office:value"]=j.v||0;break;case"s":case"str":g=j.v==null?"":j.v,p["office:value-type"]="string";break;case"d":g=j.w||Vt(j.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Vt(j.v).toISOString(),p["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(g);if(j.l&&j.l.Target){var D=j.l.Target;D=D.charAt(0)=="#"?"#"+r5(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),k=ae("text:a",k,{"xlink:href":D.replace(/&/g,"&amp;")})}c.push("          "+ae("table:table-cell",ae("text:p",k,{}),p)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;zf(f),f.ods=o;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var c=[ct],u=wl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=wl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Fv().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function yy(e,t){if(t.bookType=="fods")return Fm(e,t);var r=Pf(),n="",a=[],s=[];return n="mimetype",je(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",je(r,n,Fm(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",je(r,n,RC(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",je(r,n,ct+Fv()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",je(r,n,qE(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",je(r,n,VE(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ec(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function LC(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Mr(yl(e))}function MC(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function oa(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function IC(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function _l(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Re(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ls(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=_l(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=_l(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function bt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Re(n*8+a.type)),a.type==2&&t.push(Re(a.data.length)),t.push(a.data))})}),oa(t)}function Ar(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=_l(e,n),s=ft(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ls(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=ft(o.data),u=Ls(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=Ls(s[3][0].data)>>>0>0),r.push(i)}return r}function as(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Re(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Re(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Re(i.data.length)}],n[2].push({data:bt(i.meta),type:2})});var s=bt(n);t.push(Re(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),oa(t)}function BC(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=_l(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[oa(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=oa(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Pr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(BC(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return oa(t)}function ss(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Re(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return oa(t)}function t0(e,t){var r=new Uint8Array(32),n=Ec(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,IC(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function r0(e,t){var r=new Uint8Array(32),n=Ec(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function In(e){var t=ft(e);return _l(t[1][0].data)}function UC(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Ls(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Ec(e[7][0].data),d=0,f=[],h=Ec(e[4][0].data),m=0,v=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,m,!0);var w,y;switch(typeof t[x]){case"string":w=t0({t:"s",v:t[x]},r),y=r0({t:"s",v:t[x]},r);break;case"number":w=t0({t:"n",v:t[x]},r),y=r0({t:"n",v:t[x]},r);break;case"boolean":w=t0({t:"b",v:t[x]},r),y=r0({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(w),d+=w.length,v.push(y),m+=y.length,++c}for(e[2][0].data=Re(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=oa(f),e[3][0].data=oa(v),c}function $C(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=fr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ot(n)));var s=Tc(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(M){typeof M=="string"&&i.push(M)})});var o={},c=[],u=ze.read(t.numbers,{type:"base64"});u.FileIndex.map(function(H,M){return[H,u.FullPaths[M]]}).forEach(function(H){var M=H[0],L=H[1];if(M.type==2&&M.name.match(/\.iwa/)){var X=M.content,ue=Pr(X),ge=Ar(ue);ge.forEach(function(me){c.push(me.id),o[me.id]={deps:[],location:L,type:Ls(me.messages[0].meta[1][0].data)}})}}),c.sort(function(H,M){return H-M});var d=c.filter(function(H){return H>1}).map(function(H){return[H,Re(H)]});u.FileIndex.map(function(H,M){return[H,u.FullPaths[M]]}).forEach(function(H){var M=H[0];if(H[1],!!M.name.match(/\.iwa/)){var L=Ar(Pr(M.content));L.forEach(function(X){X.messages.forEach(function(ue){d.forEach(function(ge){X.messages.some(function(me){return Ls(me.meta[1][0].data)!=11006&&MC(me.data,ge[1])})&&o[ge[0]].deps.push(X.id)})})})}});for(var f=ze.find(u,o[1].location),h=Ar(Pr(f.content)),m,v=0;v<h.length;++v){var x=h[v];x.id==1&&(m=x)}var w=In(ft(m.messages[0].data)[1][0].data);for(f=ze.find(u,o[w].location),h=Ar(Pr(f.content)),v=0;v<h.length;++v)x=h[v],x.id==w&&(m=x);for(w=In(ft(m.messages[0].data)[2][0].data),f=ze.find(u,o[w].location),h=Ar(Pr(f.content)),v=0;v<h.length;++v)x=h[v],x.id==w&&(m=x);for(w=In(ft(m.messages[0].data)[2][0].data),f=ze.find(u,o[w].location),h=Ar(Pr(f.content)),v=0;v<h.length;++v)x=h[v],x.id==w&&(m=x);var y=ft(m.messages[0].data);{y[6][0].data=Re(n.e.r+1),y[7][0].data=Re(n.e.c+1);var p=In(y[46][0].data),g=ze.find(u,o[p].location),b=Ar(Pr(g.content));{for(var j=0;j<b.length&&b[j].id!=p;++j);if(b[j].id!=p)throw"Bad ColumnRowUIDMapArchive";var A=ft(b[j].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var k=0;k<=n.e.c;++k){var D=[];D[1]=D[2]=[{type:0,data:Re(k+420690)}],A[1].push({type:2,data:bt(D)}),A[2].push({type:0,data:Re(k)}),A[3].push({type:0,data:Re(k)})}A[4]=[],A[5]=[],A[6]=[];for(var _=0;_<=n.e.r;++_)D=[],D[1]=D[2]=[{type:0,data:Re(_+726270)}],A[4].push({type:2,data:bt(D)}),A[5].push({type:0,data:Re(_)}),A[6].push({type:0,data:Re(_)});b[j].messages[0].data=bt(A)}g.content=ss(as(b)),g.size=g.content.length,delete y[46];var N=ft(y[4][0].data);{N[7][0].data=Re(n.e.r+1);var B=ft(N[1][0].data),q=In(B[2][0].data);g=ze.find(u,o[q].location),b=Ar(Pr(g.content));{if(b[0].id!=q)throw"Bad HeaderStorageBucket";var Z=ft(b[0].messages[0].data);for(_=0;_<s.length;++_){var _e=ft(Z[2][0].data);_e[1][0].data=Re(_),_e[4][0].data=Re(s[_].length),Z[2][_]={type:Z[2][0].type,data:bt(_e)}}b[0].messages[0].data=bt(Z)}g.content=ss(as(b)),g.size=g.content.length;var ce=In(N[2][0].data);g=ze.find(u,o[ce].location),b=Ar(Pr(g.content));{if(b[0].id!=ce)throw"Bad HeaderStorageBucket";for(Z=ft(b[0].messages[0].data),k=0;k<=n.e.c;++k)_e=ft(Z[2][0].data),_e[1][0].data=Re(k),_e[4][0].data=Re(n.e.r+1),Z[2][k]={type:Z[2][0].type,data:bt(_e)};b[0].messages[0].data=bt(Z)}g.content=ss(as(b)),g.size=g.content.length;var we=In(N[4][0].data);(function(){for(var H=ze.find(u,o[we].location),M=Ar(Pr(H.content)),L,X=0;X<M.length;++X){var ue=M[X];ue.id==we&&(L=ue)}var ge=ft(L.messages[0].data);{ge[3]=[];var me=[];i.forEach(function(I,ye){me[1]=[{type:0,data:Re(ye)}],me[2]=[{type:0,data:Re(1)}],me[3]=[{type:2,data:LC(I)}],ge[3].push({type:2,data:bt(me)})})}L.messages[0].data=bt(ge);var le=as(M),Fe=ss(le);H.content=Fe,H.size=H.content.length})();var pe=ft(N[3][0].data);{var Q=pe[1][0];delete pe[2];var re=ft(Q.data);{var xe=In(re[2][0].data);(function(){for(var H=ze.find(u,o[xe].location),M=Ar(Pr(H.content)),L,X=0;X<M.length;++X){var ue=M[X];ue.id==xe&&(L=ue)}var ge=ft(L.messages[0].data);{delete ge[6],delete pe[7];var me=new Uint8Array(ge[5][0].data);ge[5]=[];for(var le=0,Fe=0;Fe<=n.e.r;++Fe){var I=ft(me);le+=UC(I,s[Fe],i),I[1][0].data=Re(Fe),ge[5].push({data:bt(I),type:2})}ge[1]=[{type:0,data:Re(n.e.c+1)}],ge[2]=[{type:0,data:Re(n.e.r+1)}],ge[3]=[{type:0,data:Re(le)}],ge[4]=[{type:0,data:Re(n.e.r+1)}]}L.messages[0].data=bt(ge);var ye=as(M),ve=ss(ye);H.content=ve,H.size=H.content.length})()}Q.data=bt(re)}N[3][0].data=bt(pe)}y[4][0].data=bt(N)}m.messages[0].data=bt(y);var Ee=as(h),R=ss(Ee);return f.content=R,f.size=f.content.length,u}function zC(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function qf(e){zC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function WC(e,t){return t.bookType=="ods"?yy(e,t):t.bookType=="numbers"?$C(e,t):t.bookType=="xlsb"?HC(e,t):VC(e,t)}function HC(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=nr(at)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=ty.indexOf(t.bookType)>-1,a=Av();qf(t=t||{});var s=Pf(),i="",o=0;if(t.cellXfs=[],ha(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",je(s,i,Dv(e.Props,t)),a.coreprops.push(i),Me(t.rels,2,i,Pe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,je(s,i,Lv(e.Props)),a.extprops.push(i),Me(t.rels,3,i,Pe.EXT_PROPS),e.Custprops!==e.Props&&At(e.Custprops||{}).length>0&&(i="docProps/custom.xml",je(s,i,Mv(e.Custprops)),a.custprops.push(i),Me(t.rels,4,i,Pe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,je(s,i,q8(o-1,i,t,e,d)),a.sheets.push(i),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pe.WS[0])}if(f){var m=f["!comments"],v=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,je(s,x,Y8(m,x)),a.comments.push(x),Me(d,-1,"../comments"+o+"."+r,Pe.CMNT),v=!0),f["!legacy"]&&v&&je(s,"xl/drawings/vmlDrawing"+o+".vml",Zv(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&je(s,Ov(i),Ds(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,je(s,i,X8(t.Strings,i,t)),a.strs.push(i),Me(t.wbrels,-1,"sharedStrings."+r,Pe.SST)),i="xl/workbook."+r,je(s,i,G8(e,i)),a.workbooks.push(i),Me(t.rels,1,i,Pe.WB),i="xl/theme/theme1.xml",je(s,i,Jv(e.Themes,t)),a.themes.push(i),Me(t.wbrels,-1,"theme/theme1.xml",Pe.THEME),i="xl/styles."+r,je(s,i,K8(e,i,t)),a.styles.push(i),Me(t.wbrels,-1,"styles."+r,Pe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",je(s,i,e.vbaraw),a.vba.push(i),Me(t.wbrels,-1,"vbaProject.bin",Pe.VBA)),i="xl/metadata."+r,je(s,i,J8(i)),a.metadata.push(i),Me(t.wbrels,-1,"metadata."+r,Pe.XLMETA),je(s,"[Content_Types].xml",Pv(a,t)),je(s,"_rels/.rels",Ds(t.rels)),je(s,"xl/_rels/workbook."+r+".rels",Ds(t.wbrels)),delete t.revssf,delete t.ssf,s}function VC(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=nr(at)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=ty.indexOf(t.bookType)>-1,a=Av();qf(t=t||{});var s=Pf(),i="",o=0;if(t.cellXfs=[],ha(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",je(s,i,Dv(e.Props,t)),a.coreprops.push(i),Me(t.rels,2,i,Pe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,je(s,i,Lv(e.Props)),a.extprops.push(i),Me(t.rels,3,i,Pe.EXT_PROPS),e.Custprops!==e.Props&&At(e.Custprops||{}).length>0&&(i="docProps/custom.xml",je(s,i,Mv(e.Custprops)),a.custprops.push(i),Me(t.rels,4,i,Pe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,je(s,i,uy(o-1,t,e,f)),a.sheets.push(i),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pe.WS[0])}if(h){var v=h["!comments"],x=!1,w="";if(v&&v.length>0){var y=!1;v.forEach(function(p){p[1].forEach(function(g){g.T==!0&&(y=!0)})}),y&&(w="xl/threadedComments/threadedComment"+o+"."+r,je(s,w,bN(v,d,t)),a.threadedcomments.push(w),Me(f,-1,"../threadedComments/threadedComment"+o+"."+r,Pe.TCMNT)),w="xl/comments"+o+"."+r,je(s,w,ey(v)),a.comments.push(w),Me(f,-1,"../comments"+o+"."+r,Pe.CMNT),x=!0}h["!legacy"]&&x&&je(s,"xl/drawings/vmlDrawing"+o+".vml",Zv(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&je(s,Ov(i),Ds(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,je(s,i,Vv(t.Strings,t)),a.strs.push(i),Me(t.wbrels,-1,"sharedStrings."+r,Pe.SST)),i="xl/workbook."+r,je(s,i,hy(e)),a.workbooks.push(i),Me(t.rels,1,i,Pe.WB),i="xl/theme/theme1.xml",je(s,i,Jv(e.Themes,t)),a.themes.push(i),Me(t.wbrels,-1,"theme/theme1.xml",Pe.THEME),i="xl/styles."+r,je(s,i,Xv(e,t)),a.styles.push(i),Me(t.wbrels,-1,"styles."+r,Pe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",je(s,i,e.vbaraw),a.vba.push(i),Me(t.wbrels,-1,"vbaProject.bin",Pe.VBA)),i="xl/metadata."+r,je(s,i,Qv()),a.metadata.push(i),Me(t.wbrels,-1,"metadata."+r,Pe.XLMETA),d.length>1&&(i="xl/persons/person.xml",je(s,i,SN(d)),a.people.push(i),Me(t.wbrels,-1,"persons/person.xml",Pe.PEOPLE)),je(s,"[Content_Types].xml",Pv(a,t)),je(s,"_rels/.rels",Ds(t.rels)),je(s,"xl/_rels/workbook."+r+".rels",Ds(t.wbrels)),delete t.revssf,delete t.ssf,s}function GC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wy(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Rl(t.file,ze.write(e,{type:Oe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ze.write(e,t)}function qC(e,t){var r=nr(t||{}),n=WC(e,r);return KC(n,r)}function KC(e,t){var r={},n=Oe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Zc(a))}return t.password&&typeof encrypt_agile<"u"?wy(encrypt_agile(a,t.password),t):t.type==="file"?Rl(t.file,a):t.type=="string"?$i(a):a}function XC(e,t){var r=t||{},n=dC(e,r);return wy(n,r)}function Qr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return gl(yl(n));case"binary":return yl(n);case"string":return e;case"file":return Rl(t.file,n,"utf8");case"buffer":return Oe?Fn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Qr(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function YC(e,t){switch(t.type){case"base64":return gl(e);case"binary":return e;case"string":return e;case"file":return Rl(t.file,e,"binary");case"buffer":return Oe?Fn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bo(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?gl(r):t.type=="string"?$i(r):r;case"file":return Rl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function _y(e,t){kj(),R8(e);var r=nr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=_y(e,r);return r.type="array",Zc(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qr(cC(e,r),r);case"slk":case"sylk":return Qr(OT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Qr(py(e.Sheets[e.SheetNames[a]],r),r);case"txt":return YC(by(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Qr(Kf(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Qr(FT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return bo(PT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Qr(DT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Qr($T.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Qr(Hv.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Qr(yy(e,r),r);case"wk1":return bo(Em.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return bo(Em.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bo(my(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),XC(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return qC(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function JC(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function QC(e,t,r){var n={};return n.type="file",n.file=t,JC(n),_y(e,n)}function ZC(e,t,r,n,a,s,i,o){var c=Nt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var v=i?e[r][m]:e[n[m]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[m]!=null&&(h[s[m]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(x==null)if(v.t=="e"&&x===null)h[s[m]]=null;else if(u!==void 0)h[s[m]]=u;else if(d&&x===null)h[s[m]]=null;else continue;else h[s[m]]=d&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:An(v,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function Tc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=qe(d);break;case"number":c=qe(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Nt(c.s.r),h=[],m=[],v=0,x=0,w=Array.isArray(e),y=c.s.r,p=0,g={};w&&!e[y]&&(e[y]=[]);var b=u.skipHidden&&e["!cols"]||[],j=u.skipHidden&&e["!rows"]||[];for(p=c.s.c;p<=c.e.c;++p)if(!(b[p]||{}).hidden)switch(h[p]=Mt(p),r=w?e[y][p]:e[h[p]+f],n){case 1:s[p]=p-c.s.c;break;case 2:s[p]=h[p];break;case 3:s[p]=u.header[p-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=An(r,null,u),x=g[i]||0,!x)g[i]=1;else{do o=i+"_"+x++;while(g[o]);g[i]=x,g[o]=1}s[p]=o}for(y=c.s.r+a;y<=c.e.r;++y)if(!(j[y]||{}).hidden){var A=ZC(e,c,y,h,n,s,w,u);(A.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[v++]=A.row)}return m.length=v,m}var Dm=/"/g;function eA(e,t,r,n,a,s,i,o){for(var c=!0,u=[],d="",f=Nt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:An(m,null,o));for(var v=0,x=0;v!==d.length;++v)if((x=d.charCodeAt(v))===a||x===s||x===34||o.forceQuotes){d='"'+d.replace(Dm,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Dm,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function Kf(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(f[v]=Mt(v));for(var x=0,w=a.s.r;w<=a.e.r;++w)(m[w]||{}).hidden||(d=eA(e,a,w,f,i,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function by(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Kf(e,t);return r}function tA(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=qe(e["!ref"]),s="",i=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Mt(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=Nt(d),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Sy(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?vt(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=qe(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+a)}else i==-1&&(i=0,d.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(x,w){At(x).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var p=x[y],g="z",b="",j=Ue({c:o+m,r:i+w+a});u=bl(s,j),p&&typeof p=="object"&&!(p instanceof Date)?s[j]=p:(typeof p=="number"?g="n":typeof p=="boolean"?g="b":typeof p=="string"?g="s":p instanceof Date?(g="d",n.cellDates||(g="n",p=rr(p)),b=n.dateNF||at[14]):p===null&&n.nullError&&(g="e",p=0),u?(u.t=g,u.v=p,delete u.w,delete u.R,b&&(u.z=b)):s[j]=u={t:g,v:p},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var v=Nt(i);if(a)for(m=0;m<h.length;++m)s[Mt(m+o)+v]={t:"s",v:h[m]};return s["!ref"]=ot(d),s}function rA(e,t){return Sy(null,e,t)}function bl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=vt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bl(e,Ue(t)):bl(e,Ue({r:t,c:r||0}))}function nA(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function aA(){return{SheetNames:[],Sheets:{}}}function sA(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(fy(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function iA(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=nA(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function lA(e,t){return e.z=t,e}function ky(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function oA(e,t,r){return ky(e,"#"+t,r)}function cA(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function uA(e,t,r,n){for(var a=typeof t!="string"?t:qe(t),s=typeof t=="string"?t:ot(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=bl(e,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var n0={encode_col:Mt,encode_row:Nt,encode_cell:Ue,encode_range:ot,decode_col:Mf,decode_row:Lf,split_cell:kE,decode_cell:vt,decode_range:fr,format_cell:An,sheet_add_aoa:kv,sheet_add_json:Sy,sheet_add_dom:gy,aoa_to_sheet:si,json_to_sheet:rA,table_to_sheet:vy,table_to_book:FC,sheet_to_csv:Kf,sheet_to_txt:by,sheet_to_json:Tc,sheet_to_html:py,sheet_to_formulae:tA,sheet_to_row_object_array:Tc,sheet_get_cell:bl,book_new:aA,book_append_sheet:sA,book_set_sheet_visibility:iA,cell_set_number_format:lA,cell_set_hyperlink:ky,cell_set_internal_link:oA,cell_add_comment:cA,sheet_set_array_formula:uA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function dA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState([]),[o,c]=T.useState(!0),[u,d]=T.useState(""),[f,h]=T.useState(!1),[m,v]=T.useState(!1),[x,w]=T.useState(!1),[y,p]=T.useState(!1),[g,b]=T.useState(null),[j,A]=T.useState(null),[k,D]=T.useState([]),[_,N]=T.useState([]),[B,q]=T.useState([]),[Z,_e]=T.useState(null),[ce,we]=T.useState(""),[pe,Q]=T.useState({judul:"",tipe:"biasa",deskripsi:"",deadline:"",kelas_id:"",mapel_id:""}),[re,xe]=T.useState({pertanyaan:"",opsi_a:"",opsi_b:"",opsi_c:"",opsi_d:"",kunci:"a"});T.useEffect(()=>{e&&Ee()},[e]);async function Ee(){var I,ye;try{const[ve,Pt,De]=await Promise.all([Y.from("tasks").select(`
            *,
            class:classes(
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            ),
            subject:subjects(nama_mapel)
          `).eq("guru_id",e==null?void 0:e.id).order("created_at",{ascending:!1}),Y.from("schedules").select(`
            class:classes(
              id,
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            )
          `).eq("guru_id",e==null?void 0:e.id),Y.from("schedules").select(`
            subject:subjects(id, nama_mapel)
          `).eq("guru_id",e==null?void 0:e.id)]);if(ve.error)throw ve.error;if(Pt.error)throw Pt.error;if(De.error)throw De.error;r(ve.data||[]);const de=((I=Pt.data)==null?void 0:I.map(ut=>ut.class).filter(Boolean))||[],Ot=((ye=De.data)==null?void 0:ye.map(ut=>ut.subject).filter(Boolean))||[];a(de),i(Ot)}catch(ve){console.error("Error fetching data:",ve)}finally{c(!1)}}async function R(I){I.preventDefault();try{const ye={guru_id:e==null?void 0:e.id,kelas_id:pe.kelas_id,mapel_id:pe.mapel_id,judul:pe.judul,tipe:pe.tipe,deskripsi:pe.deskripsi,deadline:pe.deadline};if(g){const{error:ve}=await Y.from("tasks").update(ye).eq("id",g.id);if(ve)throw ve}else{const{error:ve}=await Y.from("tasks").insert(ye);if(ve)throw ve}h(!1),b(null),Q({judul:"",tipe:"biasa",deskripsi:"",deadline:"",kelas_id:"",mapel_id:""}),Ee()}catch(ye){alert("Error: "+ye.message)}}async function H(I){if(confirm(`Hapus tugas "${I.judul}"?`))try{const{error:ye}=await Y.from("tasks").delete().eq("id",I.id);if(ye)throw ye;Ee()}catch(ye){alert("Error: "+ye.message)}}async function M(I){try{const{data:ye,error:ve}=await Y.from("task_submissions").select(`
          id,
          siswa_id,
          file_url,
          jawaban_text,
          nilai,
          submitted_at,
          graded_at,
          student:users(nama, email)
        `).eq("task_id",I).order("submitted_at",{ascending:!1});if(ve)throw ve;N(ye||[])}catch(ye){console.error("Error fetching task submissions:",ye)}}async function L(I){try{const{data:ye,error:ve}=await Y.from("task_submissions").select(`
          id,
          siswa_id,
          nilai,
          submitted_at,
          student:users(nama, email)
        `).eq("task_id",I).order("submitted_at",{ascending:!1});if(ve)throw ve;q(ye||[])}catch(ye){console.error("Error fetching quiz submissions:",ye)}}async function X(I,ye){try{const{error:ve}=await Y.from("task_submissions").update({nilai:ye,graded_at:new Date().toISOString()}).eq("id",I);if(ve)throw ve;_e(null),we(""),j&&M(j.id),alert("Nilai berhasil disimpan!")}catch(ve){alert("Error: "+ve.message)}}function ue(I,ye){const ve=[["Nama Siswa","Email","Tanggal Submit","Nilai","Status"],...ye.map(ut=>[ut.student.nama,ut.student.email,be(new Date(ut.submitted_at),"dd/MM/yyyy HH:mm"),ut.nilai||"Belum dinilai",ut.nilai!==null?"Sudah dinilai":"Belum dinilai"])],Pt=n0.aoa_to_sheet(ve),De=n0.book_new();n0.book_append_sheet(De,Pt,"Nilai");const de=[{wch:25},{wch:30},{wch:20},{wch:15},{wch:15}];Pt["!cols"]=de;const Ot=`${I.judul}_${be(new Date,"dd-MM-yyyy")}.xlsx`;QC(De,Ot)}async function ge(I){try{const{data:ye,error:ve}=await Y.from("quiz_questions").select("*").eq("task_id",I).order("urutan",{ascending:!0});if(ve)throw ve;D(ye||[])}catch(ye){console.error("Error fetching quiz questions:",ye)}}async function me(){if(j)try{const{error:I}=await Y.from("quiz_questions").insert({task_id:j.id,...re,urutan:k.length+1});if(I)throw I;xe({pertanyaan:"",opsi_a:"",opsi_b:"",opsi_c:"",opsi_d:"",kunci:"a"}),ge(j.id)}catch(I){alert("Error: "+I.message)}}async function le(I){if(confirm("Hapus pertanyaan ini?"))try{const{error:ye}=await Y.from("quiz_questions").delete().eq("id",I);if(ye)throw ye;j&&ge(j.id)}catch(ye){alert("Error: "+ye.message)}}const Fe=t.filter(I=>I.judul.toLowerCase().includes(u.toLowerCase())||I.subject.nama_mapel.toLowerCase().includes(u.toLowerCase()));return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tugas & Quiz"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola tugas dan quiz untuk siswa"})]}),l.jsxs("button",{onClick:()=>{b(null),Q({judul:"",tipe:"biasa",deskripsi:"",deadline:"",kelas_id:"",mapel_id:""}),h(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Buat Tugas/Quiz"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari tugas...",value:u,onChange:I=>d(I.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full max-w-md"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:Fe.map(I=>l.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl p-6 border border-indigo-100 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${I.tipe==="quiz"?"bg-purple-100":"bg-indigo-100"}`,children:l.jsx(ln,{className:`${I.tipe==="quiz"?"text-purple-600":"text-indigo-600"}`,size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:I.judul}),l.jsx("p",{className:"text-sm text-gray-600",children:I.subject.nama_mapel})]})]}),l.jsxs("div",{className:"flex space-x-1",children:[I.tipe==="quiz"&&l.jsx("button",{onClick:()=>{A(I),ge(I.id),v(!0)},className:"text-purple-600 hover:text-purple-900 p-1",title:"Kelola Pertanyaan",children:l.jsx(Fl,{size:16})}),l.jsx("button",{onClick:()=>{A(I),I.tipe==="quiz"?(L(I.id),p(!0)):(M(I.id),w(!0))},className:"text-green-600 hover:text-green-900 p-1",title:"Lihat Pengumpulan",children:l.jsx(Ps,{size:16})}),l.jsx("button",{onClick:()=>{b(I),Q({judul:I.judul,tipe:I.tipe,deskripsi:I.deskripsi,deadline:I.deadline,kelas_id:"",mapel_id:""}),h(!0)},className:"text-indigo-600 hover:text-indigo-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>H(I),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I.tipe==="quiz"?"bg-purple-100 text-purple-800":"bg-indigo-100 text-indigo-800"}`,children:I.tipe==="quiz"?"Quiz":"Tugas"}),I.tipe==="quiz"&&l.jsx("span",{className:"text-xs text-gray-500",children:"Klik ikon mata untuk mengelola soal"})]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Kelas:"})," ",I.class.tingkat," ",I.class.nama_kelas," - ",I.class.major.kode_jurusan]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Deadline:"})," ",be(new Date(I.deadline),"dd MMM yyyy HH:mm",{locale:nt})]}),l.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:I.deskripsi}),l.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mt-3",children:[l.jsx(zr,{size:14}),l.jsxs("span",{children:["Dibuat: ",be(new Date(I.created_at),"dd MMM yyyy",{locale:nt})]})]})]})]},I.id))}),Fe.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ln,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada tugas atau quiz"})]})]}),f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:g?"Edit Tugas/Quiz":"Buat Tugas/Quiz Baru"}),l.jsxs("form",{onSubmit:R,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul"}),l.jsx("input",{type:"text",value:pe.judul,onChange:I=>Q({...pe,judul:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe"}),l.jsxs("select",{value:pe.tipe,onChange:I=>Q({...pe,tipe:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[l.jsx("option",{value:"biasa",children:"Tugas Biasa"}),l.jsx("option",{value:"quiz",children:"Quiz"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline"}),l.jsx("input",{type:"datetime-local",value:pe.deadline,onChange:I=>Q({...pe,deadline:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kelas"}),l.jsxs("select",{value:pe.kelas_id,onChange:I=>Q({...pe,kelas_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Kelas"}),n.map(I=>l.jsxs("option",{value:I.id,children:[I.tingkat," ",I.nama_kelas," - ",I.major.kode_jurusan]},I.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mata Pelajaran"}),l.jsxs("select",{value:pe.mapel_id,onChange:I=>Q({...pe,mapel_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Mata Pelajaran"}),s.map(I=>l.jsx("option",{value:I.id,children:I.nama_mapel},I.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),l.jsx("textarea",{value:pe.deskripsi,onChange:I=>Q({...pe,deskripsi:I.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Deskripsi tugas atau instruksi quiz...",required:!0})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:g?"Update":"Simpan"})]})]})]})}),m&&j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Kelola Pertanyaan Quiz"}),l.jsx("p",{className:"text-gray-600",children:j.judul})]}),l.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[l.jsx("h4",{className:"font-medium mb-4",children:"Tambah Pertanyaan Baru"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{type:"text",placeholder:"Pertanyaan",value:re.pertanyaan,onChange:I=>xe({...re,pertanyaan:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{type:"text",placeholder:"Opsi A",value:re.opsi_a,onChange:I=>xe({...re,opsi_a:I.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),l.jsx("input",{type:"text",placeholder:"Opsi B",value:re.opsi_b,onChange:I=>xe({...re,opsi_b:I.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),l.jsx("input",{type:"text",placeholder:"Opsi C",value:re.opsi_c,onChange:I=>xe({...re,opsi_c:I.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),l.jsx("input",{type:"text",placeholder:"Opsi D",value:re.opsi_d,onChange:I=>xe({...re,opsi_d:I.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jawaban Benar:"}),l.jsxs("select",{value:re.kunci,onChange:I=>xe({...re,kunci:I.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[l.jsx("option",{value:"a",children:"A"}),l.jsx("option",{value:"b",children:"B"}),l.jsx("option",{value:"c",children:"C"}),l.jsx("option",{value:"d",children:"D"})]}),l.jsx("button",{onClick:me,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"Tambah Pertanyaan"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h4",{className:"font-medium",children:["Daftar Pertanyaan (",k.length,")"]}),k.map((I,ye)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("h5",{className:"font-medium",children:["Pertanyaan ",ye+1]}),l.jsx("button",{onClick:()=>le(I.id),className:"text-red-600 hover:text-red-900",children:l.jsx(Er,{size:16})})]}),l.jsx("p",{className:"mb-3",children:I.pertanyaan}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[l.jsxs("div",{className:`p-2 rounded ${I.kunci==="a"?"bg-green-100 text-green-800":"bg-gray-100"}`,children:["A. ",I.opsi_a]}),l.jsxs("div",{className:`p-2 rounded ${I.kunci==="b"?"bg-green-100 text-green-800":"bg-gray-100"}`,children:["B. ",I.opsi_b]}),l.jsxs("div",{className:`p-2 rounded ${I.kunci==="c"?"bg-green-100 text-green-800":"bg-gray-100"}`,children:["C. ",I.opsi_c]}),l.jsxs("div",{className:`p-2 rounded ${I.kunci==="d"?"bg-green-100 text-green-800":"bg-gray-100"}`,children:["D. ",I.opsi_d]})]})]},I.id)),k.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Belum ada pertanyaan. Tambahkan pertanyaan untuk quiz ini."})]})]})}),x&&j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Pengumpulan Tugas"}),l.jsx("p",{className:"text-gray-600",children:j.judul})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:()=>ue(j,_),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[l.jsx(bs,{size:16}),l.jsx("span",{children:"Export Excel"})]}),l.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Siswa"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Submit"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jawaban"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nilai"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(I=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.student.nama}),l.jsx("div",{className:"text-sm text-gray-500",children:I.student.email})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:be(new Date(I.submitted_at),"dd MMM yyyy HH:mm",{locale:nt})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"max-w-xs",children:[I.jawaban_text&&l.jsx("p",{className:"text-sm text-gray-900 line-clamp-3",children:I.jawaban_text}),I.file_url&&l.jsxs("a",{href:I.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm flex items-center space-x-1",children:[l.jsx(Ps,{size:14}),l.jsx("span",{children:"Lihat File"})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.nilai!==null?l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[I.nilai,"/100"]}):l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Belum dinilai"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("button",{onClick:()=>{var ye;_e(I),we(((ye=I.nilai)==null?void 0:ye.toString())||"")},className:"text-indigo-600 hover:text-indigo-900 flex items-center space-x-1",children:[l.jsx(_3,{size:14}),l.jsx("span",{children:"Beri Nilai"})]})})]},I.id))})]})}),_.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ps,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada pengumpulan tugas"})]})]})}),y&&j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Hasil Quiz"}),l.jsx("p",{className:"text-gray-600",children:j.judul})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:()=>ue(j,B),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[l.jsx(bs,{size:16}),l.jsx("span",{children:"Export Excel"})]}),l.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Siswa"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Mengerjakan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nilai"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(I=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.student.nama}),l.jsx("div",{className:"text-sm text-gray-500",children:I.student.email})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:be(new Date(I.submitted_at),"dd MMM yyyy HH:mm",{locale:nt})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.nilai!==null?I.nilai>=75?"bg-green-100 text-green-800":I.nilai>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:I.nilai!==null?`${I.nilai}/100`:"N/A"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.nilai!==null?I.nilai>=75?"bg-green-100 text-green-800":I.nilai>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:I.nilai!==null?I.nilai>=75?"Lulus":I.nilai>=60?"Cukup":"Perlu Perbaikan":"Belum Selesai"})})]},I.id))})]})}),B.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ln,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada yang mengerjakan quiz"})]})]})}),Z&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Beri Nilai"}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Siswa: ",Z.student.nama]}),l.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Tugas: ",j==null?void 0:j.judul]}),l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nilai (0-100)"}),l.jsx("input",{type:"number",min:"0",max:"100",value:ce,onChange:I=>we(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Masukkan nilai..."})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>{_e(null),we("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{onClick:()=>{const I=parseInt(ce);I>=0&&I<=100?X(Z.id,I):alert("Nilai harus antara 0-100")},disabled:!ce||parseInt(ce)<0||parseInt(ce)>100,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Simpan Nilai"})]})]})})]})}function fA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState(!0),[o,c]=T.useState(""),[u,d]=T.useState(be(new Date,"yyyy-MM-dd")),[f,h]=T.useState(!1),[m,v]=T.useState(null),[x,w]=T.useState({schedule_id:"",catatan:"",tanggal:be(new Date,"yyyy-MM-dd")});T.useEffect(()=>{e&&y()},[e]),T.useEffect(()=>{e&&p()},[u,e]);async function y(){try{const{data:A,error:k}=await Y.from("schedules").select(`
          id,
          hari,
          jam_mulai,
          jam_selesai,
          subject:subjects(nama_mapel),
          class:classes(
            nama_kelas,
            tingkat,
            major:majors(kode_jurusan)
          )
        `).eq("guru_id",e==null?void 0:e.id).order("hari",{ascending:!0});if(k)throw k;a(A||[])}catch(A){console.error("Error fetching schedules:",A)}finally{i(!1)}}async function p(){try{const{data:A,error:k}=await Y.from("journals").select(`
          *,
          schedule:schedules(
            hari,
            jam_mulai,
            jam_selesai,
            subject:subjects(nama_mapel),
            class:classes(
              nama_kelas,
              tingkat,
              major:majors(kode_jurusan)
            )
          )
        `).eq("guru_id",e==null?void 0:e.id).gte("tanggal",u).lte("tanggal",u).order("created_at",{ascending:!1});if(k)throw k;r(A||[])}catch(A){console.error("Error fetching journals:",A)}}async function g(A){A.preventDefault();try{const k={guru_id:e==null?void 0:e.id,schedule_id:x.schedule_id,catatan:x.catatan,tanggal:x.tanggal};if(m){const{error:D}=await Y.from("journals").update(k).eq("id",m.id);if(D)throw D}else{const{error:D}=await Y.from("journals").insert(k);if(D)throw D}h(!1),v(null),w({schedule_id:"",catatan:"",tanggal:be(new Date,"yyyy-MM-dd")}),p()}catch(k){alert("Error: "+k.message)}}async function b(A){if(confirm("Hapus jurnal ini?"))try{const{error:k}=await Y.from("journals").delete().eq("id",A.id);if(k)throw k;p()}catch(k){alert("Error: "+k.message)}}const j=t.filter(A=>A.catatan.toLowerCase().includes(o.toLowerCase())||A.schedule.subject.nama_mapel.toLowerCase().includes(o.toLowerCase()));return s?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Jurnal Mengajar"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Catat aktivitas dan progress pembelajaran"})]}),l.jsxs("button",{onClick:()=>{v(null),w({schedule_id:"",catatan:"",tanggal:be(new Date,"yyyy-MM-dd")}),h(!0)},className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tulis Jurnal"})]})]}),l.jsx("div",{className:"bg-white rounded-xl border border-gray-200 mb-6",children:l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari jurnal...",value:o,onChange:A=>c(A.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 w-full"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Gt,{className:"text-gray-400",size:20}),l.jsx("input",{type:"date",value:u,onChange:A=>d(A.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]})})}),l.jsx("div",{className:"bg-white rounded-xl border border-gray-200",children:j.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(dc,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:u===be(new Date,"yyyy-MM-dd")?"Belum ada jurnal hari ini":"Tidak ada jurnal pada tanggal ini"})]}):l.jsx("div",{className:"divide-y divide-gray-200",children:j.map(A=>l.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[l.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center",children:l.jsx(dc,{className:"text-emerald-600",size:20})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:A.schedule.subject.nama_mapel}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Kelas ",A.schedule.class.tingkat," ",A.schedule.class.nama_kelas," - ",A.schedule.class.major.kode_jurusan]})]})]}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-3",children:l.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:A.catatan})}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Gt,{size:14}),l.jsx("span",{children:be(new Date(A.tanggal),"dd MMMM yyyy",{locale:nt})})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(zr,{size:14}),l.jsxs("span",{children:[A.schedule.jam_mulai," - ",A.schedule.jam_selesai]})]}),l.jsx("span",{children:""}),l.jsx("span",{children:A.schedule.hari})]})]}),l.jsxs("div",{className:"flex space-x-2 ml-4",children:[l.jsx("button",{onClick:()=>{v(A),w({schedule_id:A.schedule_id,catatan:A.catatan,tanggal:A.tanggal}),h(!0)},className:"text-emerald-600 hover:text-emerald-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>b(A),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]})},A.id))})}),f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:m?"Edit Jurnal":"Tulis Jurnal Baru"}),l.jsxs("form",{onSubmit:g,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jadwal Mengajar"}),l.jsxs("select",{value:x.schedule_id,onChange:A=>w({...x,schedule_id:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Jadwal"}),n.map(A=>l.jsxs("option",{value:A.id,children:[A.hari," - ",A.subject.nama_mapel," - ",A.class.tingkat," ",A.class.nama_kelas]},A.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal"}),l.jsx("input",{type:"date",value:x.tanggal,onChange:A=>w({...x,tanggal:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catatan Jurnal"}),l.jsx("textarea",{value:x.catatan,onChange:A=>w({...x,catatan:A.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Tulis catatan pembelajaran, materi yang disampaikan, kendala, atau hal penting lainnya...",required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Contoh: Materi yang disampaikan, metode pembelajaran, respon siswa, kendala, dll."})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:m?"Update":"Simpan"})]})]})]})})]})}function hA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,i]=T.useState([]),[o,c]=T.useState(!0),[u,d]=T.useState(""),[f,h]=T.useState(""),[m,v]=T.useState("all"),[x,w]=T.useState(!1),[y,p]=T.useState(null),[g,b]=T.useState({siswa_id:"",jenis:"prestasi",keterangan:"",poin:0,tanggal:be(new Date,"yyyy-MM-dd")});T.useEffect(()=>{e&&j()},[e]);async function j(){try{const{data:_,error:N}=await Y.from("students_classes").select(`
          siswa_id,
          student:users(id, nama, email),
          kelas:classes!inner(
            schedules!inner(guru_id)
          )
        `).eq("kelas.schedules.guru_id",e==null?void 0:e.id).eq("status","aktif");if(N)throw N;const B=(_==null?void 0:_.map(ce=>ce.student).filter((ce,we,pe)=>ce&&pe.findIndex(Q=>(Q==null?void 0:Q.id)===ce.id)===we))||[];a(B);const{data:q,error:Z}=await Y.from("points").select(`
          *,
          student:users(nama, email)
        `).eq("guru_id",e==null?void 0:e.id).order("created_at",{ascending:!1});if(Z)throw Z;r(q||[]);const _e=B.map(ce=>{const we=(q==null?void 0:q.filter(re=>re.siswa_id===ce.id))||[],pe=we.filter(re=>re.jenis==="prestasi").reduce((re,xe)=>re+xe.poin,0),Q=we.filter(re=>re.jenis==="pelanggaran").reduce((re,xe)=>re+Math.abs(xe.poin),0);return{student_id:ce.id,student_name:ce.nama,total_points:pe-Q,prestasi_points:pe,pelanggaran_points:Q}});i(_e.sort((ce,we)=>we.total_points-ce.total_points))}catch(_){console.error("Error fetching data:",_)}finally{c(!1)}}async function A(_){_.preventDefault();try{const N={guru_id:e==null?void 0:e.id,siswa_id:g.siswa_id,jenis:g.jenis,keterangan:g.keterangan,poin:g.jenis==="pelanggaran"?-Math.abs(g.poin):Math.abs(g.poin),tanggal:g.tanggal};if(y){const{error:B}=await Y.from("points").update(N).eq("id",y.id);if(B)throw B}else{const{error:B}=await Y.from("points").insert(N);if(B)throw B}w(!1),p(null),b({siswa_id:"",jenis:"prestasi",keterangan:"",poin:0,tanggal:be(new Date,"yyyy-MM-dd")}),j()}catch(N){alert("Error: "+N.message)}}async function k(_){if(confirm(`Hapus poin ${_.jenis} untuk ${_.student.nama}?`))try{const{error:N}=await Y.from("points").delete().eq("id",_.id);if(N)throw N;j()}catch(N){alert("Error: "+N.message)}}const D=t.filter(_=>{const N=_.student.nama.toLowerCase().includes(u.toLowerCase())||_.keterangan.toLowerCase().includes(u.toLowerCase()),B=f===""||_.siswa_id===f,q=m==="all"||_.jenis===m;return N&&B&&q});return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Poin Siswa"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola poin prestasi dan pelanggaran siswa"})]}),l.jsxs("button",{onClick:()=>{p(null),b({siswa_id:"",jenis:"prestasi",keterangan:"",poin:0,tanggal:be(new Date,"yyyy-MM-dd")}),w(!0)},className:"bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors flex items-center space-x-2",children:[l.jsx(qr,{size:20}),l.jsx("span",{children:"Tambah Poin"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 mb-6",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Rangkuman Poin Siswa"})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.slice(0,6).map(_=>l.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg p-4 border border-amber-100",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:_.student_name}),l.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${_.total_points>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[_.total_points>=0?"+":"",_.total_points]})]}),l.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(on,{size:14,className:"text-green-500"}),l.jsxs("span",{children:["+",_.prestasi_points]})]}),l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(fc,{size:14,className:"text-red-500"}),l.jsxs("span",{children:["-",_.pelanggaran_points]})]})]})]},_.student_id))})})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari siswa atau keterangan...",value:u,onChange:_=>d(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 w-full"})]}),l.jsxs("select",{value:f,onChange:_=>h(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[l.jsx("option",{value:"",children:"Semua Siswa"}),n.map(_=>l.jsx("option",{value:_.id,children:_.nama},_.id))]}),l.jsxs("select",{value:m,onChange:_=>v(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[l.jsx("option",{value:"all",children:"Semua Jenis"}),l.jsx("option",{value:"prestasi",children:"Prestasi"}),l.jsx("option",{value:"pelanggaran",children:"Pelanggaran"})]})]})}),l.jsx("div",{className:"divide-y divide-gray-200",children:D.map(_=>l.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${_.jenis==="prestasi"?"bg-green-100":"bg-red-100"}`,children:_.jenis==="prestasi"?l.jsx(on,{className:"text-green-600",size:24}):l.jsx(fc,{className:"text-red-600",size:24})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:_.student.nama}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_.jenis==="prestasi"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.jenis==="prestasi"?"Prestasi":"Pelanggaran"}),l.jsxs("span",{className:`font-bold ${_.jenis==="prestasi"?"text-green-600":"text-red-600"}`,children:[_.poin>0?"+":"",_.poin," poin"]})]}),l.jsx("p",{className:"text-gray-700 mb-2",children:_.keterangan}),l.jsx("p",{className:"text-sm text-gray-500",children:be(new Date(_.tanggal),"dd MMMM yyyy",{locale:nt})})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>{p(_),b({siswa_id:_.siswa_id,jenis:_.jenis,keterangan:_.keterangan,poin:Math.abs(_.poin),tanggal:_.tanggal}),w(!0)},className:"text-amber-600 hover:text-amber-900 p-1",children:l.jsx(Kr,{size:16})}),l.jsx("button",{onClick:()=>k(_),className:"text-red-600 hover:text-red-900 p-1",children:l.jsx(Er,{size:16})})]})]})},_.id))}),D.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Vs,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Belum ada data poin"})]})]}),x&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:y?"Edit Poin":"Tambah Poin Baru"}),l.jsxs("form",{onSubmit:A,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Siswa"}),l.jsxs("select",{value:g.siswa_id,onChange:_=>b({...g,siswa_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",required:!0,children:[l.jsx("option",{value:"",children:"Pilih Siswa"}),n.map(_=>l.jsx("option",{value:_.id,children:_.nama},_.id))]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis"}),l.jsxs("select",{value:g.jenis,onChange:_=>b({...g,jenis:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",required:!0,children:[l.jsx("option",{value:"prestasi",children:"Prestasi"}),l.jsx("option",{value:"pelanggaran",children:"Pelanggaran"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Poin"}),l.jsx("input",{type:"number",value:g.poin,onChange:_=>b({...g,poin:parseInt(_.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",min:"1",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal"}),l.jsx("input",{type:"date",value:g.tanggal,onChange:_=>b({...g,tanggal:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan"}),l.jsx("textarea",{value:g.keterangan,onChange:_=>b({...g,keterangan:_.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",placeholder:"Jelaskan alasan pemberian poin...",required:!0})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:y?"Update":"Simpan"})]})]})]})})]})}const a0=["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];function xA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState(null),[s,i]=T.useState(!0),[o,c]=T.useState("");T.useEffect(()=>{e&&u()},[e]);async function u(){try{const{data:f}=await Y.from("students_classes").select(`
          kelas:classes(
            id,
            nama_kelas,
            tingkat,
            major:majors(nama_jurusan, kode_jurusan)
          )
        `).eq("siswa_id",e==null?void 0:e.id).eq("status","aktif").maybeSingle();if(a(f),f){const{data:h}=await Y.from("schedules").select(`
            id,
            hari,
            jam_mulai,
            jam_selesai,
            subject:subjects(nama_mapel),
            guru:users(nama)
          `).eq("kelas_id",f.kelas.id).order("hari",{ascending:!0});r(h||[])}}catch(f){console.error("Error fetching schedule:",f)}finally{i(!1)}}o&&t.filter(f=>f.hari===o);const d=a0.reduce((f,h)=>(f[h]=t.filter(m=>m.hari===h),f),{});return s?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Jadwal Pelajaran"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Lihat jadwal pelajaran mingguan Anda"}),n&&l.jsx("div",{className:"mt-4 bg-blue-50 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Ks,{className:"text-blue-600",size:20}),l.jsxs("div",{children:[l.jsxs("p",{className:"font-semibold text-blue-900",children:["Kelas ",n.kelas.tingkat," ",n.kelas.nama_kelas]}),l.jsxs("p",{className:"text-blue-700 text-sm",children:[n.kelas.major.nama_jurusan," (",n.kelas.major.kode_jurusan,")"]})]})]})})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx(Gt,{className:"text-blue-600",size:20}),l.jsxs("select",{value:o,onChange:f=>c(f.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Semua Hari"}),a0.map(f=>l.jsx("option",{value:f,children:f},f))]})]})}),l.jsx("div",{className:"space-y-6",children:a0.map(f=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Gt,{className:"text-blue-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:f})]}),l.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[d[f].length," mata pelajaran"]})]})}),d[f].length===0?l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx(jr,{className:"mx-auto mb-2",size:32}),l.jsx("p",{children:"Tidak ada jadwal"})]}):l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d[f].map(h=>l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(jr,{className:"text-blue-600",size:20})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-gray-900",children:h.subject.nama_mapel}),l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[l.jsx(Tf,{size:14}),l.jsx("span",{children:h.guru.nama})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 text-blue-700 bg-blue-100 rounded-lg px-3 py-2",children:[l.jsx(zr,{size:16}),l.jsxs("span",{className:"font-medium",children:[h.jam_mulai," - ",h.jam_selesai]})]})]},h.id))})})]},f))})]})}function mA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState({total:0,hadir:0,tidak_hadir:0,izin:0,sakit:0,percentage:0}),[s,i]=T.useState(be(new Date,"yyyy-MM")),[o,c]=T.useState(!0);T.useEffect(()=>{e&&u()},[e,s]);async function u(){try{const h=`${s}-01`,m=be(R3(new Date(s)),"yyyy-MM-dd"),{data:v}=await Y.from("attendance").select(`
          id,
          status,
          tanggal,
          keterangan,
          schedule:schedules(
            hari,
            jam_mulai,
            jam_selesai,
            subject:subjects(nama_mapel),
            guru:users(nama)
          )
        `).eq("siswa_id",e==null?void 0:e.id).gte("tanggal",h).lte("tanggal",m).order("tanggal",{ascending:!1});r(v||[]);const x=(v==null?void 0:v.length)||0,w=(v==null?void 0:v.filter(j=>j.status==="hadir").length)||0,y=(v==null?void 0:v.filter(j=>j.status==="tidak_hadir").length)||0,p=(v==null?void 0:v.filter(j=>j.status==="izin").length)||0,g=(v==null?void 0:v.filter(j=>j.status==="sakit").length)||0,b=x>0?Math.round(w/x*100):0;a({total:x,hadir:w,tidak_hadir:y,izin:p,sakit:g,percentage:b})}catch(h){console.error("Error fetching attendance:",h)}finally{c(!1)}}const d=h=>{switch(h){case"hadir":return l.jsx(Gs,{className:"text-green-600",size:20});case"tidak_hadir":return l.jsx(xl,{className:"text-red-600",size:20});case"izin":return l.jsx(As,{className:"text-yellow-600",size:20});case"sakit":return l.jsx(zr,{className:"text-blue-600",size:20});default:return l.jsx(As,{className:"text-gray-600",size:20})}},f=h=>{switch(h){case"hadir":return"bg-green-100 text-green-800";case"tidak_hadir":return"bg-red-100 text-red-800";case"izin":return"bg-yellow-100 text-yellow-800";case"sakit":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Presensi Saya"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Lihat riwayat kehadiran dan statistik presensi Anda"})]}),l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[l.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.total})]}),l.jsx(cn,{className:"text-gray-600",size:24})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hadir"}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.hadir})]}),l.jsx(Gs,{className:"text-green-600",size:24})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tidak Hadir"}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.tidak_hadir})]}),l.jsx(xl,{className:"text-red-600",size:24})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Izin"}),l.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.izin})]}),l.jsx(As,{className:"text-yellow-600",size:24})]})}),l.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Persentase"}),l.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[n.percentage,"%"]})]}),l.jsx(on,{className:"text-blue-600",size:24})]})})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx(Gt,{className:"text-blue-600",size:20}),l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Pilih Bulan:"}),l.jsx("input",{type:"month",value:s,onChange:h=>i(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Riwayat Presensi - ",be(new Date(s),"MMMM yyyy",{locale:nt})]})}),t.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Gt,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data presensi untuk bulan ini"})]}):l.jsx("div",{className:"divide-y divide-gray-200",children:t.map(h=>l.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:d(h.status)}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("h4",{className:"font-semibold text-gray-900",children:h.schedule.subject.nama_mapel}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(h.status)}`,children:h.status})]}),l.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Guru: ",h.schedule.guru.nama]}),l.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Waktu: ",h.schedule.jam_mulai," - ",h.schedule.jam_selesai]}),h.keterangan&&l.jsxs("p",{className:"text-sm text-gray-600",children:["Keterangan: ",h.keterangan]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"font-medium text-gray-900",children:be(new Date(h.tanggal),"dd MMM yyyy",{locale:nt})}),l.jsx("p",{className:"text-sm text-gray-500",children:h.schedule.hari})]})]})},h.id))})]})]})}function pA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState(!0),[s,i]=T.useState(""),[o,c]=T.useState(""),[u,d]=T.useState("all"),[f,h]=T.useState(null),[m,v]=T.useState(!1);T.useEffect(()=>{e&&x()},[e]);async function x(){try{const{data:p}=await Y.from("students_classes").select("kelas_id").eq("siswa_id",e==null?void 0:e.id).eq("status","aktif").maybeSingle();if(!p)return;const{data:g}=await Y.from("materials").select(`
          id,
          judul,
          tipe,
          konten,
          file_url,
          created_at,
          subject:subjects(nama_mapel),
          guru:users(nama)
        `).eq("kelas_id",p.kelas_id).order("created_at",{ascending:!1});r(g||[])}catch(p){console.error("Error fetching materials:",p)}finally{a(!1)}}const w=t.filter(p=>{const g=p.judul.toLowerCase().includes(s.toLowerCase())||p.subject.nama_mapel.toLowerCase().includes(s.toLowerCase()),b=o===""||p.subject.nama_mapel===o,j=u==="all"||p.tipe===u;return g&&b&&j}),y=[...new Set(t.map(p=>p.subject.nama_mapel))];return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Materi Pembelajaran"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Akses materi pembelajaran dari guru Anda"})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"text",placeholder:"Cari materi...",value:s,onChange:p=>i(p.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full"})]}),l.jsxs("select",{value:o,onChange:p=>c(p.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Semua Mata Pelajaran"}),y.map(p=>l.jsx("option",{value:p,children:p},p))]}),l.jsxs("select",{value:u,onChange:p=>d(p.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"all",children:"Semua Tipe"}),l.jsx("option",{value:"text",children:"Teks"}),l.jsx("option",{value:"pdf",children:"PDF"})]})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(p=>l.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:p.tipe==="text"?l.jsx(Ps,{className:"text-blue-600",size:24}):l.jsx(bs,{className:"text-blue-600",size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:p.judul}),l.jsx("p",{className:"text-sm text-gray-600",children:p.subject.nama_mapel})]})]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.tipe==="text"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:p.tipe==="text"?"Teks":"PDF"})]}),l.jsxs("div",{className:"space-y-2 mb-4",children:[l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Guru:"})," ",p.guru.nama]}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Dibuat: ",be(new Date(p.created_at),"dd MMM yyyy",{locale:nt})]}),p.tipe==="text"&&p.konten&&l.jsxs("p",{className:"text-sm text-gray-600 line-clamp-3",children:[p.konten.substring(0,100),"..."]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:()=>{h(p),v(!0)},className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(Fl,{size:16}),l.jsx("span",{children:"Lihat"})]}),p.tipe==="pdf"&&p.file_url&&l.jsx("a",{href:p.file_url,target:"_blank",rel:"noopener noreferrer",className:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center",children:l.jsx(bs,{size:16})})]})]},p.id))}),w.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(jr,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada materi pembelajaran"})]}),m&&f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:f.judul}),l.jsx("p",{className:"text-gray-600",children:f.subject.nama_mapel}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Guru: ",f.guru.nama]})]}),l.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),l.jsx("div",{className:"p-6",children:f.tipe==="text"&&f.konten?l.jsx("div",{className:"prose max-w-none",children:l.jsx("div",{className:"whitespace-pre-wrap text-gray-800",children:f.konten})}):f.tipe==="pdf"&&f.file_url?l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx(bs,{className:"mx-auto text-blue-600 mb-2",size:48}),l.jsx("p",{className:"text-gray-600",children:"File PDF tersedia untuk diunduh"})]}),l.jsxs("a",{href:f.file_url,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors inline-flex items-center space-x-2",children:[l.jsx(bs,{size:20}),l.jsx("span",{children:"Unduh PDF"})]})]}):l.jsx("p",{className:"text-gray-500 text-center",children:"Konten tidak tersedia"})})]})})]})}function gA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState(!0),[s,i]=T.useState(null),[o,c]=T.useState(!1),[u,d]=T.useState(!1),[f,h]=T.useState([]),[m,v]=T.useState({}),[x,w]=T.useState({jawaban_text:"",file_url:""});T.useEffect(()=>{e&&y()},[e]);async function y(){try{const{data:k}=await Y.from("students_classes").select("kelas_id").eq("siswa_id",e==null?void 0:e.id).eq("status","aktif").maybeSingle();if(!k)return;const{data:D}=await Y.from("tasks").select(`
          id,
          judul,
          tipe,
          deskripsi,
          deadline,
          created_at,
          subject:subjects(nama_mapel),
          guru:users(nama)
        `).eq("kelas_id",k.kelas_id).order("created_at",{ascending:!1});if(D){const _=await Promise.all(D.map(async N=>{const{data:B}=await Y.from("task_submissions").select("id, file_url, jawaban_text, nilai, submitted_at").eq("task_id",N.id).eq("siswa_id",e==null?void 0:e.id).maybeSingle();return{...N,submission:B||void 0}}));r(_)}}catch(k){console.error("Error fetching tasks:",k)}finally{a(!1)}}async function p(k){try{const{data:D}=await Y.from("quiz_questions").select("*").eq("task_id",k).order("urutan",{ascending:!0});h(D||[])}catch(D){console.error("Error fetching quiz questions:",D)}}async function g(k){try{const{error:D}=await Y.from("task_submissions").insert({task_id:k,siswa_id:e==null?void 0:e.id,jawaban_text:x.jawaban_text||null,file_url:x.file_url||null,submitted_at:new Date().toISOString()});if(D)throw D;c(!1),w({jawaban_text:"",file_url:""}),y(),alert("Tugas berhasil dikumpulkan!")}catch(D){alert("Error: "+D.message)}}async function b(k){try{const{data:D}=await Y.from("quiz_questions").select("id, kunci").eq("task_id",k);if(!D)throw new Error("Tidak dapat mengambil data soal");let _=0;const N=D.length,B=Object.entries(m).map(([ce,we])=>{const pe=D.find(re=>re.id===ce),Q=pe&&pe.kunci===we;return Q&&_++,{question_id:ce,siswa_id:e==null?void 0:e.id,jawaban:we,benar_salah:Q}}),{error:q}=await Y.from("quiz_answers").insert(B);if(q)throw q;const Z=N>0?Math.round(_/N*100):0,{error:_e}=await Y.from("task_submissions").insert({task_id:k,siswa_id:e==null?void 0:e.id,nilai:Z,submitted_at:new Date().toISOString()});if(_e)throw _e;d(!1),v({}),y(),alert(`Quiz berhasil dikumpulkan!
Nilai Anda: ${Z}/100
Jawaban benar: ${_}/${N}`)}catch(D){alert("Error: "+D.message)}}const j=k=>new Date>new Date(k),A=k=>k.submission?{status:"submitted",color:"bg-green-100 text-green-800",text:"Sudah Dikumpulkan"}:j(k.deadline)?{status:"overdue",color:"bg-red-100 text-red-800",text:"Terlambat"}:{status:"pending",color:"bg-yellow-100 text-yellow-800",text:"Belum Dikumpulkan"};return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tugas & Quiz"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Lihat dan kerjakan tugas dari guru Anda"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(k=>{const D=A(k),_=j(k.deadline);return l.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${k.tipe==="quiz"?"bg-purple-100":"bg-blue-100"}`,children:l.jsx(ln,{className:`${k.tipe==="quiz"?"text-purple-600":"text-blue-600"}`,size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900",children:k.judul}),l.jsx("p",{className:"text-sm text-gray-600",children:k.subject.nama_mapel})]})]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D.color}`,children:D.text})]}),l.jsxs("div",{className:"space-y-2 mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${k.tipe==="quiz"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:k.tipe==="quiz"?"Quiz":"Tugas"}),_&&!k.submission&&l.jsx(m3,{className:"text-red-500",size:16})]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Guru:"})," ",k.guru.nama]}),l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Deadline:"})," ",be(new Date(k.deadline),"dd MMM yyyy HH:mm",{locale:nt})]}),l.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:k.deskripsi}),k.submission&&l.jsxs("div",{className:"bg-green-50 rounded-lg p-3 mt-3",children:[l.jsxs("p",{className:"text-sm text-green-800",children:[l.jsx("strong",{children:"Dikumpulkan:"})," ",be(new Date(k.submission.submitted_at),"dd MMM yyyy HH:mm",{locale:nt})]}),k.submission.nilai!==null&&l.jsxs("p",{className:"text-sm text-green-800",children:[l.jsx("strong",{children:"Nilai:"})," ",k.submission.nilai,"/100"]})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:()=>{i(k),c(!0)},className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(Fl,{size:16}),l.jsx("span",{children:"Lihat Detail"})]}),!k.submission&&!_&&l.jsxs("button",{onClick:()=>{i(k),k.tipe==="quiz"?(p(k.id),d(!0)):c(!0)},className:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(y3,{size:16}),l.jsx("span",{children:k.tipe==="quiz"?"Kerjakan":"Kumpulkan"})]})]})]},k.id)})}),t.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ln,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada tugas atau quiz"})]}),o&&s&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.judul}),l.jsx("p",{className:"text-gray-600",children:s.subject.nama_mapel}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Guru: ",s.guru.nama]})]}),l.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Deskripsi Tugas:"}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.deskripsi})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("p",{className:"text-sm text-gray-600",children:[l.jsx("strong",{children:"Deadline:"})," ",be(new Date(s.deadline),"dd MMMM yyyy HH:mm",{locale:nt})]})}),!s.submission&&!j(s.deadline)&&s.tipe==="biasa"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"font-semibold",children:"Kumpulkan Tugas:"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jawaban (Teks)"}),l.jsx("textarea",{value:x.jawaban_text,onChange:k=>w({...x,jawaban_text:k.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Tulis jawaban Anda di sini..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL File (Opsional)"}),l.jsx("input",{type:"url",value:x.file_url,onChange:k=>w({...x,file_url:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://drive.google.com/..."})]}),l.jsx("button",{onClick:()=>g(s.id),disabled:!x.jawaban_text&&!x.file_url,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Kumpulkan Tugas"})]}),s.submission&&l.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Tugas Sudah Dikumpulkan"}),l.jsxs("p",{className:"text-sm text-green-700",children:["Dikumpulkan pada: ",be(new Date(s.submission.submitted_at),"dd MMMM yyyy HH:mm",{locale:nt})]}),s.submission.nilai!==null&&l.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["Nilai: ",s.submission.nilai,"/100"]})]})]})]})}),u&&s&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.judul}),l.jsx("p",{className:"text-gray-600",children:s.subject.nama_mapel}),l.jsxs("p",{className:"text-sm text-gray-500",children:[f.length," pertanyaan  Deadline: ",be(new Date(s.deadline),"dd MMM yyyy HH:mm",{locale:nt})]})]}),l.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"mb-6",children:l.jsx("p",{className:"text-gray-700",children:s.deskripsi})}),l.jsx("div",{className:"space-y-6",children:f.map((k,D)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold mb-4",children:[D+1,". ",k.pertanyaan]}),l.jsx("div",{className:"space-y-2",children:["a","b","c","d"].map(_=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[l.jsx("input",{type:"radio",name:`question-${k.id}`,value:_,checked:m[k.id]===_,onChange:N=>v({...m,[k.id]:N.target.value}),className:"text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-gray-700",children:[_.toUpperCase(),". ",k[`opsi_${_}`]]})]},_))})]},k.id))}),l.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:l.jsxs("button",{onClick:()=>b(s.id),disabled:Object.keys(m).length!==f.length,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["Kumpulkan Quiz (",Object.keys(m).length,"/",f.length," terjawab)"]})})]})]})})]})}function vA(){const{profile:e}=_t(),[t,r]=T.useState([]),[n,a]=T.useState({total_points:0,prestasi_points:0,pelanggaran_points:0,recent_points:[]}),[s,i]=T.useState(!0),[o,c]=T.useState(be(new Date,"yyyy-MM")),[u,d]=T.useState("all");T.useEffect(()=>{e&&f()},[e,o]);async function f(){try{const{data:x}=await Y.from("points").select(`
          id,
          jenis,
          keterangan,
          poin,
          tanggal,
          created_at,
          guru:users(nama)
        `).eq("siswa_id",e==null?void 0:e.id).order("created_at",{ascending:!1}),w=`${o}-01`,y=`${o}-31`,{data:p}=await Y.from("points").select(`
          id,
          jenis,
          keterangan,
          poin,
          tanggal,
          created_at,
          guru:users(nama)
        `).eq("siswa_id",e==null?void 0:e.id).gte("tanggal",w).lte("tanggal",y).order("created_at",{ascending:!1});if(r(p||[]),x){const g=x.filter(j=>j.jenis==="prestasi").reduce((j,A)=>j+A.poin,0),b=x.filter(j=>j.jenis==="pelanggaran").reduce((j,A)=>j+Math.abs(A.poin),0);a({total_points:g-b,prestasi_points:g,pelanggaran_points:b,recent_points:x.slice(0,5)})}}catch(x){console.error("Error fetching points:",x)}finally{i(!1)}}const h=t.filter(x=>u==="all"||x.jenis===u),m=x=>x==="prestasi"?l.jsx(on,{className:"text-green-600",size:20}):l.jsx(fc,{className:"text-red-600",size:20}),v=x=>x==="prestasi"?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return s?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Poin Saya"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Lihat poin prestasi dan pelanggaran Anda"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Poin"}),l.jsxs("p",{className:`text-3xl font-bold ${n.total_points>=0?"text-green-600":"text-red-600"}`,children:[n.total_points>=0?"+":"",n.total_points]})]}),l.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:l.jsx(b3,{className:"text-blue-600",size:24})})]})}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Poin Prestasi"}),l.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["+",n.prestasi_points]})]}),l.jsx("div",{className:"bg-green-100 rounded-full p-3",children:l.jsx(on,{className:"text-green-600",size:24})})]})}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Poin Pelanggaran"}),l.jsxs("p",{className:"text-3xl font-bold text-red-600",children:["-",n.pelanggaran_points]})]}),l.jsx("div",{className:"bg-red-100 rounded-full p-3",children:l.jsx(fc,{className:"text-red-600",size:24})})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-8",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Poin Terbaru"}),n.recent_points.length===0?l.jsx("p",{className:"text-gray-500 text-center py-4",children:"Belum ada poin"}):l.jsx("div",{className:"space-y-3",children:n.recent_points.map(x=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:m(x.jenis)}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:x.keterangan}),l.jsxs("p",{className:"text-sm text-gray-600",children:[be(new Date(x.tanggal),"dd MMM yyyy",{locale:nt}),"  ",x.guru.nama]})]})]}),l.jsxs("span",{className:`px-2 py-1 rounded-full text-sm font-medium ${x.jenis==="prestasi"?"text-green-600":"text-red-600"}`,children:[x.poin>0?"+":"",x.poin]})]},x.id))})]}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 mb-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Gt,{className:"text-blue-600",size:20}),l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Bulan:"}),l.jsx("input",{type:"month",value:o,onChange:x=>c(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("select",{value:u,onChange:x=>d(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"all",children:"Semua Jenis"}),l.jsx("option",{value:"prestasi",children:"Prestasi"}),l.jsx("option",{value:"pelanggaran",children:"Pelanggaran"})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Riwayat Poin - ",be(new Date(o),"MMMM yyyy",{locale:nt})]})}),h.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Vs,{className:"mx-auto text-gray-400 mb-4",size:48}),l.jsx("p",{className:"text-gray-500",children:"Tidak ada data poin untuk periode ini"})]}):l.jsx("div",{className:"divide-y divide-gray-200",children:h.map(x=>l.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:l.jsx("div",{className:"flex items-start justify-between",children:l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${x.jenis==="prestasi"?"bg-green-100":"bg-red-100"}`,children:m(x.jenis)}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v(x.jenis)}`,children:x.jenis==="prestasi"?"Prestasi":"Pelanggaran"}),l.jsxs("span",{className:`font-bold ${x.jenis==="prestasi"?"text-green-600":"text-red-600"}`,children:[x.poin>0?"+":"",x.poin," poin"]})]}),l.jsx("p",{className:"text-gray-900 font-medium mb-1",children:x.keterangan}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Gt,{size:14}),l.jsx("span",{children:be(new Date(x.tanggal),"dd MMMM yyyy",{locale:nt})})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Tf,{size:14}),l.jsx("span",{children:x.guru.nama})]})]})]})]})})},x.id))})]})]})}function yA(){return l.jsx(f3,{children:l.jsx(jb,{children:l.jsxs(so,{children:[l.jsx($e,{path:"/login",element:l.jsx(E3,{})}),l.jsx($e,{path:"/",element:l.jsx(Q0,{to:"/dashboard",replace:!0})}),l.jsx($e,{path:"/dashboard",element:l.jsx(fo,{children:l.jsx(ho,{children:l.jsx(dj,{})})})}),l.jsx($e,{path:"/admin/*",element:l.jsx(fo,{requiredRole:"admin",children:l.jsx(ho,{children:l.jsxs(so,{children:[l.jsx($e,{path:"teachers",element:l.jsx(fj,{})}),l.jsx($e,{path:"students",element:l.jsx(hj,{})}),l.jsx($e,{path:"majors",element:l.jsx(xj,{})}),l.jsx($e,{path:"classes",element:l.jsx(mj,{})}),l.jsx($e,{path:"subjects",element:l.jsx(pj,{})}),l.jsx($e,{path:"schedules",element:l.jsx(gj,{})}),l.jsx($e,{path:"location-settings",element:l.jsx(vj,{})}),l.jsx($e,{path:"*",element:l.jsxs("div",{className:"text-center py-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fitur Admin"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Pilih menu di sidebar"})]})})]})})})}),l.jsx($e,{path:"/teacher/*",element:l.jsx(fo,{requiredRole:"guru",children:l.jsx(ho,{children:l.jsxs(so,{children:[l.jsx($e,{path:"attendance",element:l.jsx(yj,{})}),l.jsx($e,{path:"student-attendance",element:l.jsx(wj,{})}),l.jsx($e,{path:"materials",element:l.jsx(_j,{})}),l.jsx($e,{path:"tasks",element:l.jsx(dA,{})}),l.jsx($e,{path:"journals",element:l.jsx(fA,{})}),l.jsx($e,{path:"points",element:l.jsx(hA,{})}),l.jsx($e,{path:"*",element:l.jsxs("div",{className:"text-center py-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fitur Guru"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Pilih menu di sidebar"})]})})]})})})}),l.jsx($e,{path:"/student/*",element:l.jsx(fo,{requiredRole:"siswa",children:l.jsx(ho,{children:l.jsxs(so,{children:[l.jsx($e,{path:"schedule",element:l.jsx(xA,{})}),l.jsx($e,{path:"attendance",element:l.jsx(mA,{})}),l.jsx($e,{path:"materials",element:l.jsx(pA,{})}),l.jsx($e,{path:"tasks",element:l.jsx(gA,{})}),l.jsx($e,{path:"points",element:l.jsx(vA,{})}),l.jsx($e,{path:"*",element:l.jsxs("div",{className:"text-center py-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fitur Siswa"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Pilih menu di sidebar"})]})})]})})})})]})})})}qg(document.getElementById("root")).render(l.jsx(T.StrictMode,{children:l.jsx(yA,{})}));
